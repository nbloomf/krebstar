<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <meta name="author" content="nbloomf">
  <title>Integrating with Tasty</title>
  <style type="text/css">code{white-space: pre;}</style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <link rel="stylesheet" href="../../../../../../styles/style.css">
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
</head>
<body>
<article>
<header>
<h1 class="title">Integrating with Tasty</h1>
<p class="byline">nbloomf</p>
</header>
<div class="frontmatter">
<div class="sourceCode" id="cb1"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">module</span> <span class="dt">Kreb.Unit.Tasty</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">import</span> <span class="dt">Data.Typeable</span></a>
<a class="sourceLine" id="cb1-4" title="4"></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">import</span> <span class="dt">Test.Tasty</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">import</span> <span class="dt">Test.Tasty.Options</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">import</span> <span class="dt">Test.Tasty.Providers</span></a>
<a class="sourceLine" id="cb1-8" title="8"></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">import</span> <span class="dt">Kreb.Unit.Declare</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="kw">import</span> <span class="dt">Kreb.Unit.Declarable</span></a></code></pre></div>
</div>
<div class="sourceCode" id="cb2"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">newtype</span> <span class="dt">KU</span> <span class="ot">=</span> <span class="dt">KU</span> <span class="dt">Declaration</span></a>
<a class="sourceLine" id="cb2-2" title="2">  <span class="kw">deriving</span> <span class="dt">Typeable</span></a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">instance</span> <span class="dt">IsTest</span> <span class="dt">KU</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb3-2" title="2">  testOptions <span class="ot">=</span> <span class="fu">return</span> []</a>
<a class="sourceLine" id="cb3-3" title="3"></a>
<a class="sourceLine" id="cb3-4" title="4">  run _ (<span class="dt">KU</span> dec) _ <span class="ot">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb3-5" title="5">    result <span class="ot">&lt;-</span> testDeclaration dec</a>
<a class="sourceLine" id="cb3-6" title="6">    <span class="fu">return</span> <span class="op">$</span> <span class="kw">case</span> result <span class="kw">of</span></a>
<a class="sourceLine" id="cb3-7" title="7">      <span class="dt">Nothing</span> <span class="ot">-&gt;</span> testPassed <span class="st">&quot;&quot;</span></a>
<a class="sourceLine" id="cb3-8" title="8">      <span class="dt">Just</span> err <span class="ot">-&gt;</span> testFailed err</a></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb4-1" title="1">krebUnit</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="ot">  ::</span> ( <span class="dt">Declarable</span> assert )</a>
<a class="sourceLine" id="cb4-3" title="3">  <span class="ot">=&gt;</span> <span class="dt">TestName</span> <span class="ot">-&gt;</span> assert <span class="ot">-&gt;</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb4-4" title="4">krebUnit name dec <span class="ot">=</span></a>
<a class="sourceLine" id="cb4-5" title="5">  singleTest name <span class="op">$</span> <span class="dt">KU</span> <span class="op">$</span> declare dec</a></code></pre></div>
</article>
</body>
</html>
