<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Ned.Data.Buffer.Test</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <style type="text/css">
  /* Kudos to Pascal Hertleif                  */
  /* https://gist.github.com/killercup/5917178 */
  
  html {
    font-size: 100%;
    overflow-y: scroll;
    -webkit-text-size-adjust: 100%;
    -ms-text-size-adjust: 100%;
  }
  
  body {
    color: #444;
    font-family: Georgia, Palatino, 'Palatino Linotype', Times, 'Times New Roman', serif;
    font-size: 12px;
    line-height: 1.7;
    padding: 1em;
    margin: auto;
    max-width: 42em;
    background: #fefefe;
  }
  
  a {
    color: #0645ad;
    text-decoration: none;
  }
  
  a:visited {
    color: #0b0080;
  }
  
  a:hover {
    color: #06e;
  }
  
  a:active {
    color: #faa700;
  }
  
  a:focus {
    outline: thin dotted;
  }
  
  *::-moz-selection {
    background: rgba(255, 255, 0, 0.3);
    color: #000;
  }
  
  *::selection {
    background: rgba(255, 255, 0, 0.3);
    color: #000;
  }
  
  a::-moz-selection {
    background: rgba(255, 255, 0, 0.3);
    color: #0645ad;
  }
  
  a::selection {
    background: rgba(255, 255, 0, 0.3);
    color: #0645ad;
  }
  
  p {
    margin: 1em 0;
  }
  
  img {
    max-width: 100%;
  }
  
  h1, h2, h3, h4, h5, h6 {
    color: #111;
    line-height: 125%;
    margin-top: 2em;
    font-weight: normal;
  }
  
  h4, h5, h6 {
    font-weight: bold;
  }
  
  h1 {
    font-size: 2.5em;
  }
  
  h2 {
    font-size: 2em;
  }
  
  h3 {
    font-size: 1.5em;
  }
  
  h4 {
    font-size: 1.2em;
  }
  
  h5 {
    font-size: 1em;
  }
  
  h6 {
    font-size: 0.9em;
  }
  
  blockquote {
    display: block;
    color: #666666;
    margin: 0;
    padding-left: 3em;
    border-left: 0.5em #EEE solid;
  }
  
  hr {
    display: block;
    height: 2px;
    border: 0;
    border-top: 1px solid #aaa;
    border-bottom: 1px solid #eee;
    margin: 1em 0;
    padding: 0;
  }
  
  pre, code, kbd, samp {
    color: #000;
    font-family: monospace, monospace;
    _font-family: 'courier new', monospace;
    font-size: 0.98em;
  }
  
  pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
  }
  
  b, strong {
    font-weight: bold;
  }
  
  dfn {
    font-style: italic;
  }
  
  ins {
    background: #ff9;
    color: #000;
    text-decoration: none;
  }
  
  mark {
    background: #ff0;
    color: #000;
    font-style: italic;
    font-weight: bold;
  }
  
  sub, sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
  }
  
  sup {
    top: -0.5em;
  }
  
  sub {
    bottom: -0.25em;
  }
  
  ul, ol {
    margin: 1em 0;
    padding: 0 0 0 2em;
  }
  
  li p:last-child {
    margin-bottom: 0;
  }
  
  ul ul, ol ol {
    margin: .3em 0;
  }
  
  dl {
    margin-bottom: 1em;
  }
  
  dt {
    font-weight: bold;
    margin-bottom: .8em;
  }
  
  dd {
    margin: 0 0 .8em 2em;
  }
  
  dd:last-child {
    margin-bottom: 0;
  }
  
  img {
    border: 0;
    -ms-interpolation-mode: bicubic;
    vertical-align: middle;
  }
  
  figure {
    display: block;
    text-align: center;
    margin: 1em 0;
  }
  
  figure img {
    border: none;
    margin: 0 auto;
  }
  
  figcaption {
    font-size: 0.8em;
    font-style: italic;
    margin: 0 0 .8em;
  }
  
  table {
    margin-bottom: 2em;
    border-bottom: 1px solid #ddd;
    border-right: 1px solid #ddd;
    border-spacing: 0;
    border-collapse: collapse;
  }
  
  table th {
    padding: .2em 1em;
    background-color: #eee;
    border-top: 1px solid #ddd;
    border-left: 1px solid #ddd;
  }
  
  table td {
    padding: .2em 1em;
    border-top: 1px solid #ddd;
    border-left: 1px solid #ddd;
    vertical-align: top;
  }
  
  .author {
    font-size: 1.2em;
    text-align: center;
  }
  
  .sourceCode {
    background-color: #eee;
  }
  
  @media only screen and (min-width: 480px) {
    body {
      font-size: 14px;
    }
  }
  @media only screen and (min-width: 768px) {
    body {
      font-size: 16px;
    }
  }
  @media print {
    * {
      background: transparent !important;
      color: black !important;
      filter: none !important;
      -ms-filter: none !important;
    }
  
    body {
      font-size: 12pt;
      max-width: 100%;
    }
  
    a, a:visited {
      text-decoration: underline;
    }
  
    hr {
      height: 1px;
      border: 0;
      border-bottom: 1px solid black;
    }
  
    a[href]:after {
      content: " (" attr(href) ")";
    }
  
    abbr[title]:after {
      content: " (" attr(title) ")";
    }
  
    .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after {
      content: "";
    }
  
    pre, blockquote {
      border: 1px solid #999;
      padding-right: 1em;
      page-break-inside: avoid;
    }
  
    tr, img {
      page-break-inside: avoid;
    }
  
    img {
      max-width: 100% !important;
    }
  
    @page :left {
      margin: 15mm 20mm 15mm 10mm;
  }
  
    @page :right {
      margin: 15mm 10mm 15mm 20mm;
  }
  
    p, h2, h3 {
      orphans: 3;
      widows: 3;
    }
  
    h2, h3 {
      page-break-after: avoid;
    }
  }
  </style>
</head>
<body>
<header>
<h1 class="title">Ned.Data.Buffer.Test</h1>
</header>
<h2 id="contents">Contents</h2>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#generators">Generators</a></li>
<li><a href="#tests">Tests</a>
<ul>
<li><a href="#navigation-properties">Navigation properties</a></li>
<li><a href="#test-suite">Test Suite</a></li>
</ul></li>
</ul>
<h1 id="introduction">Introduction</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="ot">{-# LANGUAGE</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="ot">    UndecidableInstances</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="ot">  , ScopedTypeVariables</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="ot">  , FlexibleContexts</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="ot">#-}</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw">module</span> <span class="dt">Ned.Data.Buffer.Test</span> (</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">    test_Buffer</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="kw">import</span> <span class="dt">Data.Proxy</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="kw">import</span> <span class="dt">Data.List</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="kw">import</span> <span class="dt">System.Environment</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="kw">import</span> <span class="dt">Test.QuickCheck</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="kw">import</span> <span class="dt">Test.Tasty</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="kw">import</span> <span class="dt">Test.Tasty.QuickCheck</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="kw">import</span> <span class="dt">Ned.Data.FingerTree</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="kw">import</span> <span class="dt">Ned.Data.FingerTreeZip</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="kw">import</span> <span class="dt">Ned.Data.ReflectNat</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="kw">import</span> <span class="dt">Ned.Data.ScreenOffset</span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="kw">import</span> <span class="dt">Ned.Data.MeasureText</span></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="kw">import</span> <span class="dt">Ned.Data.Buffer</span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25"><span class="kw">import</span> <span class="dt">Ned.Data.Glyph</span></a>
<a class="sourceLine" id="cb1-26" data-line-number="26"></a>
<a class="sourceLine" id="cb1-27" data-line-number="27"><span class="kw">import</span> <span class="dt">Ned.Data.FingerTree.Test</span></a>
<a class="sourceLine" id="cb1-28" data-line-number="28"><span class="kw">import</span> <span class="dt">Ned.Data.FingerTreeZip.Test</span></a>
<a class="sourceLine" id="cb1-29" data-line-number="29"><span class="kw">import</span> <span class="dt">Ned.Data.ScreenOffset.Test</span></a>
<a class="sourceLine" id="cb1-30" data-line-number="30"><span class="kw">import</span> <span class="dt">Ned.Data.MeasureText.Test</span></a>
<a class="sourceLine" id="cb1-31" data-line-number="31"><span class="kw">import</span> <span class="dt">Ned.Data.ReflectNat.Test</span></a>
<a class="sourceLine" id="cb1-32" data-line-number="32"><span class="kw">import</span> <span class="dt">Ned.Data.Glyph.Test</span></a></code></pre></div>
<h1 id="generators">Generators</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">instance</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">  ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">  , <span class="dt">Arbitrary</span> a, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">  ) <span class="ot">=&gt;</span> <span class="dt">Arbitrary</span> (<span class="dt">Buffer</span> w t a)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">    arbitrary <span class="fu">=</span> mkTapeFocus</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">      <span class="fu">&lt;$&gt;</span> arbitrary</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">      <span class="fu">&lt;*&gt;</span> arbitrary</a>
<a class="sourceLine" id="cb2-9" data-line-number="9">      <span class="fu">&lt;*&gt;</span> arbitrary</a>
<a class="sourceLine" id="cb2-10" data-line-number="10"></a>
<a class="sourceLine" id="cb2-11" data-line-number="11">    shrink buf <span class="fu">=</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12">      <span class="kw">case</span> unBufferFocus buf <span class="kw">of</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">        <span class="dt">Nothing</span> <span class="ot">-&gt;</span> []</a>
<a class="sourceLine" id="cb2-14" data-line-number="14">        <span class="dt">Just</span> (as, x, bs) <span class="ot">-&gt;</span> mkEmptyBuffer <span class="fu">:</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15">          [ mkTapeFocus as&#39; x bs&#39;</a>
<a class="sourceLine" id="cb2-16" data-line-number="16">            <span class="fu">|</span> as&#39; <span class="ot">&lt;-</span> shrink as, bs&#39; <span class="ot">&lt;-</span> shrink bs ]</a></code></pre></div>
<p>Generates valid input/output pairs for <code>renderBuffer</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb3-1" data-line-number="1">genRenderBuffer</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="ot">  ::</span> forall w t a</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">   <span class="fu">.</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">     , <span class="dt">Arbitrary</span> a, <span class="dt">Eq</span> a, <span class="dt">Show</span> a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">NonNegative</span> <span class="dt">Int</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Gen</span> (<span class="dt">Int</span>, <span class="dt">Int</span>, <span class="dt">Buffer</span> w t a, [<span class="dt">Maybe</span> <span class="dt">Int</span>], [[a]])</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">genRenderBuffer pw pt _ (<span class="dt">NonNegative</span> k) <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9">  <span class="kw">let</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10">    w <span class="fu">=</span> toWidth pw</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">    t <span class="fu">=</span> toTab pt</a>
<a class="sourceLine" id="cb3-12" data-line-number="12"></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="ot">    brokenLine ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Gen</span> [(<span class="dt">Maybe</span> <span class="dt">Int</span>, [a])]</a>
<a class="sourceLine" id="cb3-14" data-line-number="14">    brokenLine n <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15">      u <span class="ot">&lt;-</span> choose (k<span class="fu">*</span>w, (k<span class="fu">+</span><span class="dv">1</span>)<span class="fu">*</span>w <span class="fu">-</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-16" data-line-number="16">      <span class="kw">let</span> char <span class="fu">=</span> choose (<span class="ch">&#39;a&#39;</span>,<span class="ch">&#39;z&#39;</span>)</a>
<a class="sourceLine" id="cb3-17" data-line-number="17">      cs <span class="ot">&lt;-</span> vectorOf u char</a>
<a class="sourceLine" id="cb3-18" data-line-number="18">      <span class="kw">let</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19">        labels <span class="fu">=</span> <span class="dt">Just</span> n <span class="fu">:</span> repeat <span class="dt">Nothing</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20">        chunks <span class="fu">=</span> map (map fromChar) <span class="fu">$</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21">          breakLinesAtWidth t w (cs <span class="fu">++</span> <span class="st">&quot;\n&quot;</span>)</a>
<a class="sourceLine" id="cb3-22" data-line-number="22">      return <span class="fu">$</span> zip labels chunks</a>
<a class="sourceLine" id="cb3-23" data-line-number="23"></a>
<a class="sourceLine" id="cb3-24" data-line-number="24">  <span class="dt">NonNegative</span> top <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb3-25" data-line-number="25">  <span class="dt">Positive</span> height <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb3-26" data-line-number="26">  <span class="dt">NonNegative</span> pad <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb3-27" data-line-number="27"></a>
<a class="sourceLine" id="cb3-28" data-line-number="28">  (labelss, chunkss) <span class="ot">&lt;-</span> (unzip <span class="fu">.</span> concat) <span class="fu">&lt;$&gt;</span></a>
<a class="sourceLine" id="cb3-29" data-line-number="29">    mapM brokenLine [<span class="dv">0</span><span class="fu">..</span>(top<span class="fu">+</span>height<span class="fu">+</span>pad)]</a>
<a class="sourceLine" id="cb3-30" data-line-number="30"></a>
<a class="sourceLine" id="cb3-31" data-line-number="31">  <span class="kw">let</span></a>
<a class="sourceLine" id="cb3-32" data-line-number="32">    labels <span class="fu">=</span> take height <span class="fu">$</span> drop top labelss</a>
<a class="sourceLine" id="cb3-33" data-line-number="33">    chunks <span class="fu">=</span> take height <span class="fu">$</span> drop top chunkss</a>
<a class="sourceLine" id="cb3-34" data-line-number="34"></a>
<a class="sourceLine" id="cb3-35" data-line-number="35">    buf <span class="fu">=</span> mkTape <span class="fu">$</span> concat chunkss</a>
<a class="sourceLine" id="cb3-36" data-line-number="36"></a>
<a class="sourceLine" id="cb3-37" data-line-number="37">  return (top, height, buf, labels, chunks)</a></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co">{- genBufferFixed1</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">  :: forall w t a</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">   . ( IsWidth w, IsTab t, Valued (MeasureText w t) a</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">     , Arbitrary a, Eq a, Show a, IsChar a )</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">  =&gt; [Positive Int]</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">  -&gt; Gen ([Maybe Int], [[a]], Buffer w t a)</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">genBufferFixed1 ks = do</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">  let</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">    w = toWidth (Proxy :: Proxy w)</span></a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb5-1" data-line-number="1">    ln</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="ot">      ::</span> (<span class="dt">Int</span>, <span class="dt">Positive</span> <span class="dt">Int</span>)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">      <span class="ot">-&gt;</span> <span class="dt">Gen</span> ([<span class="dt">Maybe</span> <span class="dt">Int</span>], [[a]], [a])</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">    ln (i, <span class="dt">Positive</span> k) <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">      as <span class="ot">&lt;-</span> map fromChar</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">        <span class="fu">&lt;$&gt;</span> vectorOf k (choose (<span class="ch">&#39;a&#39;</span>,<span class="ch">&#39;z&#39;</span>))</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">      <span class="kw">let</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8">        (lbs, lns) <span class="fu">=</span> unzip <span class="fu">$</span> zip</a>
<a class="sourceLine" id="cb5-9" data-line-number="9">          (<span class="dt">Just</span> i <span class="fu">:</span> repeat <span class="dt">Nothing</span>)</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">          (chunksOf w as)</a>
<a class="sourceLine" id="cb5-11" data-line-number="11">      return (lbs, lns, as)</a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb6-1" data-line-number="1">  (labelss, liness, css) <span class="ot">&lt;-</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">    unzip3 <span class="fu">&lt;$&gt;</span> (sequence <span class="fu">$</span> map ln <span class="fu">$</span> zip [<span class="dv">0</span><span class="fu">..</span>] ks)</a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb7-1" data-line-number="1">  return</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">    ( concat labelss</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">    , concat liness</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">    , mkBuffer <span class="fu">$</span> intercalate [fromChar <span class="ch">&#39;\n&#39;</span>] css</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">    )</a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb8-1" data-line-number="1">genRenderWrapFixed1</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="ot">  ::</span> forall w t a</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">   <span class="fu">.</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">     , <span class="dt">Arbitrary</span> a, <span class="dt">Eq</span> a, <span class="dt">Show</span> a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Positive</span> <span class="dt">Int</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">Gen</span> ([<span class="dt">Maybe</span> <span class="dt">Int</span>], [[a]], <span class="dt">Buffer</span> w t a)</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">genRenderWrapFixed1 (<span class="dt">Positive</span> h) <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8">  <span class="kw">let</span> w <span class="fu">=</span> toWidth (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> w)</a>
<a class="sourceLine" id="cb8-9" data-line-number="9">  len <span class="ot">&lt;-</span> choose (w<span class="fu">+</span><span class="dv">1</span>, w<span class="fu">*</span>h)</a>
<a class="sourceLine" id="cb8-10" data-line-number="10">  genBufferFixed1 [<span class="dt">Positive</span> len] <span class="fu">-</span>}</a></code></pre></div>
<h1 id="tests">Tests</h1>
<div class="sourceCode" id="cb9"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb9-1" data-line-number="1">test_Buffer_properties</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="ot">  ::</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">     , <span class="dt">Arbitrary</span> a, <span class="dt">Show</span> a, <span class="dt">Eq</span> a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5">test_Buffer_properties pw pt pa <span class="fu">=</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6">  testGroup <span class="st">&quot;Buffer&quot;</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7">    [ test_Buffer_basics pw pt pa</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">    , test_Buffer_nav pw pt pa</a>
<a class="sourceLine" id="cb9-9" data-line-number="9">    , test_Buffer_split pw pt pa</a>
<a class="sourceLine" id="cb9-10" data-line-number="10">    , localOption (<span class="dt">QuickCheckTests</span> <span class="dv">500</span>) <span class="fu">$</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11">        test_Buffer_renderBuffer pw pt pa</a>
<a class="sourceLine" id="cb9-12" data-line-number="12">    ]</a></code></pre></div>
<h2 id="basics">Basics</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb10-1" data-line-number="1">test_Buffer_basics</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="ot">  ::</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">     , <span class="dt">Arbitrary</span> a, <span class="dt">Show</span> a, <span class="dt">Eq</span> a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5">test_Buffer_basics pw pt pa <span class="fu">=</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6">  testGroup <span class="st">&quot;Basics&quot;</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7">    [ test_Buffer_validate pw pt pa</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">    , test_Buffer_debug pw pt pa</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">    , test_Buffer_afterLineCol_monotone pw pt pa</a>
<a class="sourceLine" id="cb10-10" data-line-number="10">    , localOption (<span class="dt">QuickCheckTests</span> <span class="dv">1000</span>) <span class="fu">$</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11">        test_Buffer_afterScreenCoords_monotone pw pt pa</a>
<a class="sourceLine" id="cb10-12" data-line-number="12">    ]</a></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb11-1" data-line-number="1">prop_Buffer_validate</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="ot">  ::</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">     , <span class="dt">Arbitrary</span> a, <span class="dt">Show</span> a, <span class="dt">Eq</span> a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">  <span class="ot">-&gt;</span> <span class="dt">Buffer</span> w t a</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"></a>
<a class="sourceLine" id="cb11-8" data-line-number="8">prop_Buffer_validate _ _ _ buf <span class="fu">=</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9">  property <span class="fu">$</span> validateBuffer buf</a>
<a class="sourceLine" id="cb11-10" data-line-number="10"></a>
<a class="sourceLine" id="cb11-11" data-line-number="11">test_Buffer_validate</a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="ot">  ::</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb11-13" data-line-number="13">     , <span class="dt">Arbitrary</span> a, <span class="dt">Show</span> a, <span class="dt">Eq</span> a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb11-14" data-line-number="14">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a</a>
<a class="sourceLine" id="cb11-15" data-line-number="15">  <span class="ot">-&gt;</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16">test_Buffer_validate pw pt pa <span class="fu">=</span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17">  testProperty <span class="st">&quot;Validate&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb11-18" data-line-number="18">    prop_Buffer_validate pw pt pa</a></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb12-1" data-line-number="1">prop_Buffer_debug</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="ot">  ::</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">     , <span class="dt">Arbitrary</span> a, <span class="dt">Show</span> a, <span class="dt">Eq</span> a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">  <span class="ot">-&gt;</span> <span class="dt">Buffer</span> w t a</a>
<a class="sourceLine" id="cb12-6" data-line-number="6">  <span class="ot">-&gt;</span> [(<span class="dt">Char</span>, <span class="dt">MeasureText</span> w t)]</a>
<a class="sourceLine" id="cb12-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"></a>
<a class="sourceLine" id="cb12-9" data-line-number="9">prop_Buffer_debug _ _ _ buf zs <span class="fu">=</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10">  <span class="kw">let</span> ws <span class="fu">=</span> map (\(c, m) <span class="ot">-&gt;</span> (fromChar c, m)) zs <span class="kw">in</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11">  ws <span class="fu">===</span> toListDebugBuffer buf</a>
<a class="sourceLine" id="cb12-12" data-line-number="12"></a>
<a class="sourceLine" id="cb12-13" data-line-number="13">test_Buffer_debug</a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="ot">  ::</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb12-15" data-line-number="15">     , <span class="dt">Arbitrary</span> a, <span class="dt">Show</span> a, <span class="dt">Eq</span> a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb12-16" data-line-number="16">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a</a>
<a class="sourceLine" id="cb12-17" data-line-number="17">  <span class="ot">-&gt;</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb12-18" data-line-number="18">test_Buffer_debug pw pt pa <span class="fu">=</span></a>
<a class="sourceLine" id="cb12-19" data-line-number="19">  testGroup <span class="st">&quot;Debug examples&quot;</span></a>
<a class="sourceLine" id="cb12-20" data-line-number="20">    [ testCases</a>
<a class="sourceLine" id="cb12-21" data-line-number="21">      (uncurry <span class="fu">$</span> prop_Buffer_debug pw pt pa)</a>
<a class="sourceLine" id="cb12-22" data-line-number="22">      [ ( <span class="st">&quot;#1&quot;</span></a>
<a class="sourceLine" id="cb12-23" data-line-number="23">        , ( charBuffer pw pt</a>
<a class="sourceLine" id="cb12-24" data-line-number="24">              <span class="st">&quot;a&quot;</span></a>
<a class="sourceLine" id="cb12-25" data-line-number="25">          , [ (<span class="ch">&#39;a&#39;</span>, mText <span class="dv">1</span> <span class="dv">1</span> (<span class="dv">0</span>,<span class="dv">0</span>) (<span class="dv">1</span>,<span class="dv">0</span>) (<span class="dv">0</span>,<span class="dv">1</span>) ( mkNoNewlines [(<span class="dv">1</span>,<span class="dt">Fixed1</span>)]))</a>
<a class="sourceLine" id="cb12-26" data-line-number="26">            ]</a>
<a class="sourceLine" id="cb12-27" data-line-number="27">          )</a>
<a class="sourceLine" id="cb12-28" data-line-number="28">        )</a>
<a class="sourceLine" id="cb12-29" data-line-number="29"></a>
<a class="sourceLine" id="cb12-30" data-line-number="30">      , ( <span class="st">&quot;#2&quot;</span></a>
<a class="sourceLine" id="cb12-31" data-line-number="31">        , ( charBuffer pw pt</a>
<a class="sourceLine" id="cb12-32" data-line-number="32">              <span class="st">&quot;abc\n&quot;</span></a>
<a class="sourceLine" id="cb12-33" data-line-number="33">          , [ (<span class="ch">&#39;a&#39;</span>,  mText <span class="dv">1</span> <span class="dv">1</span> (<span class="dv">0</span>,<span class="dv">0</span>) (<span class="dv">1</span>,<span class="dv">0</span>) (<span class="dv">0</span>,<span class="dv">1</span>) ( mkNoNewlines [(<span class="dv">1</span>,<span class="dt">Fixed1</span>)]))</a>
<a class="sourceLine" id="cb12-34" data-line-number="34">            , (<span class="ch">&#39;b&#39;</span>,  mText <span class="dv">2</span> <span class="dv">2</span> (<span class="dv">0</span>,<span class="dv">1</span>) (<span class="dv">2</span>,<span class="dv">0</span>) (<span class="dv">0</span>,<span class="dv">2</span>) ( mkNoNewlines [(<span class="dv">2</span>,<span class="dt">Fixed1</span>)]))</a>
<a class="sourceLine" id="cb12-35" data-line-number="35">            , (<span class="ch">&#39;c&#39;</span>,  mText <span class="dv">3</span> <span class="dv">3</span> (<span class="dv">0</span>,<span class="dv">2</span>) (<span class="dv">3</span>,<span class="dv">0</span>) (<span class="dv">0</span>,<span class="dv">3</span>) ( mkNoNewlines [(<span class="dv">3</span>,<span class="dt">Fixed1</span>)]))</a>
<a class="sourceLine" id="cb12-36" data-line-number="36">            , (<span class="ch">&#39;\n&#39;</span>, mText <span class="dv">4</span> <span class="dv">4</span> (<span class="dv">0</span>,<span class="dv">3</span>) (<span class="dv">0</span>,<span class="dv">1</span>) (<span class="dv">1</span>,<span class="dv">0</span>) ( mkWithNewlines [(<span class="dv">3</span>,<span class="dt">Fixed1</span>)] <span class="dv">1</span> []))</a>
<a class="sourceLine" id="cb12-37" data-line-number="37">            ]</a>
<a class="sourceLine" id="cb12-38" data-line-number="38">          )</a>
<a class="sourceLine" id="cb12-39" data-line-number="39">        )</a>
<a class="sourceLine" id="cb12-40" data-line-number="40">      ]</a>
<a class="sourceLine" id="cb12-41" data-line-number="41">    ]</a></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb13-1" data-line-number="1">prop_Buffer_afterLineCol_monotone</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="ot">  ::</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">     , <span class="dt">Arbitrary</span> a, <span class="dt">Show</span> a, <span class="dt">Eq</span> a )</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">  <span class="ot">-&gt;</span> <span class="dt">Buffer</span> w t a</a>
<a class="sourceLine" id="cb13-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">LineCol</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"></a>
<a class="sourceLine" id="cb13-9" data-line-number="9">prop_Buffer_afterLineCol_monotone _ _ _ buf w <span class="fu">=</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11">    and <span class="fu">$</span> dropWhile (<span class="fu">==</span> <span class="dt">False</span>) <span class="fu">$</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12">      map (afterLineCol w <span class="fu">.</span> snd) <span class="fu">$</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13">      toListDebugBuffer buf</a>
<a class="sourceLine" id="cb13-14" data-line-number="14"></a>
<a class="sourceLine" id="cb13-15" data-line-number="15">test_Buffer_afterLineCol_monotone</a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="ot">  ::</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb13-17" data-line-number="17">     , <span class="dt">Arbitrary</span> a, <span class="dt">Show</span> a, <span class="dt">Eq</span> a )</a>
<a class="sourceLine" id="cb13-18" data-line-number="18">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a</a>
<a class="sourceLine" id="cb13-19" data-line-number="19">  <span class="ot">-&gt;</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb13-20" data-line-number="20">test_Buffer_afterLineCol_monotone pw pt pa <span class="fu">=</span></a>
<a class="sourceLine" id="cb13-21" data-line-number="21">  testProperty <span class="st">&quot;afterLineCol is monotone on buffers&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb13-22" data-line-number="22">    prop_Buffer_afterLineCol_monotone pw pt pa</a></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb14-1" data-line-number="1">prop_Buffer_afterScreenCoords_monotone</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="ot">  ::</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">     , <span class="dt">Arbitrary</span> a, <span class="dt">Show</span> a, <span class="dt">Eq</span> a )</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">  <span class="ot">-&gt;</span> <span class="dt">Buffer</span> w t a</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">  <span class="ot">-&gt;</span> (<span class="dt">NonNegative</span> <span class="dt">Int</span>, <span class="dt">NonNegative</span> <span class="dt">Int</span>)</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"></a>
<a class="sourceLine" id="cb14-9" data-line-number="9">prop_Buffer_afterScreenCoords_monotone _ _ _ buf (<span class="dt">NonNegative</span> u, <span class="dt">NonNegative</span> v) <span class="fu">=</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11">    and <span class="fu">$</span> dropWhile (<span class="fu">==</span> <span class="dt">False</span>) <span class="fu">$</span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12">      map (afterScreenCoords (u,v) <span class="fu">.</span> snd) <span class="fu">$</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13">      toListDebugBuffer buf</a>
<a class="sourceLine" id="cb14-14" data-line-number="14"></a>
<a class="sourceLine" id="cb14-15" data-line-number="15">test_Buffer_afterScreenCoords_monotone</a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="ot">  ::</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb14-17" data-line-number="17">     , <span class="dt">Arbitrary</span> a, <span class="dt">Show</span> a, <span class="dt">Eq</span> a )</a>
<a class="sourceLine" id="cb14-18" data-line-number="18">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a</a>
<a class="sourceLine" id="cb14-19" data-line-number="19">  <span class="ot">-&gt;</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb14-20" data-line-number="20">test_Buffer_afterScreenCoords_monotone pw pt pa <span class="fu">=</span></a>
<a class="sourceLine" id="cb14-21" data-line-number="21">  testProperty <span class="st">&quot;afterScreenCoords is monotone on buffers&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb14-22" data-line-number="22">    prop_Buffer_afterScreenCoords_monotone pw pt pa</a></code></pre></div>
<h2 id="navigation-properties">Navigation properties</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb15-1" data-line-number="1">test_Buffer_nav</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="ot">  ::</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">     , <span class="dt">Arbitrary</span> a, <span class="dt">Show</span> a, <span class="dt">Eq</span> a )</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">  <span class="ot">-&gt;</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb15-6" data-line-number="6">test_Buffer_nav pw pt pa <span class="fu">=</span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7">  testGroup <span class="st">&quot;Basic navigation&quot;</span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8">    [ testProperty <span class="st">&quot;initMove; bufferHeadLineCol&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb15-9" data-line-number="9">        prop_Buffer_bufferHeadLineCol_initMove pw pt pa</a>
<a class="sourceLine" id="cb15-10" data-line-number="10">    , testProperty <span class="st">&quot;bufferHeadLineCol; splitBufferAtLineCol&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11">        prop_Buffer_bufferHeadLineCol_splitBufferAtLineCol pw pt pa</a>
<a class="sourceLine" id="cb15-12" data-line-number="12">    , testProperty <span class="st">&quot;bufferHeadLineCol headMoveAfter&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13">        cprop_Buffer_bufferHeadLineCol_headMoveAfter pw pt pa</a>
<a class="sourceLine" id="cb15-14" data-line-number="14">    ]</a></code></pre></div>
<p>Steps:</p>
<pre><code>1. Move the read head to the beginning
2. Get the read head line and column</code></pre>
<p>Expect:</p>
<pre><code>1. We&#39;re at line 0, column 0</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb18-1" data-line-number="1">prop_Buffer_bufferHeadLineCol_initMove</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="ot">  ::</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a, <span class="dt">Eq</span> a, <span class="dt">Show</span> a )</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a</a>
<a class="sourceLine" id="cb18-4" data-line-number="4">  <span class="ot">-&gt;</span> <span class="dt">Buffer</span> w t a <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5">prop_Buffer_bufferHeadLineCol_initMove _ _ _ xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb18-6" data-line-number="6">  mempty <span class="fu">===</span> bufferHeadLineCol (initMove xs)</a></code></pre></div>
<p>Steps:</p>
<pre><code>1. Get the read head line and column
2. Move the read head to that line and column</code></pre>
<p>Expect:</p>
<pre><code>1. The buffer did not change</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb21-1" data-line-number="1">prop_Buffer_bufferHeadLineCol_splitBufferAtLineCol</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="ot">  ::</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a, <span class="dt">Eq</span> a, <span class="dt">Show</span> a )</a>
<a class="sourceLine" id="cb21-3" data-line-number="3">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a</a>
<a class="sourceLine" id="cb21-4" data-line-number="4">  <span class="ot">-&gt;</span> <span class="dt">Buffer</span> w t a <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5">prop_Buffer_bufferHeadLineCol_splitBufferAtLineCol _ _ _ xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6">  xs <span class="fu">===</span> splitBufferAtLineCol (bufferHeadLineCol xs) xs</a></code></pre></div>
<p>Preconditions:</p>
<pre><code>1. Buffer is not empty and head is not at the end</code></pre>
<p>Steps:</p>
<pre><code>1. Get the read head line and column
2. Move right one step and get the read head position</code></pre>
<p>Expect:</p>
<pre><code>1. New line and column is old line and column &lt;&gt; head value</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb25-1" data-line-number="1">prop_Buffer_bufferHeadLineCol_headMoveAfter</a>
<a class="sourceLine" id="cb25-2" data-line-number="2">   , cprop_Buffer_bufferHeadLineCol_headMoveAfter</a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="ot">  ::</span> forall w t a</a>
<a class="sourceLine" id="cb25-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a )</a>
<a class="sourceLine" id="cb25-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a</a>
<a class="sourceLine" id="cb25-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">Buffer</span> w t a</a>
<a class="sourceLine" id="cb25-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb25-8" data-line-number="8"></a>
<a class="sourceLine" id="cb25-9" data-line-number="9">prop_Buffer_bufferHeadLineCol_headMoveAfter _ _ _ buf <span class="fu">=</span></a>
<a class="sourceLine" id="cb25-10" data-line-number="10">  <span class="kw">if</span> (isEmpty buf) <span class="fu">||</span> (isAtLast buf)</a>
<a class="sourceLine" id="cb25-11" data-line-number="11">    <span class="kw">then</span> property <span class="dt">True</span></a>
<a class="sourceLine" id="cb25-12" data-line-number="12">    <span class="kw">else</span></a>
<a class="sourceLine" id="cb25-13" data-line-number="13">      <span class="kw">let</span></a>
<a class="sourceLine" id="cb25-14" data-line-number="14">        <span class="dt">Just</span> a <span class="fu">=</span> headRead buf</a>
<a class="sourceLine" id="cb25-15" data-line-number="15">        m <span class="fu">=</span> value<span class="ot"> a ::</span> <span class="dt">MeasureText</span> w t</a>
<a class="sourceLine" id="cb25-16" data-line-number="16">      <span class="kw">in</span></a>
<a class="sourceLine" id="cb25-17" data-line-number="17">        bufferHeadLineCol (headMoveR buf)</a>
<a class="sourceLine" id="cb25-18" data-line-number="18">         <span class="fu">===</span> (bufferHeadLineCol buf) <span class="fu">&lt;&gt;</span> (logicalOffset m)</a>
<a class="sourceLine" id="cb25-19" data-line-number="19"></a>
<a class="sourceLine" id="cb25-20" data-line-number="20">cprop_Buffer_bufferHeadLineCol_headMoveAfter pw pt pa buf <span class="fu">=</span></a>
<a class="sourceLine" id="cb25-21" data-line-number="21">  cover <span class="dv">30</span> (not <span class="fu">$</span> isEmpty buf) <span class="st">&quot;buf not empty&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb25-22" data-line-number="22">  cover <span class="dv">30</span> (not <span class="fu">$</span> isAtLast buf) <span class="st">&quot;head not at last&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb25-23" data-line-number="23">  prop_Buffer_bufferHeadLineCol_headMoveAfter pw pt pa buf</a></code></pre></div>
<h2 id="splitting-properties">Splitting properties</h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb26-1" data-line-number="1">test_Buffer_split</a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="ot">  ::</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb26-3" data-line-number="3">     , <span class="dt">Arbitrary</span> a, <span class="dt">Show</span> a, <span class="dt">Eq</span> a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb26-4" data-line-number="4">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a</a>
<a class="sourceLine" id="cb26-5" data-line-number="5">  <span class="ot">-&gt;</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb26-6" data-line-number="6">test_Buffer_split pw pt pa <span class="fu">=</span></a>
<a class="sourceLine" id="cb26-7" data-line-number="7">  testGroup <span class="st">&quot;Splitting&quot;</span></a>
<a class="sourceLine" id="cb26-8" data-line-number="8">    [ test_Buffer_splitBufferAtScreenLine_examples pw pt pa</a>
<a class="sourceLine" id="cb26-9" data-line-number="9">    , test_Buffer_splitBufferAtScreenCoords_examples pw pt pa</a>
<a class="sourceLine" id="cb26-10" data-line-number="10">    , test_Buffer_splitBufferAtLineCol_focus pw pt pa</a>
<a class="sourceLine" id="cb26-11" data-line-number="11">    , test_Buffer_splitBufferAtScreenCoords_focus pw pt pa</a>
<a class="sourceLine" id="cb26-12" data-line-number="12">    ]</a></code></pre></div>
<p>Examples for checking our intuition about screen line splitting:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb27-1" data-line-number="1">prop_Buffer_splitBufferAtScreenLine_examples</a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="ot">  ::</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb27-3" data-line-number="3">     , <span class="dt">Arbitrary</span> a, <span class="dt">Show</span> a, <span class="dt">Eq</span> a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb27-4" data-line-number="4">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a</a>
<a class="sourceLine" id="cb27-5" data-line-number="5">  <span class="ot">-&gt;</span> <span class="dt">NonNegative</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Buffer</span> w t a <span class="ot">-&gt;</span> <span class="dt">Buffer</span> w t a</a>
<a class="sourceLine" id="cb27-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb27-7" data-line-number="7">prop_Buffer_splitBufferAtScreenLine_examples _ _ _</a>
<a class="sourceLine" id="cb27-8" data-line-number="8">  (<span class="dt">NonNegative</span> k) buf1 buf2 <span class="fu">=</span></a>
<a class="sourceLine" id="cb27-9" data-line-number="9">  buf2 <span class="fu">===</span> splitBufferAtScreenLine k buf1</a>
<a class="sourceLine" id="cb27-10" data-line-number="10"></a>
<a class="sourceLine" id="cb27-11" data-line-number="11">test_Buffer_splitBufferAtScreenLine_examples</a>
<a class="sourceLine" id="cb27-12" data-line-number="12"><span class="ot">  ::</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb27-13" data-line-number="13">     , <span class="dt">Arbitrary</span> a, <span class="dt">Show</span> a, <span class="dt">Eq</span> a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb27-14" data-line-number="14">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb27-15" data-line-number="15">test_Buffer_splitBufferAtScreenLine_examples pw pt pa <span class="fu">=</span></a>
<a class="sourceLine" id="cb27-16" data-line-number="16">  testGroup <span class="st">&quot;Examples&quot;</span></a>
<a class="sourceLine" id="cb27-17" data-line-number="17">    [ testCases</a>
<a class="sourceLine" id="cb27-18" data-line-number="18">      (uncurry3 <span class="fu">$</span> prop_Buffer_splitBufferAtScreenLine_examples pw pt pa)</a>
<a class="sourceLine" id="cb27-19" data-line-number="19">      [ ( <span class="st">&quot;Line 0&quot;</span></a>
<a class="sourceLine" id="cb27-20" data-line-number="20">        , ( <span class="dt">NonNegative</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb27-21" data-line-number="21">          , charBufferFocus pw pt</a>
<a class="sourceLine" id="cb27-22" data-line-number="22">              <span class="st">&quot;abc\nde&quot;</span> <span class="ch">&#39;f&#39;</span> <span class="st">&quot;\nghi&quot;</span></a>
<a class="sourceLine" id="cb27-23" data-line-number="23">          , charBufferFocus pw pt</a>
<a class="sourceLine" id="cb27-24" data-line-number="24">              <span class="st">&quot;&quot;</span> <span class="ch">&#39;a&#39;</span> <span class="st">&quot;bc\ndef\nghi&quot;</span></a>
<a class="sourceLine" id="cb27-25" data-line-number="25">          )</a>
<a class="sourceLine" id="cb27-26" data-line-number="26">        )</a>
<a class="sourceLine" id="cb27-27" data-line-number="27"></a>
<a class="sourceLine" id="cb27-28" data-line-number="28">      , ( <span class="st">&quot;Line 1&quot;</span></a>
<a class="sourceLine" id="cb27-29" data-line-number="29">        , ( <span class="dt">NonNegative</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb27-30" data-line-number="30">          , charBufferFocus pw pt</a>
<a class="sourceLine" id="cb27-31" data-line-number="31">              <span class="st">&quot;abc\nde\nf&quot;</span> <span class="ch">&#39;g&#39;</span> <span class="st">&quot;h&quot;</span></a>
<a class="sourceLine" id="cb27-32" data-line-number="32">          , charBufferFocus pw pt</a>
<a class="sourceLine" id="cb27-33" data-line-number="33">              <span class="st">&quot;abc\n&quot;</span> <span class="ch">&#39;d&#39;</span> <span class="st">&quot;e\nfgh&quot;</span></a>
<a class="sourceLine" id="cb27-34" data-line-number="34">          )</a>
<a class="sourceLine" id="cb27-35" data-line-number="35">        )</a>
<a class="sourceLine" id="cb27-36" data-line-number="36"></a>
<a class="sourceLine" id="cb27-37" data-line-number="37">      , ( <span class="st">&quot;Line 2&quot;</span></a>
<a class="sourceLine" id="cb27-38" data-line-number="38">        , ( <span class="dt">NonNegative</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb27-39" data-line-number="39">          , charBufferFocus pw pt</a>
<a class="sourceLine" id="cb27-40" data-line-number="40">              <span class="st">&quot;abc\nde\nf&quot;</span> <span class="ch">&#39;g&#39;</span> <span class="st">&quot;h&quot;</span></a>
<a class="sourceLine" id="cb27-41" data-line-number="41">          , charBufferFocus pw pt</a>
<a class="sourceLine" id="cb27-42" data-line-number="42">              <span class="st">&quot;abc\nde\n&quot;</span> <span class="ch">&#39;f&#39;</span> <span class="st">&quot;gh&quot;</span></a>
<a class="sourceLine" id="cb27-43" data-line-number="43">          )</a>
<a class="sourceLine" id="cb27-44" data-line-number="44">        )</a>
<a class="sourceLine" id="cb27-45" data-line-number="45">      ]</a>
<a class="sourceLine" id="cb27-46" data-line-number="46">    ]</a></code></pre></div>
<p>Examples for checking our intuition about screen coordinate splitting:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb28-1" data-line-number="1">prop_Buffer_splitBufferAtScreenCoords_examples</a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="ot">  ::</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb28-3" data-line-number="3">     , <span class="dt">Arbitrary</span> a, <span class="dt">Show</span> a, <span class="dt">Eq</span> a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb28-4" data-line-number="4">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a</a>
<a class="sourceLine" id="cb28-5" data-line-number="5">  <span class="ot">-&gt;</span> (<span class="dt">NonNegative</span> <span class="dt">Int</span>, <span class="dt">NonNegative</span> <span class="dt">Int</span>)</a>
<a class="sourceLine" id="cb28-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">Buffer</span> w t a <span class="ot">-&gt;</span> <span class="dt">Buffer</span> w t a</a>
<a class="sourceLine" id="cb28-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb28-8" data-line-number="8">prop_Buffer_splitBufferAtScreenCoords_examples _ _ _</a>
<a class="sourceLine" id="cb28-9" data-line-number="9">  (<span class="dt">NonNegative</span> u, <span class="dt">NonNegative</span> v) buf1 buf2 <span class="fu">=</span></a>
<a class="sourceLine" id="cb28-10" data-line-number="10">  buf2 <span class="fu">===</span> splitBufferAtScreenCoords (u,v) buf1</a>
<a class="sourceLine" id="cb28-11" data-line-number="11"></a>
<a class="sourceLine" id="cb28-12" data-line-number="12">test_Buffer_splitBufferAtScreenCoords_examples</a>
<a class="sourceLine" id="cb28-13" data-line-number="13"><span class="ot">  ::</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb28-14" data-line-number="14">     , <span class="dt">Arbitrary</span> a, <span class="dt">Show</span> a, <span class="dt">Eq</span> a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb28-15" data-line-number="15">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb28-16" data-line-number="16">test_Buffer_splitBufferAtScreenCoords_examples pw pt pa <span class="fu">=</span></a>
<a class="sourceLine" id="cb28-17" data-line-number="17">  testGroup <span class="st">&quot;Examples&quot;</span></a>
<a class="sourceLine" id="cb28-18" data-line-number="18">    [ testCases</a>
<a class="sourceLine" id="cb28-19" data-line-number="19">      (uncurry3 <span class="fu">$</span> prop_Buffer_splitBufferAtScreenCoords_examples pw pt pa)</a>
<a class="sourceLine" id="cb28-20" data-line-number="20">      [ ( <span class="st">&quot;(0,0)&quot;</span></a>
<a class="sourceLine" id="cb28-21" data-line-number="21">        , ( (<span class="dt">NonNegative</span> <span class="dv">0</span>, <span class="dt">NonNegative</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb28-22" data-line-number="22">          , charBufferFocus pw pt</a>
<a class="sourceLine" id="cb28-23" data-line-number="23">              <span class="st">&quot;abc\nde&quot;</span> <span class="ch">&#39;f&#39;</span> <span class="st">&quot;\nghi&quot;</span></a>
<a class="sourceLine" id="cb28-24" data-line-number="24">          , charBufferFocus pw pt</a>
<a class="sourceLine" id="cb28-25" data-line-number="25">              <span class="st">&quot;&quot;</span> <span class="ch">&#39;a&#39;</span> <span class="st">&quot;bc\ndef\nghi&quot;</span></a>
<a class="sourceLine" id="cb28-26" data-line-number="26">          )</a>
<a class="sourceLine" id="cb28-27" data-line-number="27">        )</a>
<a class="sourceLine" id="cb28-28" data-line-number="28"></a>
<a class="sourceLine" id="cb28-29" data-line-number="29">      , ( <span class="st">&quot;(1,1)&quot;</span></a>
<a class="sourceLine" id="cb28-30" data-line-number="30">        , ( (<span class="dt">NonNegative</span> <span class="dv">1</span>, <span class="dt">NonNegative</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb28-31" data-line-number="31">          , charBufferFocus pw pt</a>
<a class="sourceLine" id="cb28-32" data-line-number="32">              <span class="st">&quot;abc\nde\nf&quot;</span> <span class="ch">&#39;g&#39;</span> <span class="st">&quot;h&quot;</span></a>
<a class="sourceLine" id="cb28-33" data-line-number="33">          , charBufferFocus pw pt</a>
<a class="sourceLine" id="cb28-34" data-line-number="34">              <span class="st">&quot;abc\nd&quot;</span> <span class="ch">&#39;e&#39;</span> <span class="st">&quot;\nfgh&quot;</span></a>
<a class="sourceLine" id="cb28-35" data-line-number="35">          )</a>
<a class="sourceLine" id="cb28-36" data-line-number="36">        )</a>
<a class="sourceLine" id="cb28-37" data-line-number="37"></a>
<a class="sourceLine" id="cb28-38" data-line-number="38">      , ( <span class="st">&quot;Coords DNE&quot;</span></a>
<a class="sourceLine" id="cb28-39" data-line-number="39">        , ( (<span class="dt">NonNegative</span> <span class="dv">5</span>, <span class="dt">NonNegative</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb28-40" data-line-number="40">          , charBufferFocus pw pt</a>
<a class="sourceLine" id="cb28-41" data-line-number="41">              <span class="st">&quot;abc\nde\nf&quot;</span> <span class="ch">&#39;g&#39;</span> <span class="st">&quot;h&quot;</span></a>
<a class="sourceLine" id="cb28-42" data-line-number="42">          , charBufferFocus pw pt</a>
<a class="sourceLine" id="cb28-43" data-line-number="43">              <span class="st">&quot;abc\nde&quot;</span> <span class="ch">&#39;\n&#39;</span> <span class="st">&quot;fgh&quot;</span></a>
<a class="sourceLine" id="cb28-44" data-line-number="44">          )</a>
<a class="sourceLine" id="cb28-45" data-line-number="45">        )</a>
<a class="sourceLine" id="cb28-46" data-line-number="46">      ]</a>
<a class="sourceLine" id="cb28-47" data-line-number="47">    ]</a></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb29-1" data-line-number="1">prop_Buffer_splitBufferAtLineCol_focus</a>
<a class="sourceLine" id="cb29-2" data-line-number="2"><span class="ot">  ::</span> forall w t a</a>
<a class="sourceLine" id="cb29-3" data-line-number="3">   <span class="fu">.</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb29-4" data-line-number="4">     , <span class="dt">Arbitrary</span> a, <span class="dt">Show</span> a, <span class="dt">Eq</span> a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb29-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a</a>
<a class="sourceLine" id="cb29-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">Buffer</span> w t a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Buffer</span> w t a</a>
<a class="sourceLine" id="cb29-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb29-8" data-line-number="8"></a>
<a class="sourceLine" id="cb29-9" data-line-number="9">prop_Buffer_splitBufferAtLineCol_focus _ _ _ as x bs <span class="fu">=</span></a>
<a class="sourceLine" id="cb29-10" data-line-number="10">  <span class="kw">let</span></a>
<a class="sourceLine" id="cb29-11" data-line-number="11">    m <span class="fu">=</span> value as <span class="fu">&lt;&gt;</span> value<span class="ot"> x ::</span> <span class="dt">MeasureText</span> w t</a>
<a class="sourceLine" id="cb29-12" data-line-number="12">    z <span class="fu">=</span> mkBufferFocus&#39; as x bs</a>
<a class="sourceLine" id="cb29-13" data-line-number="13">  <span class="kw">in</span></a>
<a class="sourceLine" id="cb29-14" data-line-number="14">    z <span class="fu">===</span> (splitBufferAtLineCol (logicalCoords m) z)</a>
<a class="sourceLine" id="cb29-15" data-line-number="15"></a>
<a class="sourceLine" id="cb29-16" data-line-number="16">test_Buffer_splitBufferAtLineCol_focus</a>
<a class="sourceLine" id="cb29-17" data-line-number="17"><span class="ot">  ::</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb29-18" data-line-number="18">     , <span class="dt">Arbitrary</span> a, <span class="dt">Show</span> a, <span class="dt">Eq</span> a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb29-19" data-line-number="19">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb29-20" data-line-number="20">test_Buffer_splitBufferAtLineCol_focus pw pt pa <span class="fu">=</span></a>
<a class="sourceLine" id="cb29-21" data-line-number="21">  testProperty <span class="st">&quot;splitBufferAtLineCol (prepared focus)&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb29-22" data-line-number="22">    prop_Buffer_splitBufferAtLineCol_focus pw pt pa</a></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb30-1" data-line-number="1">prop_Buffer_splitBufferAtScreenCoords_focus</a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="ot">  ::</span> forall w t a</a>
<a class="sourceLine" id="cb30-3" data-line-number="3">   <span class="fu">.</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb30-4" data-line-number="4">     , <span class="dt">Arbitrary</span> a, <span class="dt">Show</span> a, <span class="dt">Eq</span> a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb30-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a</a>
<a class="sourceLine" id="cb30-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">Buffer</span> w t a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Buffer</span> w t a</a>
<a class="sourceLine" id="cb30-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb30-8" data-line-number="8"></a>
<a class="sourceLine" id="cb30-9" data-line-number="9">prop_Buffer_splitBufferAtScreenCoords_focus _ _ _ as x bs <span class="fu">=</span></a>
<a class="sourceLine" id="cb30-10" data-line-number="10">  <span class="kw">let</span></a>
<a class="sourceLine" id="cb30-11" data-line-number="11">    m <span class="fu">=</span> value<span class="ot"> as ::</span> <span class="dt">MeasureText</span> w t</a>
<a class="sourceLine" id="cb30-12" data-line-number="12">    pos <span class="fu">=</span> applyScreenOffset (screenOffset m) (<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb30-13" data-line-number="13">    z1 <span class="fu">=</span> mkBufferFocus&#39; as x bs</a>
<a class="sourceLine" id="cb30-14" data-line-number="14">    z2 <span class="fu">=</span> splitBufferAtScreenCoords pos z1</a>
<a class="sourceLine" id="cb30-15" data-line-number="15">  <span class="kw">in</span></a>
<a class="sourceLine" id="cb30-16" data-line-number="16">    <span class="kw">if</span> validateBuffer z2</a>
<a class="sourceLine" id="cb30-17" data-line-number="17">      <span class="kw">then</span> z1 <span class="fu">===</span> z2</a>
<a class="sourceLine" id="cb30-18" data-line-number="18">      <span class="kw">else</span> error <span class="st">&quot;z2 does not validate!&quot;</span></a>
<a class="sourceLine" id="cb30-19" data-line-number="19"></a>
<a class="sourceLine" id="cb30-20" data-line-number="20">test_Buffer_splitBufferAtScreenCoords_focus</a>
<a class="sourceLine" id="cb30-21" data-line-number="21"><span class="ot">  ::</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb30-22" data-line-number="22">     , <span class="dt">Arbitrary</span> a, <span class="dt">Show</span> a, <span class="dt">Eq</span> a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb30-23" data-line-number="23">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb30-24" data-line-number="24">test_Buffer_splitBufferAtScreenCoords_focus pw pt pa <span class="fu">=</span></a>
<a class="sourceLine" id="cb30-25" data-line-number="25">  testProperty <span class="st">&quot;splitBufferAtScreenCoords (prepared focus)&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb30-26" data-line-number="26">    prop_Buffer_splitBufferAtScreenCoords_focus pw pt pa</a></code></pre></div>
<h2 id="examples">Examples</h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb31-1" data-line-number="1">prop_Buffer_validateBuffer_examples</a>
<a class="sourceLine" id="cb31-2" data-line-number="2"><span class="ot">  ::</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t )</a>
<a class="sourceLine" id="cb31-3" data-line-number="3">  <span class="ot">=&gt;</span> <span class="dt">Buffer</span> w t <span class="dt">Char</span></a>
<a class="sourceLine" id="cb31-4" data-line-number="4">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb31-5" data-line-number="5"></a>
<a class="sourceLine" id="cb31-6" data-line-number="6">prop_Buffer_validateBuffer_examples x <span class="fu">=</span></a>
<a class="sourceLine" id="cb31-7" data-line-number="7">  property <span class="fu">$</span> validateBuffer x</a>
<a class="sourceLine" id="cb31-8" data-line-number="8"></a>
<a class="sourceLine" id="cb31-9" data-line-number="9"><span class="ot">test_Buffer_validateBuffer_examples ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb31-10" data-line-number="10">test_Buffer_validateBuffer_examples <span class="fu">=</span></a>
<a class="sourceLine" id="cb31-11" data-line-number="11">  testGroup <span class="st">&quot;Validate&quot;</span></a>
<a class="sourceLine" id="cb31-12" data-line-number="12">    [ testProperty <span class="st">&quot;#1&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb31-13" data-line-number="13">        prop_Buffer_validateBuffer_examples <span class="fu">$</span></a>
<a class="sourceLine" id="cb31-14" data-line-number="14">          defBufferFocus nat3 nat1</a>
<a class="sourceLine" id="cb31-15" data-line-number="15">            <span class="st">&quot;&quot;</span> <span class="ch">&#39;a&#39;</span> <span class="st">&quot;aaaaaaaaaaaaaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb31-16" data-line-number="16"></a>
<a class="sourceLine" id="cb31-17" data-line-number="17">    , testProperty <span class="st">&quot;#2&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb31-18" data-line-number="18">        prop_Buffer_validateBuffer_examples <span class="fu">$</span></a>
<a class="sourceLine" id="cb31-19" data-line-number="19">          defBufferFocus nat3 nat1</a>
<a class="sourceLine" id="cb31-20" data-line-number="20">            <span class="st">&quot;a&quot;</span> <span class="ch">&#39;a&#39;</span> <span class="st">&quot;aaaaaaaaaaaaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb31-21" data-line-number="21"></a>
<a class="sourceLine" id="cb31-22" data-line-number="22">    , testProperty <span class="st">&quot;#3&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb31-23" data-line-number="23">        prop_Buffer_validateBuffer_examples <span class="fu">$</span></a>
<a class="sourceLine" id="cb31-24" data-line-number="24">          defBufferFocus nat3 nat1</a>
<a class="sourceLine" id="cb31-25" data-line-number="25">            <span class="st">&quot;aa&quot;</span> <span class="ch">&#39;a&#39;</span> <span class="st">&quot;aaaaaaaaaaaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb31-26" data-line-number="26"></a>
<a class="sourceLine" id="cb31-27" data-line-number="27">    , testProperty <span class="st">&quot;#4&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb31-28" data-line-number="28">        prop_Buffer_validateBuffer_examples <span class="fu">$</span></a>
<a class="sourceLine" id="cb31-29" data-line-number="29">          defBufferFocus nat3 nat1</a>
<a class="sourceLine" id="cb31-30" data-line-number="30">            <span class="st">&quot;aaa&quot;</span> <span class="ch">&#39;a&#39;</span> <span class="st">&quot;aaaaaaaaaaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb31-31" data-line-number="31"></a>
<a class="sourceLine" id="cb31-32" data-line-number="32">    , testProperty <span class="st">&quot;#5&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb31-33" data-line-number="33">        prop_Buffer_validateBuffer_examples <span class="fu">$</span></a>
<a class="sourceLine" id="cb31-34" data-line-number="34">          defBufferFocus nat3 nat1</a>
<a class="sourceLine" id="cb31-35" data-line-number="35">            <span class="st">&quot;aaaa&quot;</span> <span class="ch">&#39;a&#39;</span> <span class="st">&quot;aaaaaaaaaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb31-36" data-line-number="36"></a>
<a class="sourceLine" id="cb31-37" data-line-number="37">    , testProperty <span class="st">&quot;#6&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb31-38" data-line-number="38">        prop_Buffer_validateBuffer_examples <span class="fu">$</span></a>
<a class="sourceLine" id="cb31-39" data-line-number="39">          defBufferFocus nat3 nat1</a>
<a class="sourceLine" id="cb31-40" data-line-number="40">            <span class="st">&quot;aaaaa&quot;</span> <span class="ch">&#39;a&#39;</span> <span class="st">&quot;aaaaaaaaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb31-41" data-line-number="41"></a>
<a class="sourceLine" id="cb31-42" data-line-number="42">    , testProperty <span class="st">&quot;#7&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb31-43" data-line-number="43">        prop_Buffer_validateBuffer_examples <span class="fu">$</span></a>
<a class="sourceLine" id="cb31-44" data-line-number="44">          defBufferFocus nat3 nat1</a>
<a class="sourceLine" id="cb31-45" data-line-number="45">            <span class="st">&quot;aaaaaa&quot;</span> <span class="ch">&#39;a&#39;</span> <span class="st">&quot;aaaaaaaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb31-46" data-line-number="46"></a>
<a class="sourceLine" id="cb31-47" data-line-number="47">    , testProperty <span class="st">&quot;#8&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb31-48" data-line-number="48">        prop_Buffer_validateBuffer_examples <span class="fu">$</span></a>
<a class="sourceLine" id="cb31-49" data-line-number="49">          defBufferFocus nat3 nat1</a>
<a class="sourceLine" id="cb31-50" data-line-number="50">            <span class="st">&quot;aaaaaaa&quot;</span> <span class="ch">&#39;a&#39;</span> <span class="st">&quot;aaaaaaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb31-51" data-line-number="51">    ]</a></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb32-1" data-line-number="1">prop_Buffer_splitAtScreenCoords_examples</a>
<a class="sourceLine" id="cb32-2" data-line-number="2"><span class="ot">  ::</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t )</a>
<a class="sourceLine" id="cb32-3" data-line-number="3">  <span class="ot">=&gt;</span> ((<span class="dt">Int</span>, <span class="dt">Int</span>), <span class="dt">Buffer</span> w t <span class="dt">Char</span>, <span class="dt">Buffer</span> w t <span class="dt">Char</span>)</a>
<a class="sourceLine" id="cb32-4" data-line-number="4">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb32-5" data-line-number="5">prop_Buffer_splitAtScreenCoords_examples (pos, buf1, buf2) <span class="fu">=</span></a>
<a class="sourceLine" id="cb32-6" data-line-number="6">  buf2 <span class="fu">===</span> splitBufferAtScreenCoords pos buf1</a>
<a class="sourceLine" id="cb32-7" data-line-number="7"></a>
<a class="sourceLine" id="cb32-8" data-line-number="8"><span class="ot">test_Buffer_splitAtScreenCoords_examples ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb32-9" data-line-number="9">test_Buffer_splitAtScreenCoords_examples <span class="fu">=</span></a>
<a class="sourceLine" id="cb32-10" data-line-number="10">  testGroup <span class="st">&quot;splitAtScreenCoords examples&quot;</span></a>
<a class="sourceLine" id="cb32-11" data-line-number="11">    [ testProperty <span class="st">&quot;#1&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb32-12" data-line-number="12">        prop_Buffer_splitAtScreenCoords_examples</a>
<a class="sourceLine" id="cb32-13" data-line-number="13">          ( (<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb32-14" data-line-number="14">          , defBuffer nat3 nat1 <span class="st">&quot;aaaaaaaaaaaaaaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb32-15" data-line-number="15">          , defBufferFocus nat3 nat1</a>
<a class="sourceLine" id="cb32-16" data-line-number="16">              <span class="st">&quot;&quot;</span> <span class="ch">&#39;a&#39;</span> <span class="st">&quot;aaaaaaaaaaaaaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb32-17" data-line-number="17">          )</a>
<a class="sourceLine" id="cb32-18" data-line-number="18"></a>
<a class="sourceLine" id="cb32-19" data-line-number="19">    , testProperty <span class="st">&quot;#2&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb32-20" data-line-number="20">        prop_Buffer_splitAtScreenCoords_examples</a>
<a class="sourceLine" id="cb32-21" data-line-number="21">          ( (<span class="dv">1</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb32-22" data-line-number="22">          , defBuffer nat3 nat1 <span class="st">&quot;aaaaaaaaaaaaaaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb32-23" data-line-number="23">          , defBufferFocus nat3 nat1</a>
<a class="sourceLine" id="cb32-24" data-line-number="24">              <span class="st">&quot;a&quot;</span> <span class="ch">&#39;a&#39;</span> <span class="st">&quot;aaaaaaaaaaaaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb32-25" data-line-number="25">          )</a>
<a class="sourceLine" id="cb32-26" data-line-number="26"></a>
<a class="sourceLine" id="cb32-27" data-line-number="27">    , testProperty <span class="st">&quot;#3&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb32-28" data-line-number="28">        prop_Buffer_splitAtScreenCoords_examples</a>
<a class="sourceLine" id="cb32-29" data-line-number="29">          ( (<span class="dv">2</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb32-30" data-line-number="30">          , defBuffer nat3 nat1 <span class="st">&quot;aaaaaaaaaaaaaaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb32-31" data-line-number="31">          , defBufferFocus nat3 nat1</a>
<a class="sourceLine" id="cb32-32" data-line-number="32">              <span class="st">&quot;aa&quot;</span> <span class="ch">&#39;a&#39;</span> <span class="st">&quot;aaaaaaaaaaaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb32-33" data-line-number="33">          )</a>
<a class="sourceLine" id="cb32-34" data-line-number="34"></a>
<a class="sourceLine" id="cb32-35" data-line-number="35">    , testProperty <span class="st">&quot;#4&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb32-36" data-line-number="36">        prop_Buffer_splitAtScreenCoords_examples</a>
<a class="sourceLine" id="cb32-37" data-line-number="37">          ( (<span class="dv">3</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb32-38" data-line-number="38">          , defBuffer nat3 nat1 <span class="st">&quot;aaaaaaaaaaaaaaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb32-39" data-line-number="39">          , defBufferFocus nat3 nat1</a>
<a class="sourceLine" id="cb32-40" data-line-number="40">              <span class="st">&quot;aa&quot;</span> <span class="ch">&#39;a&#39;</span> <span class="st">&quot;aaaaaaaaaaaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb32-41" data-line-number="41">          )</a>
<a class="sourceLine" id="cb32-42" data-line-number="42"></a>
<a class="sourceLine" id="cb32-43" data-line-number="43">    , testProperty <span class="st">&quot;#5&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb32-44" data-line-number="44">        prop_Buffer_splitAtScreenCoords_examples</a>
<a class="sourceLine" id="cb32-45" data-line-number="45">          ( (<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb32-46" data-line-number="46">          , defBuffer nat3 nat1 <span class="st">&quot;aaaaaaaaaaaaaaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb32-47" data-line-number="47">          , defBufferFocus nat3 nat1</a>
<a class="sourceLine" id="cb32-48" data-line-number="48">              <span class="st">&quot;aaa&quot;</span> <span class="ch">&#39;a&#39;</span> <span class="st">&quot;aaaaaaaaaaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb32-49" data-line-number="49">          )</a>
<a class="sourceLine" id="cb32-50" data-line-number="50"></a>
<a class="sourceLine" id="cb32-51" data-line-number="51">    , testProperty <span class="st">&quot;#6&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb32-52" data-line-number="52">        prop_Buffer_splitAtScreenCoords_examples</a>
<a class="sourceLine" id="cb32-53" data-line-number="53">          ( (<span class="dv">1</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb32-54" data-line-number="54">          , defBuffer nat3 nat1 <span class="st">&quot;aaaaaaaaaaaaaaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb32-55" data-line-number="55">          , defBufferFocus nat3 nat1</a>
<a class="sourceLine" id="cb32-56" data-line-number="56">              <span class="st">&quot;aaaa&quot;</span> <span class="ch">&#39;a&#39;</span> <span class="st">&quot;aaaaaaaaaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb32-57" data-line-number="57">          )</a>
<a class="sourceLine" id="cb32-58" data-line-number="58"></a>
<a class="sourceLine" id="cb32-59" data-line-number="59">    , testProperty <span class="st">&quot;#7&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb32-60" data-line-number="60">        prop_Buffer_splitAtScreenCoords_examples</a>
<a class="sourceLine" id="cb32-61" data-line-number="61">          ( (<span class="dv">2</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb32-62" data-line-number="62">          , defBuffer nat3 nat1 <span class="st">&quot;aaaaaaaaaaaaaaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb32-63" data-line-number="63">          , defBufferFocus nat3 nat1</a>
<a class="sourceLine" id="cb32-64" data-line-number="64">              <span class="st">&quot;aaaaa&quot;</span> <span class="ch">&#39;a&#39;</span> <span class="st">&quot;aaaaaaaaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb32-65" data-line-number="65">          )</a>
<a class="sourceLine" id="cb32-66" data-line-number="66"></a>
<a class="sourceLine" id="cb32-67" data-line-number="67">    , testProperty <span class="st">&quot;#8&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb32-68" data-line-number="68">        prop_Buffer_splitAtScreenCoords_examples</a>
<a class="sourceLine" id="cb32-69" data-line-number="69">          ( (<span class="dv">0</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb32-70" data-line-number="70">          , defBuffer nat3 nat1 <span class="st">&quot;aaaaaaaaaaaaaaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb32-71" data-line-number="71">          , defBufferFocus nat3 nat1</a>
<a class="sourceLine" id="cb32-72" data-line-number="72">              <span class="st">&quot;aaaaaa&quot;</span> <span class="ch">&#39;a&#39;</span> <span class="st">&quot;aaaaaaaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb32-73" data-line-number="73">          )</a>
<a class="sourceLine" id="cb32-74" data-line-number="74">    ]</a></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb33-1" data-line-number="1">prop_Buffer_screenCoords_value_examples</a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="ot">  ::</span> forall w t</a>
<a class="sourceLine" id="cb33-3" data-line-number="3">   <span class="fu">.</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t )</a>
<a class="sourceLine" id="cb33-4" data-line-number="4">  <span class="ot">=&gt;</span> (<span class="dt">Buffer</span> w t <span class="dt">Char</span>, (<span class="dt">Int</span>, <span class="dt">Int</span>))</a>
<a class="sourceLine" id="cb33-5" data-line-number="5">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb33-6" data-line-number="6">prop_Buffer_screenCoords_value_examples (buf1, pos) <span class="fu">=</span></a>
<a class="sourceLine" id="cb33-7" data-line-number="7">  <span class="kw">let</span> offset <span class="fu">=</span> screenOffset (value<span class="ot"> buf1 ::</span> <span class="dt">MeasureText</span> w t)</a>
<a class="sourceLine" id="cb33-8" data-line-number="8">  <span class="kw">in</span> pos <span class="fu">===</span> (applyScreenOffset offset (<span class="dv">0</span>,<span class="dv">0</span>))</a>
<a class="sourceLine" id="cb33-9" data-line-number="9"></a>
<a class="sourceLine" id="cb33-10" data-line-number="10"><span class="ot">test_Buffer_screenCoords_value_examples ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb33-11" data-line-number="11">test_Buffer_screenCoords_value_examples <span class="fu">=</span></a>
<a class="sourceLine" id="cb33-12" data-line-number="12">  testGroup <span class="st">&quot;Buffer value examples&quot;</span></a>
<a class="sourceLine" id="cb33-13" data-line-number="13">    [ testProperty <span class="st">&quot;#1&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb33-14" data-line-number="14">        prop_Buffer_screenCoords_value_examples</a>
<a class="sourceLine" id="cb33-15" data-line-number="15">          ( defBuffer nat3 nat1 <span class="st">&quot;a&quot;</span></a>
<a class="sourceLine" id="cb33-16" data-line-number="16">          , (<span class="dv">1</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb33-17" data-line-number="17">          )</a>
<a class="sourceLine" id="cb33-18" data-line-number="18"></a>
<a class="sourceLine" id="cb33-19" data-line-number="19">    , testProperty <span class="st">&quot;#2&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb33-20" data-line-number="20">        prop_Buffer_screenCoords_value_examples</a>
<a class="sourceLine" id="cb33-21" data-line-number="21">          ( defBuffer nat3 nat1 <span class="st">&quot;aa&quot;</span></a>
<a class="sourceLine" id="cb33-22" data-line-number="22">          , (<span class="dv">2</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb33-23" data-line-number="23">          )</a>
<a class="sourceLine" id="cb33-24" data-line-number="24"></a>
<a class="sourceLine" id="cb33-25" data-line-number="25">    , testProperty <span class="st">&quot;#3&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb33-26" data-line-number="26">        prop_Buffer_screenCoords_value_examples</a>
<a class="sourceLine" id="cb33-27" data-line-number="27">          ( defBuffer nat3 nat1 <span class="st">&quot;aaa&quot;</span></a>
<a class="sourceLine" id="cb33-28" data-line-number="28">          , (<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb33-29" data-line-number="29">          )</a>
<a class="sourceLine" id="cb33-30" data-line-number="30"></a>
<a class="sourceLine" id="cb33-31" data-line-number="31">    , testProperty <span class="st">&quot;#4&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb33-32" data-line-number="32">        prop_Buffer_screenCoords_value_examples</a>
<a class="sourceLine" id="cb33-33" data-line-number="33">          ( defBuffer nat3 nat1 <span class="st">&quot;aaaa&quot;</span></a>
<a class="sourceLine" id="cb33-34" data-line-number="34">          , (<span class="dv">1</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb33-35" data-line-number="35">          )</a>
<a class="sourceLine" id="cb33-36" data-line-number="36"></a>
<a class="sourceLine" id="cb33-37" data-line-number="37">    , testProperty <span class="st">&quot;#5&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb33-38" data-line-number="38">        prop_Buffer_screenCoords_value_examples</a>
<a class="sourceLine" id="cb33-39" data-line-number="39">          ( defBuffer nat3 nat1 <span class="st">&quot;aaaaa&quot;</span></a>
<a class="sourceLine" id="cb33-40" data-line-number="40">          , (<span class="dv">2</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb33-41" data-line-number="41">          )</a>
<a class="sourceLine" id="cb33-42" data-line-number="42"></a>
<a class="sourceLine" id="cb33-43" data-line-number="43">    , testProperty <span class="st">&quot;#6&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb33-44" data-line-number="44">        prop_Buffer_screenCoords_value_examples</a>
<a class="sourceLine" id="cb33-45" data-line-number="45">          ( defBuffer nat3 nat1 <span class="st">&quot;aaaaaa&quot;</span></a>
<a class="sourceLine" id="cb33-46" data-line-number="46">          , (<span class="dv">0</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb33-47" data-line-number="47">          )</a>
<a class="sourceLine" id="cb33-48" data-line-number="48"></a>
<a class="sourceLine" id="cb33-49" data-line-number="49">    , testProperty <span class="st">&quot;#7&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb33-50" data-line-number="50">        prop_Buffer_screenCoords_value_examples</a>
<a class="sourceLine" id="cb33-51" data-line-number="51">          ( defBuffer nat3 nat1 <span class="st">&quot;aaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb33-52" data-line-number="52">          , (<span class="dv">1</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb33-53" data-line-number="53">          )</a>
<a class="sourceLine" id="cb33-54" data-line-number="54"></a>
<a class="sourceLine" id="cb33-55" data-line-number="55">    , testProperty <span class="st">&quot;#8&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb33-56" data-line-number="56">        prop_Buffer_screenCoords_value_examples</a>
<a class="sourceLine" id="cb33-57" data-line-number="57">          ( defBuffer nat3 nat1 <span class="st">&quot;aaaaaaaa&quot;</span></a>
<a class="sourceLine" id="cb33-58" data-line-number="58">          , (<span class="dv">2</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb33-59" data-line-number="59">          )</a>
<a class="sourceLine" id="cb33-60" data-line-number="60">    ]</a></code></pre></div>
<h2 id="rendering">Rendering</h2>
<div class="sourceCode" id="cb34"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb34-1" data-line-number="1">test_Buffer_renderBuffer</a>
<a class="sourceLine" id="cb34-2" data-line-number="2"><span class="ot">  ::</span> forall w t a</a>
<a class="sourceLine" id="cb34-3" data-line-number="3">   <span class="fu">.</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb34-4" data-line-number="4">     , <span class="dt">Arbitrary</span> a, <span class="dt">Eq</span> a, <span class="dt">Show</span> a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb34-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a</a>
<a class="sourceLine" id="cb34-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb34-7" data-line-number="7">test_Buffer_renderBuffer pw pt pa <span class="fu">=</span></a>
<a class="sourceLine" id="cb34-8" data-line-number="8">  testGroup <span class="st">&quot;Rendering&quot;</span></a>
<a class="sourceLine" id="cb34-9" data-line-number="9">    [ testProperty <span class="st">&quot;Prepared 0&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb34-10" data-line-number="10">        prop_Buffer_renderBuffer_prepared_0 pw pt pa</a>
<a class="sourceLine" id="cb34-11" data-line-number="11">    , testProperty <span class="st">&quot;Prepared 1&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb34-12" data-line-number="12">        prop_Buffer_renderBuffer_prepared_1 pw pt pa</a>
<a class="sourceLine" id="cb34-13" data-line-number="13">    , testProperty <span class="st">&quot;Prepared 2&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb34-14" data-line-number="14">        prop_Buffer_renderBuffer_prepared_2 pw pt pa</a>
<a class="sourceLine" id="cb34-15" data-line-number="15">    ]</a></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb35-1" data-line-number="1">prop_Buffer_renderBuffer_prepared_0</a>
<a class="sourceLine" id="cb35-2" data-line-number="2">   , prop_Buffer_renderBuffer_prepared_1</a>
<a class="sourceLine" id="cb35-3" data-line-number="3">   , prop_Buffer_renderBuffer_prepared_2</a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="ot">  ::</span> forall w t a</a>
<a class="sourceLine" id="cb35-5" data-line-number="5">   <span class="fu">.</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb35-6" data-line-number="6">     , <span class="dt">Arbitrary</span> a, <span class="dt">Eq</span> a, <span class="dt">Show</span> a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb35-7" data-line-number="7">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a</a>
<a class="sourceLine" id="cb35-8" data-line-number="8">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb35-9" data-line-number="9"></a>
<a class="sourceLine" id="cb35-10" data-line-number="10">prop_Buffer_renderBuffer_prepared_0 pw pt pa <span class="fu">=</span></a>
<a class="sourceLine" id="cb35-11" data-line-number="11">  forAll (genRenderBuffer pw pt pa (<span class="dt">NonNegative</span> <span class="dv">0</span>)) <span class="fu">$</span></a>
<a class="sourceLine" id="cb35-12" data-line-number="12">    \(top, height, buf, labels, lines) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb35-13" data-line-number="13">      (labels, lines)</a>
<a class="sourceLine" id="cb35-14" data-line-number="14">        <span class="fu">===</span> renderBuffer defaultBufferRenderSettings top height buf</a>
<a class="sourceLine" id="cb35-15" data-line-number="15"></a>
<a class="sourceLine" id="cb35-16" data-line-number="16">prop_Buffer_renderBuffer_prepared_1 pw pt pa <span class="fu">=</span></a>
<a class="sourceLine" id="cb35-17" data-line-number="17">  forAll (genRenderBuffer pw pt pa (<span class="dt">NonNegative</span> <span class="dv">1</span>)) <span class="fu">$</span></a>
<a class="sourceLine" id="cb35-18" data-line-number="18">    \(top, height, buf, labels, lines) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb35-19" data-line-number="19">      (labels, lines)</a>
<a class="sourceLine" id="cb35-20" data-line-number="20">        <span class="fu">===</span> renderBuffer defaultBufferRenderSettings top height buf</a>
<a class="sourceLine" id="cb35-21" data-line-number="21"></a>
<a class="sourceLine" id="cb35-22" data-line-number="22">prop_Buffer_renderBuffer_prepared_2 pw pt pa <span class="fu">=</span></a>
<a class="sourceLine" id="cb35-23" data-line-number="23">  forAll (genRenderBuffer pw pt pa (<span class="dt">NonNegative</span> <span class="dv">2</span>)) <span class="fu">$</span></a>
<a class="sourceLine" id="cb35-24" data-line-number="24">    \(top, height, buf, labels, lines) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb35-25" data-line-number="25">      (labels, lines)</a>
<a class="sourceLine" id="cb35-26" data-line-number="26">        <span class="fu">===</span> renderBuffer defaultBufferRenderSettings top height buf</a></code></pre></div>
<h2 id="test-suite">Test Suite</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="ot">test_Buffer ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb36-2" data-line-number="2">test_Buffer <span class="fu">=</span></a>
<a class="sourceLine" id="cb36-3" data-line-number="3">  testGroup <span class="st">&quot;Buffer properties&quot;</span></a>
<a class="sourceLine" id="cb36-4" data-line-number="4">    [ testGroup <span class="st">&quot;Tape&quot;</span></a>
<a class="sourceLine" id="cb36-5" data-line-number="5">      [ test_Tape pChar (pBuffer nat30 nat8)</a>
<a class="sourceLine" id="cb36-6" data-line-number="6">      , test_Tape pChar (pBuffer nat30 nat4)</a>
<a class="sourceLine" id="cb36-7" data-line-number="7">      , test_Tape pChar (pBuffer nat15 nat2)</a>
<a class="sourceLine" id="cb36-8" data-line-number="8">      , test_Tape pChar (pBuffer nat8 nat2)</a>
<a class="sourceLine" id="cb36-9" data-line-number="9"></a>
<a class="sourceLine" id="cb36-10" data-line-number="10">      , test_Tape pGlyph (pBuffer nat30 nat8)</a>
<a class="sourceLine" id="cb36-11" data-line-number="11">      , test_Tape pGlyph (pBuffer nat30 nat4)</a>
<a class="sourceLine" id="cb36-12" data-line-number="12">      , test_Tape pGlyph (pBuffer nat15 nat2)</a>
<a class="sourceLine" id="cb36-13" data-line-number="13">      , test_Tape pGlyph (pBuffer nat8 nat2)</a>
<a class="sourceLine" id="cb36-14" data-line-number="14">      ]</a>
<a class="sourceLine" id="cb36-15" data-line-number="15"></a>
<a class="sourceLine" id="cb36-16" data-line-number="16">    , testGroup <span class="st">&quot;Buffer&quot;</span></a>
<a class="sourceLine" id="cb36-17" data-line-number="17">      [ test_Buffer_properties nat30 nat8 pChar</a>
<a class="sourceLine" id="cb36-18" data-line-number="18">      , test_Buffer_properties nat23 nat4 pChar</a>
<a class="sourceLine" id="cb36-19" data-line-number="19">      , test_Buffer_properties nat18 nat3 pChar</a>
<a class="sourceLine" id="cb36-20" data-line-number="20">      , test_Buffer_properties nat15 nat4 pChar</a>
<a class="sourceLine" id="cb36-21" data-line-number="21">      , test_Buffer_properties nat8 nat2 pChar</a>
<a class="sourceLine" id="cb36-22" data-line-number="22"></a>
<a class="sourceLine" id="cb36-23" data-line-number="23">      , test_Buffer_properties nat30 nat8 pGlyph</a>
<a class="sourceLine" id="cb36-24" data-line-number="24">      , test_Buffer_properties nat23 nat4 pGlyph</a>
<a class="sourceLine" id="cb36-25" data-line-number="25">      , test_Buffer_properties nat18 nat3 pGlyph</a>
<a class="sourceLine" id="cb36-26" data-line-number="26">      , test_Buffer_properties nat15 nat4 pGlyph</a>
<a class="sourceLine" id="cb36-27" data-line-number="27">      , test_Buffer_properties nat8 nat2 pGlyph</a>
<a class="sourceLine" id="cb36-28" data-line-number="28"></a>
<a class="sourceLine" id="cb36-29" data-line-number="29">      , test_Buffer_validateBuffer_examples</a>
<a class="sourceLine" id="cb36-30" data-line-number="30">      , test_Buffer_splitAtScreenCoords_examples</a>
<a class="sourceLine" id="cb36-31" data-line-number="31">      , test_Buffer_screenCoords_value_examples</a>
<a class="sourceLine" id="cb36-32" data-line-number="32">      ]</a>
<a class="sourceLine" id="cb36-33" data-line-number="33">    ]</a></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="ot">pGlyph ::</span> <span class="dt">Proxy</span> <span class="dt">Glyph</span></a>
<a class="sourceLine" id="cb37-2" data-line-number="2">pGlyph <span class="fu">=</span> <span class="dt">Proxy</span></a></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="ot">pBuffer ::</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> (<span class="dt">Buffer</span> w t)</a>
<a class="sourceLine" id="cb38-2" data-line-number="2">pBuffer _ _ <span class="fu">=</span> <span class="dt">Proxy</span></a></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb39-1" data-line-number="1">genBufferFixed1</a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="ot">  ::</span> forall w t a</a>
<a class="sourceLine" id="cb39-3" data-line-number="3">   <span class="fu">.</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb39-4" data-line-number="4">     , <span class="dt">Arbitrary</span> a, <span class="dt">Eq</span> a, <span class="dt">Show</span> a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb39-5" data-line-number="5">  <span class="ot">=&gt;</span> [<span class="dt">Positive</span> <span class="dt">Int</span>]</a>
<a class="sourceLine" id="cb39-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">Gen</span> ([<span class="dt">Maybe</span> <span class="dt">Int</span>], [[a]], <span class="dt">Buffer</span> w t a)</a>
<a class="sourceLine" id="cb39-7" data-line-number="7">genBufferFixed1 ks <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb39-8" data-line-number="8">  <span class="kw">let</span></a>
<a class="sourceLine" id="cb39-9" data-line-number="9">    w <span class="fu">=</span> toWidth (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> w)</a></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb40-1" data-line-number="1">    ln</a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="ot">      ::</span> (<span class="dt">Int</span>, <span class="dt">Positive</span> <span class="dt">Int</span>)</a>
<a class="sourceLine" id="cb40-3" data-line-number="3">      <span class="ot">-&gt;</span> <span class="dt">Gen</span> ([<span class="dt">Maybe</span> <span class="dt">Int</span>], [[a]], [a])</a>
<a class="sourceLine" id="cb40-4" data-line-number="4">    ln (i, <span class="dt">Positive</span> k) <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb40-5" data-line-number="5">      as <span class="ot">&lt;-</span> map fromChar</a>
<a class="sourceLine" id="cb40-6" data-line-number="6">        <span class="fu">&lt;$&gt;</span> vectorOf k (choose (<span class="ch">&#39;a&#39;</span>,<span class="ch">&#39;z&#39;</span>))</a>
<a class="sourceLine" id="cb40-7" data-line-number="7">      <span class="kw">let</span></a>
<a class="sourceLine" id="cb40-8" data-line-number="8">        (lbs, lns) <span class="fu">=</span> unzip <span class="fu">$</span> zip</a>
<a class="sourceLine" id="cb40-9" data-line-number="9">          (<span class="dt">Just</span> i <span class="fu">:</span> repeat <span class="dt">Nothing</span>)</a>
<a class="sourceLine" id="cb40-10" data-line-number="10">          (chunksOf w as)</a>
<a class="sourceLine" id="cb40-11" data-line-number="11">      return (lbs, lns, as)</a></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb41-1" data-line-number="1">  (labelss, liness, css) <span class="ot">&lt;-</span></a>
<a class="sourceLine" id="cb41-2" data-line-number="2">    unzip3 <span class="fu">&lt;$&gt;</span> (sequence <span class="fu">$</span> map ln <span class="fu">$</span> zip [<span class="dv">0</span><span class="fu">..</span>] ks)</a></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb42-1" data-line-number="1">  return</a>
<a class="sourceLine" id="cb42-2" data-line-number="2">    ( concat labelss</a>
<a class="sourceLine" id="cb42-3" data-line-number="3">    , concat liness</a>
<a class="sourceLine" id="cb42-4" data-line-number="4">    , mkBuffer <span class="fu">$</span> intercalate [fromChar <span class="ch">&#39;\n&#39;</span>] css</a>
<a class="sourceLine" id="cb42-5" data-line-number="5">    )</a></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb43-1" data-line-number="1">chunksOf</a>
<a class="sourceLine" id="cb43-2" data-line-number="2"><span class="ot">  ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> [a] <span class="ot">-&gt;</span> [[a]]</a>
<a class="sourceLine" id="cb43-3" data-line-number="3">chunksOf k <span class="fu">=</span> unfoldr f</a>
<a class="sourceLine" id="cb43-4" data-line-number="4">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb43-5" data-line-number="5"><span class="ot">    f ::</span> [a] <span class="ot">-&gt;</span> <span class="dt">Maybe</span> ([a], [a])</a>
<a class="sourceLine" id="cb43-6" data-line-number="6">    f [] <span class="fu">=</span> <span class="dt">Nothing</span></a>
<a class="sourceLine" id="cb43-7" data-line-number="7">    f xs <span class="fu">=</span> <span class="dt">Just</span> <span class="fu">$</span> splitAt k xs</a></code></pre></div>
<p>– Steps: – 1. Move the read head to the end – 2. Get the read head line and column – Expect: – 1. We’re at the final line and column</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb44-1" data-line-number="1">prop_bufferHeadLineCol_lastMove</a>
<a class="sourceLine" id="cb44-2" data-line-number="2"><span class="ot">  ::</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb44-3" data-line-number="3">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a</a>
<a class="sourceLine" id="cb44-4" data-line-number="4">  <span class="ot">-&gt;</span> <span class="dt">Buffer</span> w t a <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb44-5" data-line-number="5">prop_bufferHeadLineCol_lastMove _ _ _ xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb44-6" data-line-number="6">  <span class="kw">let</span> ys <span class="fu">=</span> lastMove xs <span class="kw">in</span></a>
<a class="sourceLine" id="cb44-7" data-line-number="7">  <span class="kw">case</span> headRead ys <span class="kw">of</span></a>
<a class="sourceLine" id="cb44-8" data-line-number="8">    <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="dt">True</span></a>
<a class="sourceLine" id="cb44-9" data-line-number="9">    <span class="dt">Just</span> c <span class="ot">-&gt;</span> <span class="kw">case</span> toChar c <span class="kw">of</span></a>
<a class="sourceLine" id="cb44-10" data-line-number="10">      <span class="ch">&#39;\n&#39;</span> <span class="ot">-&gt;</span> bufferLineCol xs <span class="fu">==</span> (bufferHeadLineCol ys <span class="fu">&lt;&gt;</span> <span class="dt">LineCol</span> <span class="dv">1</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb44-11" data-line-number="11">      _    <span class="ot">-&gt;</span> bufferLineCol xs <span class="fu">==</span> (bufferHeadLineCol ys <span class="fu">&lt;&gt;</span> <span class="dt">LineCol</span> <span class="dv">0</span> <span class="dv">1</span>)</a></code></pre></div>
<p>– Check that splitting a prepared buffer – splits as expected</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb45-1" data-line-number="1">prop_splitBufferAtLineCol_prepared1</a>
<a class="sourceLine" id="cb45-2" data-line-number="2"><span class="ot">  ::</span> forall w t a</a>
<a class="sourceLine" id="cb45-3" data-line-number="3">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Arbitrary</span> a, <span class="dt">Show</span> a, <span class="dt">IsChar</span> a</a>
<a class="sourceLine" id="cb45-4" data-line-number="4">     , <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a )</a>
<a class="sourceLine" id="cb45-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb45-6" data-line-number="6">prop_splitBufferAtLineCol_prepared1 _ _ _ <span class="fu">=</span></a>
<a class="sourceLine" id="cb45-7" data-line-number="7">  forAll genPrepared1 <span class="fu">$</span> \(<span class="ot">as ::</span> [a], offset,<span class="ot"> w ::</span> <span class="dt">Buffer</span> w t a) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb45-8" data-line-number="8">    w <span class="fu">==</span> splitBufferAtLineCol offset (mkTape as)</a></code></pre></div>
<p>– Generate a buffer with a given logical offset, then – append an arbitrary suffix to it.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb46-1" data-line-number="1">genPrepared1</a>
<a class="sourceLine" id="cb46-2" data-line-number="2"><span class="ot">  ::</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Arbitrary</span> a</a>
<a class="sourceLine" id="cb46-3" data-line-number="3">     , <span class="dt">IsChar</span> a, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a )</a>
<a class="sourceLine" id="cb46-4" data-line-number="4">  <span class="ot">=&gt;</span> <span class="dt">Gen</span> ([a], <span class="dt">LineCol</span>, <span class="dt">Buffer</span> w t a)</a>
<a class="sourceLine" id="cb46-5" data-line-number="5">genPrepared1 <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb46-6" data-line-number="6">  <span class="dt">NonNegative</span> l <span class="ot">&lt;-</span> fmap (<span class="ot">`rem`</span> <span class="dv">30</span>) <span class="fu">&lt;$&gt;</span> arbitrary</a>
<a class="sourceLine" id="cb46-7" data-line-number="7">  <span class="dt">NonNegative</span> c <span class="ot">&lt;-</span> fmap (<span class="ot">`rem`</span> <span class="dv">30</span>) <span class="fu">&lt;$&gt;</span> arbitrary</a></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb47-1" data-line-number="1">  <span class="kw">let</span></a>
<a class="sourceLine" id="cb47-2" data-line-number="2">    genChar <span class="fu">=</span> arbitrary <span class="ot">`suchThat`</span> (\c <span class="ot">-&gt;</span> c <span class="fu">/=</span> <span class="ch">&#39;\n&#39;</span>)</a>
<a class="sourceLine" id="cb47-3" data-line-number="3">    genLine <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb47-4" data-line-number="4">      <span class="dt">NonNegative</span> k <span class="ot">&lt;-</span> fmap (<span class="ot">`rem`</span> <span class="dv">50</span>) <span class="fu">&lt;$&gt;</span> arbitrary</a>
<a class="sourceLine" id="cb47-5" data-line-number="5">      vectorOf k genChar</a></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb48-1" data-line-number="1">  as <span class="ot">&lt;-</span> map fromChar <span class="fu">&lt;$&gt;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb48-2" data-line-number="2">    uss <span class="ot">&lt;-</span> vectorOf l genLine</a>
<a class="sourceLine" id="cb48-3" data-line-number="3">    us  <span class="ot">&lt;-</span> vectorOf c genChar</a>
<a class="sourceLine" id="cb48-4" data-line-number="4">    return <span class="fu">$</span> (unlines uss) <span class="fu">++</span> us</a></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb49-1" data-line-number="1">  x <span class="ot">&lt;-</span> fromChar <span class="fu">&lt;$&gt;</span> arbitrary</a>
<a class="sourceLine" id="cb49-2" data-line-number="2">  bs <span class="ot">&lt;-</span> map fromChar <span class="fu">&lt;$&gt;</span> arbitrary</a>
<a class="sourceLine" id="cb49-3" data-line-number="3">  return</a>
<a class="sourceLine" id="cb49-4" data-line-number="4">    ( as <span class="fu">++</span> [x] <span class="fu">++</span> bs</a>
<a class="sourceLine" id="cb49-5" data-line-number="5">    , <span class="dt">LineCol</span> l c</a>
<a class="sourceLine" id="cb49-6" data-line-number="6">    , mkBufferFocus as x bs</a>
<a class="sourceLine" id="cb49-7" data-line-number="7">    )</a></code></pre></div>
<p>– Rendering</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb50-1" data-line-number="1">prop_renderBuffer_one_line_no_wrap</a>
<a class="sourceLine" id="cb50-2" data-line-number="2"><span class="ot">  ::</span> forall w t a</a>
<a class="sourceLine" id="cb50-3" data-line-number="3">   <span class="fu">.</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb50-4" data-line-number="4">     , <span class="dt">Arbitrary</span> a, <span class="dt">Eq</span> a, <span class="dt">Show</span> a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb50-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a</a>
<a class="sourceLine" id="cb50-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">Positive</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb50-7" data-line-number="7">prop_renderBuffer_one_line_no_wrap _ _ _ (<span class="dt">Positive</span> h) <span class="fu">=</span></a>
<a class="sourceLine" id="cb50-8" data-line-number="8">  forAll genRenderNoWrapFixed1 <span class="fu">$</span></a>
<a class="sourceLine" id="cb50-9" data-line-number="9">    \(lb, as,<span class="ot"> buf ::</span> <span class="dt">Buffer</span> w t a) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb50-10" data-line-number="10">      (lb, as) <span class="fu">===</span> renderBuffer defaultBufferRenderSettings <span class="dv">0</span> h buf</a></code></pre></div>
<p>– Generate a buffer with a single nonempty, non-wrapping logical line – consisting only of width 1 characters.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb51-1" data-line-number="1">genRenderNoWrapFixed1</a>
<a class="sourceLine" id="cb51-2" data-line-number="2"><span class="ot">  ::</span> forall w t a</a>
<a class="sourceLine" id="cb51-3" data-line-number="3">   <span class="fu">.</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb51-4" data-line-number="4">     , <span class="dt">Arbitrary</span> a, <span class="dt">Eq</span> a, <span class="dt">Show</span> a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb51-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Gen</span> ([<span class="dt">Maybe</span> <span class="dt">Int</span>], [[a]], <span class="dt">Buffer</span> w t a)</a>
<a class="sourceLine" id="cb51-6" data-line-number="6">genRenderNoWrapFixed1 <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb51-7" data-line-number="7">  <span class="kw">let</span> w <span class="fu">=</span> toWidth (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> w)</a>
<a class="sourceLine" id="cb51-8" data-line-number="8">  len <span class="ot">&lt;-</span> choose (<span class="dv">1</span>,w)</a>
<a class="sourceLine" id="cb51-9" data-line-number="9">  genBufferFixed1 [<span class="dt">Positive</span> len]</a></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb52-1" data-line-number="1">prop_renderBuffer_one_line_wrap</a>
<a class="sourceLine" id="cb52-2" data-line-number="2"><span class="ot">  ::</span> forall w t a</a>
<a class="sourceLine" id="cb52-3" data-line-number="3">   <span class="fu">.</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb52-4" data-line-number="4">     , <span class="dt">Arbitrary</span> a, <span class="dt">Eq</span> a, <span class="dt">Show</span> a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb52-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a</a>
<a class="sourceLine" id="cb52-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">Positive</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb52-7" data-line-number="7">prop_renderBuffer_one_line_wrap _ _ _ (<span class="dt">Positive</span> h) <span class="fu">=</span></a>
<a class="sourceLine" id="cb52-8" data-line-number="8">  (h <span class="fu">&gt;</span> <span class="dv">1</span>) <span class="fu">==&gt;</span></a>
<a class="sourceLine" id="cb52-9" data-line-number="9">  forAll (genRenderWrapFixed1 (<span class="dt">Positive</span> h)) <span class="fu">$</span></a>
<a class="sourceLine" id="cb52-10" data-line-number="10">    \(lb, as,<span class="ot"> buf ::</span> <span class="dt">Buffer</span> w t a) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb52-11" data-line-number="11">      (lb, as) <span class="fu">===</span> renderBuffer defaultBufferRenderSettings <span class="dv">0</span> h buf</a></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb53-1" data-line-number="1">genRenderWrapFixed1</a>
<a class="sourceLine" id="cb53-2" data-line-number="2"><span class="ot">  ::</span> forall w t a</a>
<a class="sourceLine" id="cb53-3" data-line-number="3">   <span class="fu">.</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb53-4" data-line-number="4">     , <span class="dt">Arbitrary</span> a, <span class="dt">Eq</span> a, <span class="dt">Show</span> a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb53-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Positive</span> <span class="dt">Int</span></a>
<a class="sourceLine" id="cb53-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">Gen</span> ([<span class="dt">Maybe</span> <span class="dt">Int</span>], [[a]], <span class="dt">Buffer</span> w t a)</a>
<a class="sourceLine" id="cb53-7" data-line-number="7">genRenderWrapFixed1 (<span class="dt">Positive</span> h) <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb53-8" data-line-number="8">  <span class="kw">let</span> w <span class="fu">=</span> toWidth (<span class="dt">Proxy</span><span class="ot"> ::</span> <span class="dt">Proxy</span> w)</a>
<a class="sourceLine" id="cb53-9" data-line-number="9">  len <span class="ot">&lt;-</span> choose (w<span class="fu">+</span><span class="dv">1</span>, w<span class="fu">*</span>h)</a>
<a class="sourceLine" id="cb53-10" data-line-number="10">  genBufferFixed1 [<span class="dt">Positive</span> len]</a></code></pre></div>
<p>– Splitting</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb54-1" data-line-number="1">prop_splitBufferAtScreenLine_one_line_wrap</a>
<a class="sourceLine" id="cb54-2" data-line-number="2"><span class="ot">  ::</span> forall w t a</a>
<a class="sourceLine" id="cb54-3" data-line-number="3">   <span class="fu">.</span> ( <span class="dt">IsWidth</span> w, <span class="dt">IsTab</span> t, <span class="dt">Valued</span> (<span class="dt">MeasureText</span> w t) a</a>
<a class="sourceLine" id="cb54-4" data-line-number="4">     , <span class="dt">Arbitrary</span> a, <span class="dt">Eq</span> a, <span class="dt">Show</span> a, <span class="dt">IsChar</span> a )</a>
<a class="sourceLine" id="cb54-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> w <span class="ot">-&gt;</span> <span class="dt">Proxy</span> t <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a</a>
<a class="sourceLine" id="cb54-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">Positive</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb54-7" data-line-number="7">prop_splitBufferAtScreenLine_one_line_wrap _ _ _ (<span class="dt">Positive</span> h) <span class="fu">=</span></a>
<a class="sourceLine" id="cb54-8" data-line-number="8">  (h <span class="fu">&gt;</span> <span class="dv">1</span>) <span class="fu">==&gt;</span></a>
<a class="sourceLine" id="cb54-9" data-line-number="9">  forAll (genRenderWrapFixed1 (<span class="dt">Positive</span> h)) <span class="fu">$</span></a>
<a class="sourceLine" id="cb54-10" data-line-number="10">    \(lb, a<span class="fu">:</span>as,<span class="ot"> buf ::</span> <span class="dt">Buffer</span> w t a) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb54-11" data-line-number="11">      <span class="kw">case</span> unBufferFocus (splitBufferAtScreenLine <span class="dv">1</span> buf) <span class="kw">of</span></a>
<a class="sourceLine" id="cb54-12" data-line-number="12">        <span class="dt">Nothing</span> <span class="ot">-&gt;</span> error <span class="st">&quot;prop_splitBufferAtScreenLine_one_line_wrap&quot;</span></a>
<a class="sourceLine" id="cb54-13" data-line-number="13">        <span class="dt">Just</span> (us, x, vs) <span class="ot">-&gt;</span> (a, concat as) <span class="fu">===</span> (us <span class="fu">++</span> [x], vs)</a></code></pre></div>
</body>
</html>
