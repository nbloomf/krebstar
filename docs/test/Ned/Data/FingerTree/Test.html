<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Ned.Data.FingerTree.Test</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <style type="text/css">
  /* Kudos to Pascal Hertleif                  */
  /* https://gist.github.com/killercup/5917178 */
  
  html {
    font-size: 100%;
    overflow-y: scroll;
    -webkit-text-size-adjust: 100%;
    -ms-text-size-adjust: 100%;
  }
  
  body {
    color: #444;
    font-family: Georgia, Palatino, 'Palatino Linotype', Times, 'Times New Roman', serif;
    font-size: 12px;
    line-height: 1.7;
    padding: 1em;
    margin: auto;
    max-width: 42em;
    background: #fefefe;
  }
  
  a {
    color: #0645ad;
    text-decoration: none;
  }
  
  a:visited {
    color: #0b0080;
  }
  
  a:hover {
    color: #06e;
  }
  
  a:active {
    color: #faa700;
  }
  
  a:focus {
    outline: thin dotted;
  }
  
  *::-moz-selection {
    background: rgba(255, 255, 0, 0.3);
    color: #000;
  }
  
  *::selection {
    background: rgba(255, 255, 0, 0.3);
    color: #000;
  }
  
  a::-moz-selection {
    background: rgba(255, 255, 0, 0.3);
    color: #0645ad;
  }
  
  a::selection {
    background: rgba(255, 255, 0, 0.3);
    color: #0645ad;
  }
  
  p {
    margin: 1em 0;
  }
  
  img {
    max-width: 100%;
  }
  
  h1, h2, h3, h4, h5, h6 {
    color: #111;
    line-height: 125%;
    margin-top: 2em;
    font-weight: normal;
  }
  
  h4, h5, h6 {
    font-weight: bold;
  }
  
  h1 {
    font-size: 2.5em;
  }
  
  h2 {
    font-size: 2em;
  }
  
  h3 {
    font-size: 1.5em;
  }
  
  h4 {
    font-size: 1.2em;
  }
  
  h5 {
    font-size: 1em;
  }
  
  h6 {
    font-size: 0.9em;
  }
  
  blockquote {
    display: block;
    color: #666666;
    margin: 0;
    padding-left: 3em;
    border-left: 0.5em #EEE solid;
  }
  
  hr {
    display: block;
    height: 2px;
    border: 0;
    border-top: 1px solid #aaa;
    border-bottom: 1px solid #eee;
    margin: 1em 0;
    padding: 0;
  }
  
  pre, code, kbd, samp {
    color: #000;
    font-family: monospace, monospace;
    _font-family: 'courier new', monospace;
    font-size: 0.98em;
  }
  
  pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
  }
  
  b, strong {
    font-weight: bold;
  }
  
  dfn {
    font-style: italic;
  }
  
  ins {
    background: #ff9;
    color: #000;
    text-decoration: none;
  }
  
  mark {
    background: #ff0;
    color: #000;
    font-style: italic;
    font-weight: bold;
  }
  
  sub, sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
  }
  
  sup {
    top: -0.5em;
  }
  
  sub {
    bottom: -0.25em;
  }
  
  ul, ol {
    margin: 1em 0;
    padding: 0 0 0 2em;
  }
  
  li p:last-child {
    margin-bottom: 0;
  }
  
  ul ul, ol ol {
    margin: .3em 0;
  }
  
  dl {
    margin-bottom: 1em;
  }
  
  dt {
    font-weight: bold;
    margin-bottom: .8em;
  }
  
  dd {
    margin: 0 0 .8em 2em;
  }
  
  dd:last-child {
    margin-bottom: 0;
  }
  
  img {
    border: 0;
    -ms-interpolation-mode: bicubic;
    vertical-align: middle;
  }
  
  figure {
    display: block;
    text-align: center;
    margin: 1em 0;
  }
  
  figure img {
    border: none;
    margin: 0 auto;
  }
  
  figcaption {
    font-size: 0.8em;
    font-style: italic;
    margin: 0 0 .8em;
  }
  
  table {
    margin-bottom: 2em;
    border-bottom: 1px solid #ddd;
    border-right: 1px solid #ddd;
    border-spacing: 0;
    border-collapse: collapse;
  }
  
  table th {
    padding: .2em 1em;
    background-color: #eee;
    border-top: 1px solid #ddd;
    border-left: 1px solid #ddd;
  }
  
  table td {
    padding: .2em 1em;
    border-top: 1px solid #ddd;
    border-left: 1px solid #ddd;
    vertical-align: top;
  }
  
  .author {
    font-size: 1.2em;
    text-align: center;
  }
  
  .sourceCode {
    background-color: #eee;
  }
  
  @media only screen and (min-width: 480px) {
    body {
      font-size: 14px;
    }
  }
  @media only screen and (min-width: 768px) {
    body {
      font-size: 16px;
    }
  }
  @media print {
    * {
      background: transparent !important;
      color: black !important;
      filter: none !important;
      -ms-filter: none !important;
    }
  
    body {
      font-size: 12pt;
      max-width: 100%;
    }
  
    a, a:visited {
      text-decoration: underline;
    }
  
    hr {
      height: 1px;
      border: 0;
      border-bottom: 1px solid black;
    }
  
    a[href]:after {
      content: " (" attr(href) ")";
    }
  
    abbr[title]:after {
      content: " (" attr(title) ")";
    }
  
    .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after {
      content: "";
    }
  
    pre, blockquote {
      border: 1px solid #999;
      padding-right: 1em;
      page-break-inside: avoid;
    }
  
    tr, img {
      page-break-inside: avoid;
    }
  
    img {
      max-width: 100% !important;
    }
  
    @page :left {
      margin: 15mm 20mm 15mm 10mm;
  }
  
    @page :right {
      margin: 15mm 10mm 15mm 20mm;
  }
  
    p, h2, h3 {
      orphans: 3;
      widows: 3;
    }
  
    h2, h3 {
      page-break-after: avoid;
    }
  }
  </style>
</head>
<body>
<header>
<h1 class="title">Ned.Data.FingerTree.Test</h1>
</header>
<h2 id="contents">Contents</h2>
<ul>
<li><a href="#introduction">Introduction</a>
<ul>
<li><a href="#a-note-on-strategy">A note on strategy</a></li>
</ul></li>
<li><a href="#generators">Generators</a></li>
<li><a href="#properties">Properties</a>
<ul>
<li><a href="#count-is-a-monoid">Count is a Monoid</a></li>
<li><a href="#equality-on-finger-trees-is-an-equivalence">Equality on finger trees is an equivalence</a></li>
<li><a href="#finger-trees-and-lists-are-interconvertible">Finger trees and lists are interconvertible</a></li>
<li><a href="#functor-laws-for-fmapft">Functor laws for fmapFT</a></li>
<li><a href="#fold-is-lawful-on-finger-trees">Fold is lawful on finger trees</a></li>
<li><a href="#cons-and-uncons-are-mutual-inverses">Cons and uncons are mutual inverses</a></li>
<li><a href="#finger-trees-form-a-monoid">Finger trees form a monoid</a></li>
<li><a href="#tolist-is-a-monoid-homomorphism">toList is a monoid homomorphism</a></li>
<li><a href="#fromlist-is-a-monoid-homomorphism">fromList is a monoid homomorphism</a></li>
<li><a href="#reverse-is-a-monoid-involution">Reverse is a monoid involution</a></li>
<li><a href="#leaf-is-cons-and-snoc">Leaf is cons and snoc</a></li>
<li><a href="#splitting-properties">Splitting properties</a></li>
<li><a href="#break-properties">Break properties</a></li>
</ul></li>
<li><a href="#test-suite">Test Suite</a></li>
<li><a href="#test-helpers">Test Helpers</a></li>
</ul>
<h1 id="introduction">Introduction</h1>
<p>In <a href="src/Ned/Data/FingerTree.html">Ned.Data.FingerTree</a> we developed a module of code for creating and manipulating finger trees. Now to test it.</p>
<p>Throughout this project we’ll be using the QuickCheck library to write and execute generative property tests. These differ from traditional unit tests in that rather than specifying a prescribed list of input/output/effect triples for a program, we specify boolean <em>properties</em> that the program should satisfy and bombard it with randomly generated data looking for a counterexample. If you’ve never used these before, you’re in for a treat; generative property testing is shockingly effective at rooting out bugs and improving confidence in our code.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="ot">{-# LANGUAGE</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="ot">    MultiParamTypeClasses</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="ot">  , ScopedTypeVariables</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="ot">  , DeriveGeneric</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="ot">#-}</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw">module</span> <span class="dt">Ned.Data.FingerTree.Test</span> (</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">    test_FingerTree</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"></a>
<a class="sourceLine" id="cb1-10" data-line-number="10">  , pCount</a>
<a class="sourceLine" id="cb1-11" data-line-number="11">  , pChar</a>
<a class="sourceLine" id="cb1-12" data-line-number="12">  , pBool</a>
<a class="sourceLine" id="cb1-13" data-line-number="13">  , pTup</a>
<a class="sourceLine" id="cb1-14" data-line-number="14">  , pZZ</a>
<a class="sourceLine" id="cb1-15" data-line-number="15"></a>
<a class="sourceLine" id="cb1-16" data-line-number="16">  <span class="co">-- * Test Helpers</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17">  , testCases</a>
<a class="sourceLine" id="cb1-18" data-line-number="18">  , uncurry3</a>
<a class="sourceLine" id="cb1-19" data-line-number="19">  , uncurry4</a>
<a class="sourceLine" id="cb1-20" data-line-number="20">  , checkOneDepth</a>
<a class="sourceLine" id="cb1-21" data-line-number="21">  , checkPairDepth</a>
<a class="sourceLine" id="cb1-22" data-line-number="22">) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="kw">import</span> <span class="dt">GHC.Generics</span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25"></a>
<a class="sourceLine" id="cb1-26" data-line-number="26"><span class="kw">import</span> <span class="dt">Data.Proxy</span></a>
<a class="sourceLine" id="cb1-27" data-line-number="27"><span class="kw">import</span> <span class="dt">Data.Foldable</span></a>
<a class="sourceLine" id="cb1-28" data-line-number="28"></a>
<a class="sourceLine" id="cb1-29" data-line-number="29"><span class="kw">import</span> <span class="dt">Test.QuickCheck</span></a>
<a class="sourceLine" id="cb1-30" data-line-number="30"><span class="kw">import</span> <span class="dt">Test.Tasty</span></a>
<a class="sourceLine" id="cb1-31" data-line-number="31"><span class="kw">import</span> <span class="dt">Test.Tasty.QuickCheck</span></a>
<a class="sourceLine" id="cb1-32" data-line-number="32"></a>
<a class="sourceLine" id="cb1-33" data-line-number="33"><span class="kw">import</span> <span class="dt">Ned.Data.FingerTree</span></a></code></pre></div>
<h2 id="a-note-on-strategy">A note on strategy</h2>
<p>QuickCheck shines at random testing. But at the same time, there’s value in having fixed test cases. For one thing, when QuickCheck finds a legitimately buggy example, we can keep it around as a regression test for extra goodness. To help with this we’ll define a helper function, <code>testCases</code>, that just runs a given testable property against a list of named examples.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb2-1" data-line-number="1">testCases</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="ot">  ::</span> ( <span class="dt">Testable</span> prop )</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">  <span class="ot">=&gt;</span> (a <span class="ot">-&gt;</span> prop) <span class="ot">-&gt;</span> [(<span class="dt">String</span>, a)] <span class="ot">-&gt;</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">testCases property cs <span class="fu">=</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">  <span class="kw">let</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">    caseNum (l,c) <span class="fu">=</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">      testProperty l (property c)</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">  <span class="kw">in</span> testGroup <span class="st">&quot;Fixed Test Cases&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">    map caseNum cs</a></code></pre></div>
<p>It appears that <code>testCases</code> can only work with properties that take a single argument. But with some extensions to the standars <code>uncurry</code> function this is not really a restriction.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb3-1" data-line-number="1">uncurry3</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="ot">  ::</span> (a1 <span class="ot">-&gt;</span> a2 <span class="ot">-&gt;</span> a3 <span class="ot">-&gt;</span> b)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">  <span class="ot">-&gt;</span> (a1,a2,a3) <span class="ot">-&gt;</span> b</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">uncurry3 f (a1,a2,a3) <span class="fu">=</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">  f a1 a2 a3</a>
<a class="sourceLine" id="cb3-6" data-line-number="6"></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">uncurry4</a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="ot">  ::</span> (a1 <span class="ot">-&gt;</span> a2 <span class="ot">-&gt;</span> a3 <span class="ot">-&gt;</span> a4 <span class="ot">-&gt;</span> b)</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">  <span class="ot">-&gt;</span> (a1,a2,a3,a4) <span class="ot">-&gt;</span> b</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">uncurry4 f (a1,a2,a3,a4) <span class="fu">=</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11">  f a1 a2 a3 a4</a></code></pre></div>
<h2 id="dummy-types">Dummy Types</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">data</span> <span class="dt">ZZ</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">  <span class="fu">=</span> <span class="dt">ZZ</span> <span class="dt">Int</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">  <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>, <span class="dt">Generic</span>)</a>
<a class="sourceLine" id="cb4-4" data-line-number="4"></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="ot">pZZ ::</span> <span class="dt">Proxy</span> <span class="dt">ZZ</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">pZZ <span class="fu">=</span> <span class="dt">Proxy</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="kw">instance</span> <span class="dt">Semigroup</span> <span class="dt">ZZ</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9">  (<span class="dt">ZZ</span> a) <span class="fu">&lt;&gt;</span> (<span class="dt">ZZ</span> b) <span class="fu">=</span> <span class="dt">ZZ</span> (a <span class="fu">+</span> b)</a>
<a class="sourceLine" id="cb4-10" data-line-number="10"></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="kw">instance</span> <span class="dt">Monoid</span> <span class="dt">ZZ</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12">  mempty <span class="fu">=</span> <span class="dt">ZZ</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="kw">instance</span> <span class="dt">Valued</span> <span class="dt">Count</span> <span class="dt">ZZ</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15">  value _ <span class="fu">=</span> <span class="dt">Count</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="kw">instance</span> <span class="dt">Arbitrary</span> <span class="dt">ZZ</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18">  arbitrary <span class="fu">=</span> <span class="dt">ZZ</span> <span class="fu">&lt;$&gt;</span> arbitrary</a>
<a class="sourceLine" id="cb4-19" data-line-number="19"></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="kw">instance</span> <span class="dt">CoArbitrary</span> <span class="dt">ZZ</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21">  coarbitrary (<span class="dt">ZZ</span> k) <span class="fu">=</span> coarbitrary k</a>
<a class="sourceLine" id="cb4-22" data-line-number="22"></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="kw">instance</span> <span class="dt">Function</span> <span class="dt">ZZ</span></a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">data</span> <span class="dt">Tup</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">  <span class="fu">=</span> <span class="dt">Tup</span> <span class="dt">Int</span> <span class="dt">Int</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">  <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>, <span class="dt">Generic</span>)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="ot">pTup ::</span> <span class="dt">Proxy</span> <span class="dt">Tup</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6">pTup <span class="fu">=</span> <span class="dt">Proxy</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="kw">instance</span> <span class="dt">Semigroup</span> <span class="dt">Tup</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9">  (<span class="dt">Tup</span> a1 b1) <span class="fu">&lt;&gt;</span> (<span class="dt">Tup</span> a2 b2) <span class="fu">=</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10">    <span class="kw">if</span> a2 <span class="fu">&gt;</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11">      <span class="kw">then</span> <span class="dt">Tup</span> (a1<span class="fu">+</span>a2) b2</a>
<a class="sourceLine" id="cb5-12" data-line-number="12">      <span class="kw">else</span> <span class="dt">Tup</span> a1 (b1<span class="fu">+</span>b2)</a>
<a class="sourceLine" id="cb5-13" data-line-number="13"></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="kw">instance</span> <span class="dt">Monoid</span> <span class="dt">Tup</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15">  mempty <span class="fu">=</span> <span class="dt">Tup</span> <span class="dv">0</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="kw">instance</span> <span class="dt">Valued</span> <span class="dt">Tup</span> <span class="dt">Bool</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18">  value p <span class="fu">=</span> <span class="kw">if</span> p</a>
<a class="sourceLine" id="cb5-19" data-line-number="19">    <span class="kw">then</span> <span class="dt">Tup</span> <span class="dv">0</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20">    <span class="kw">else</span> <span class="dt">Tup</span> <span class="dv">1</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="kw">instance</span> <span class="dt">Valued</span> <span class="dt">Tup</span> <span class="dt">ZZ</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-23" data-line-number="23">  value (<span class="dt">ZZ</span> k) <span class="fu">=</span> <span class="kw">if</span> <span class="dv">0</span> <span class="fu">==</span> rem k <span class="dv">2</span></a>
<a class="sourceLine" id="cb5-24" data-line-number="24">    <span class="kw">then</span> <span class="dt">Tup</span> <span class="dv">0</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25">    <span class="kw">else</span> <span class="dt">Tup</span> <span class="dv">1</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb5-26" data-line-number="26"></a>
<a class="sourceLine" id="cb5-27" data-line-number="27"><span class="kw">instance</span> <span class="dt">Arbitrary</span> <span class="dt">Tup</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-28" data-line-number="28">  arbitrary <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb5-29" data-line-number="29">    <span class="dt">NonNegative</span> a <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb5-30" data-line-number="30">    <span class="dt">NonNegative</span> b <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb5-31" data-line-number="31">    return <span class="fu">$</span> <span class="dt">Tup</span> a b</a>
<a class="sourceLine" id="cb5-32" data-line-number="32"></a>
<a class="sourceLine" id="cb5-33" data-line-number="33"><span class="kw">instance</span> <span class="dt">CoArbitrary</span> <span class="dt">Tup</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-34" data-line-number="34">  coarbitrary (<span class="dt">Tup</span> a b) <span class="fu">=</span></a>
<a class="sourceLine" id="cb5-35" data-line-number="35">    coarbitrary (a,b)</a>
<a class="sourceLine" id="cb5-36" data-line-number="36"></a>
<a class="sourceLine" id="cb5-37" data-line-number="37"><span class="kw">instance</span> <span class="dt">Function</span> <span class="dt">Tup</span></a></code></pre></div>
<h1 id="generators">Generators</h1>
<div class="sourceCode" id="cb6"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">instance</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">  <span class="dt">Arbitrary</span> <span class="dt">Count</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4">    arbitrary <span class="fu">=</span> <span class="dt">Count</span> <span class="fu">&lt;$&gt;</span> arbitrary</a>
<a class="sourceLine" id="cb6-5" data-line-number="5"></a>
<a class="sourceLine" id="cb6-6" data-line-number="6">    shrink (<span class="dt">Count</span> k) <span class="fu">=</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7">      map <span class="dt">Count</span> <span class="fu">$</span> shrink k</a>
<a class="sourceLine" id="cb6-8" data-line-number="8"></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="kw">instance</span> <span class="dt">CoArbitrary</span> <span class="dt">Count</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10">  coarbitrary (<span class="dt">Count</span> k) <span class="fu">=</span> coarbitrary k</a>
<a class="sourceLine" id="cb6-11" data-line-number="11"></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="kw">instance</span> <span class="dt">Function</span> <span class="dt">Count</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="kw">instance</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15">  ( <span class="dt">Arbitrary</span> a, <span class="dt">Valued</span> m a</a>
<a class="sourceLine" id="cb6-16" data-line-number="16">  ) <span class="ot">=&gt;</span> <span class="dt">Arbitrary</span> (<span class="dt">FingerTree</span> m a)</a>
<a class="sourceLine" id="cb6-17" data-line-number="17">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18">    arbitrary <span class="fu">=</span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19">      fromListFT <span class="fu">&lt;$&gt;</span> arbitrary</a>
<a class="sourceLine" id="cb6-20" data-line-number="20"></a>
<a class="sourceLine" id="cb6-21" data-line-number="21">    shrink <span class="fu">=</span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22">      map fromListFT <span class="fu">.</span> shrink <span class="fu">.</span> toList</a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="ot">pCount ::</span> <span class="dt">Proxy</span> <span class="dt">Count</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">pCount <span class="fu">=</span> <span class="dt">Proxy</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="ot">pChar ::</span> <span class="dt">Proxy</span> <span class="dt">Char</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">pChar <span class="fu">=</span> <span class="dt">Proxy</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="ot">pBool ::</span> <span class="dt">Proxy</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8">pBool <span class="fu">=</span> <span class="dt">Proxy</span></a></code></pre></div>
<h1 id="properties">Properties</h1>
<h2 id="count-is-a-monoid">Count is a Monoid</h2>
<p>Recall that a <em>monoid</em> is a type with an associative binary operation and a neutral element. Algebraic structures like this, and lawful class instances in general, are tailor-made for property testing, which we can demonstrate on the <code>Count</code> type. This particular example looks a little superfluous – surely we don’t need to test the monoid laws for such a simple type. But this example will be a template for tests on more complicated types. More generally it looks like overkill to have so much infrastructure for testing this one module, but the idea is that the structure of these tests will (hopefully) scale nicely to the thornier code.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="ot">test_Count_Monoid ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">test_Count_Monoid <span class="fu">=</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3">  testGroup <span class="st">&quot;Count is a monoid&quot;</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4">    [ test_Count_neutral_left</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">    , test_Count_neutral_right</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">    , test_Count_assoc</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">    ]</a></code></pre></div>
<p>The empty element is neutral from the left:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb9-1" data-line-number="1">prop_Count_neutral_left</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="ot">  ::</span> <span class="dt">Count</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">prop_Count_neutral_left x <span class="fu">=</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">  x <span class="fu">==</span> (mempty <span class="fu">&lt;&gt;</span> x)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="ot">test_Count_neutral_left ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7">test_Count_neutral_left <span class="fu">=</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8">  testGroup <span class="st">&quot;mempty &lt;&gt; x == x&quot;</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9">    [ testProperty <span class="st">&quot;Random Data&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10">        prop_Count_neutral_left</a>
<a class="sourceLine" id="cb9-11" data-line-number="11"></a>
<a class="sourceLine" id="cb9-12" data-line-number="12">    , testCases prop_Count_neutral_left</a>
<a class="sourceLine" id="cb9-13" data-line-number="13">      [ ( <span class="st">&quot;zero&quot;</span>,     <span class="dt">Count</span> <span class="dv">0</span> )</a>
<a class="sourceLine" id="cb9-14" data-line-number="14">      , ( <span class="st">&quot;positive&quot;</span>, <span class="dt">Count</span> <span class="dv">1</span> )</a>
<a class="sourceLine" id="cb9-15" data-line-number="15">      , ( <span class="st">&quot;negative&quot;</span>, <span class="dt">Count</span> (<span class="fu">-</span><span class="dv">1</span>) )</a>
<a class="sourceLine" id="cb9-16" data-line-number="16">      ]</a>
<a class="sourceLine" id="cb9-17" data-line-number="17">    ]</a></code></pre></div>
<p>The empty element is neutral from the right:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb10-1" data-line-number="1">prop_Count_neutral_right</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="ot">  ::</span> <span class="dt">Count</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3">prop_Count_neutral_right x <span class="fu">=</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4">  x <span class="fu">==</span> (x <span class="fu">&lt;&gt;</span> mempty)</a>
<a class="sourceLine" id="cb10-5" data-line-number="5"></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="ot">test_Count_neutral_right ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7">test_Count_neutral_right <span class="fu">=</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8">  testGroup <span class="st">&quot;x &lt;&gt; mempty == x&quot;</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9">    [ testProperty <span class="st">&quot;Random Data&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10">        prop_Count_neutral_right</a>
<a class="sourceLine" id="cb10-11" data-line-number="11"></a>
<a class="sourceLine" id="cb10-12" data-line-number="12">    , testCases prop_Count_neutral_right</a>
<a class="sourceLine" id="cb10-13" data-line-number="13">      [ ( <span class="st">&quot;zero&quot;</span>,     <span class="dt">Count</span> <span class="dv">0</span> )</a>
<a class="sourceLine" id="cb10-14" data-line-number="14">      , ( <span class="st">&quot;positive&quot;</span>, <span class="dt">Count</span> <span class="dv">1</span> )</a>
<a class="sourceLine" id="cb10-15" data-line-number="15">      , ( <span class="st">&quot;negative&quot;</span>, <span class="dt">Count</span> (<span class="fu">-</span><span class="dv">1</span>) )</a>
<a class="sourceLine" id="cb10-16" data-line-number="16">      ]</a>
<a class="sourceLine" id="cb10-17" data-line-number="17">    ]</a></code></pre></div>
<p>The distinguished operator on <code>Count</code> is associative:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb11-1" data-line-number="1">prop_Count_assoc</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="ot">  ::</span> <span class="dt">Count</span> <span class="ot">-&gt;</span> <span class="dt">Count</span> <span class="ot">-&gt;</span> <span class="dt">Count</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3">prop_Count_assoc x y z <span class="fu">=</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"> (x <span class="fu">&lt;&gt;</span> (y <span class="fu">&lt;&gt;</span> z)) <span class="fu">==</span> ((x <span class="fu">&lt;&gt;</span> y) <span class="fu">&lt;&gt;</span> z)</a>
<a class="sourceLine" id="cb11-5" data-line-number="5"></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="ot">test_Count_assoc ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7">test_Count_assoc <span class="fu">=</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8">  testGroup <span class="st">&quot;x &lt;&gt; (y &lt;&gt; z) == (x &lt;&gt; y) &lt;&gt; z&quot;</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9">    [ testProperty <span class="st">&quot;Random Data&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10">        prop_Count_assoc</a>
<a class="sourceLine" id="cb11-11" data-line-number="11"></a>
<a class="sourceLine" id="cb11-12" data-line-number="12">    , testCases (uncurry3 prop_Count_assoc)</a>
<a class="sourceLine" id="cb11-13" data-line-number="13">      [ ( <span class="st">&quot;1,2,3&quot;</span>, (<span class="dt">Count</span> <span class="dv">1</span>, <span class="dt">Count</span> <span class="dv">2</span>, <span class="dt">Count</span> <span class="dv">3</span>) )</a>
<a class="sourceLine" id="cb11-14" data-line-number="14">      ]</a>
<a class="sourceLine" id="cb11-15" data-line-number="15">    ]</a></code></pre></div>
<h2 id="equality-on-finger-trees-is-an-equivalence">Equality on finger trees is an equivalence</h2>
<p>Since we rolled our own <code>Eq</code> instance for finger trees, it makes sense to check that it really is an equivalence relation</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="ot">test_FingerTree_Eq ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">test_FingerTree_Eq <span class="fu">=</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3">  testGroup <span class="st">&quot;(==) on FingerTree is an equivalence&quot;</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4">    [ test_FingerTree_Eq_reflexive</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">    , test_FingerTree_Eq_symmetric</a>
<a class="sourceLine" id="cb12-6" data-line-number="6">    , test_FingerTree_Eq_transitive</a>
<a class="sourceLine" id="cb12-7" data-line-number="7">    ]</a></code></pre></div>
<p>Equality is reflexive:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb13-1" data-line-number="1">prop_FingerTree_Eq_reflexive</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">   , cprop_FingerTree_Eq_reflexive</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb13-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb13-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"></a>
<a class="sourceLine" id="cb13-9" data-line-number="9">prop_FingerTree_Eq_reflexive _ _ xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10">  property <span class="fu">$</span> xs <span class="fu">==</span> xs</a>
<a class="sourceLine" id="cb13-11" data-line-number="11"></a>
<a class="sourceLine" id="cb13-12" data-line-number="12">cprop_FingerTree_Eq_reflexive pa pm xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13">  cover <span class="dv">90</span> (notEmptyFT xs) <span class="st">&quot;xs nonempty&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14">  cover <span class="dv">30</span> (depthFT xs <span class="fu">&gt;=</span> <span class="dv">2</span>) <span class="st">&quot;depth &gt;= 2&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15">  prop_FingerTree_Eq_reflexive pa pm xs</a>
<a class="sourceLine" id="cb13-16" data-line-number="16"></a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="ot">test_FingerTree_Eq_reflexive ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb13-18" data-line-number="18">test_FingerTree_Eq_reflexive <span class="fu">=</span></a>
<a class="sourceLine" id="cb13-19" data-line-number="19">  testGroup <span class="st">&quot;xs == xs&quot;</span></a>
<a class="sourceLine" id="cb13-20" data-line-number="20">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb13-21" data-line-number="21">        cprop_FingerTree_Eq_reflexive pChar pCount</a>
<a class="sourceLine" id="cb13-22" data-line-number="22">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb13-23" data-line-number="23">        cprop_FingerTree_Eq_reflexive pBool pTup</a>
<a class="sourceLine" id="cb13-24" data-line-number="24"></a>
<a class="sourceLine" id="cb13-25" data-line-number="25">    , testCases (prop_FingerTree_Eq_reflexive pChar pCount)</a>
<a class="sourceLine" id="cb13-26" data-line-number="26">      [ ( <span class="st">&quot;mempty&quot;</span>,   mempty )</a>
<a class="sourceLine" id="cb13-27" data-line-number="27">      , ( <span class="st">&quot;leaf &#39;a&#39;&quot;</span>, leaf <span class="ch">&#39;a&#39;</span> )</a>
<a class="sourceLine" id="cb13-28" data-line-number="28">      ]</a>
<a class="sourceLine" id="cb13-29" data-line-number="29">    ]</a></code></pre></div>
<p>Equality is symmetric:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb14-1" data-line-number="1">prop_FingerTree_Eq_symmetric</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">   , cprop_FingerTree_Eq_symmetric</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"></a>
<a class="sourceLine" id="cb14-9" data-line-number="9">prop_FingerTree_Eq_symmetric _ _ xs ys <span class="fu">=</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10">  property <span class="fu">$</span> (xs <span class="fu">==</span> ys) <span class="fu">==</span> (ys <span class="fu">==</span> xs)</a>
<a class="sourceLine" id="cb14-11" data-line-number="11"></a>
<a class="sourceLine" id="cb14-12" data-line-number="12">cprop_FingerTree_Eq_symmetric pa pm xs ys <span class="fu">=</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13">  cover <span class="dv">90</span> ((notEmptyFT xs) <span class="fu">&amp;&amp;</span> (notEmptyFT ys))</a>
<a class="sourceLine" id="cb14-14" data-line-number="14">    <span class="st">&quot;xs and ys nonempty&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15">  cover <span class="dv">40</span> (depthFT xs <span class="fu">+</span> depthFT ys <span class="fu">&gt;</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb14-16" data-line-number="16">    <span class="st">&quot;depth xs + depth ys &gt; 3&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17">  prop_FingerTree_Eq_symmetric pa pm xs ys</a>
<a class="sourceLine" id="cb14-18" data-line-number="18"></a>
<a class="sourceLine" id="cb14-19" data-line-number="19"><span class="ot">test_FingerTree_Eq_symmetric ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb14-20" data-line-number="20">test_FingerTree_Eq_symmetric <span class="fu">=</span></a>
<a class="sourceLine" id="cb14-21" data-line-number="21">  testGroup <span class="st">&quot;xs == ys iff ys == xs&quot;</span></a>
<a class="sourceLine" id="cb14-22" data-line-number="22">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb14-23" data-line-number="23">        cprop_FingerTree_Eq_symmetric pChar pCount</a>
<a class="sourceLine" id="cb14-24" data-line-number="24">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb14-25" data-line-number="25">        cprop_FingerTree_Eq_symmetric pBool pTup</a>
<a class="sourceLine" id="cb14-26" data-line-number="26"></a>
<a class="sourceLine" id="cb14-27" data-line-number="27">    , testCases</a>
<a class="sourceLine" id="cb14-28" data-line-number="28">      (uncurry <span class="fu">$</span></a>
<a class="sourceLine" id="cb14-29" data-line-number="29">        prop_FingerTree_Eq_symmetric pChar pCount)</a>
<a class="sourceLine" id="cb14-30" data-line-number="30">      [ ( <span class="st">&quot;two empty&quot;</span>,           (mempty,   mempty) )</a>
<a class="sourceLine" id="cb14-31" data-line-number="31">      , ( <span class="st">&quot;one empty&quot;</span>,           (mempty,   leaf <span class="ch">&#39;a&#39;</span>) )</a>
<a class="sourceLine" id="cb14-32" data-line-number="32">      , ( <span class="st">&quot;nonempty, equal&quot;</span>,     (leaf <span class="ch">&#39;a&#39;</span>, leaf <span class="ch">&#39;a&#39;</span>) )</a>
<a class="sourceLine" id="cb14-33" data-line-number="33">      , ( <span class="st">&quot;nonempty, not equal&quot;</span>, (leaf <span class="ch">&#39;a&#39;</span>, leaf <span class="ch">&#39;b&#39;</span>) )</a>
<a class="sourceLine" id="cb14-34" data-line-number="34">      ]</a>
<a class="sourceLine" id="cb14-35" data-line-number="35">    ]</a></code></pre></div>
<p>Equality is transitive:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb15-1" data-line-number="1">prop_FingerTree_Eq_transitive</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">   , cprop_FingerTree_Eq_transitive</a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb15-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8"></a>
<a class="sourceLine" id="cb15-9" data-line-number="9">prop_FingerTree_Eq_transitive _ _ xs ys zs <span class="fu">=</span></a>
<a class="sourceLine" id="cb15-10" data-line-number="10">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11">    <span class="kw">if</span> (xs <span class="fu">==</span> ys) <span class="fu">&amp;&amp;</span> (ys <span class="fu">==</span> zs)</a>
<a class="sourceLine" id="cb15-12" data-line-number="12">      <span class="kw">then</span> xs <span class="fu">==</span> zs</a>
<a class="sourceLine" id="cb15-13" data-line-number="13">      <span class="kw">else</span> <span class="dt">True</span></a>
<a class="sourceLine" id="cb15-14" data-line-number="14"></a>
<a class="sourceLine" id="cb15-15" data-line-number="15">cprop_FingerTree_Eq_transitive pa pm xs ys zs <span class="fu">=</span></a>
<a class="sourceLine" id="cb15-16" data-line-number="16">  cover <span class="dv">30</span> (all notEmptyFT [xs,ys,zs])</a>
<a class="sourceLine" id="cb15-17" data-line-number="17">    <span class="st">&quot;xs, ys, zs not empty&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb15-18" data-line-number="18">  cover <span class="dv">40</span> (depthFT xs <span class="fu">+</span> depthFT ys <span class="fu">+</span> depthFT zs <span class="fu">&gt;</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb15-19" data-line-number="19">    <span class="st">&quot;depth xs + depth ys + depth zs &gt; 4&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb15-20" data-line-number="20">  prop_FingerTree_Eq_transitive pa pm xs ys zs</a>
<a class="sourceLine" id="cb15-21" data-line-number="21"></a>
<a class="sourceLine" id="cb15-22" data-line-number="22"><span class="ot">test_FingerTree_Eq_transitive ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb15-23" data-line-number="23">test_FingerTree_Eq_transitive <span class="fu">=</span></a>
<a class="sourceLine" id="cb15-24" data-line-number="24">  testGroup <span class="st">&quot;if xs == ys and ys == zs then xs == zs&quot;</span></a>
<a class="sourceLine" id="cb15-25" data-line-number="25">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb15-26" data-line-number="26">        cprop_FingerTree_Eq_transitive pChar pCount</a>
<a class="sourceLine" id="cb15-27" data-line-number="27">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb15-28" data-line-number="28">        cprop_FingerTree_Eq_transitive pBool pTup</a>
<a class="sourceLine" id="cb15-29" data-line-number="29"></a>
<a class="sourceLine" id="cb15-30" data-line-number="30">    , testCases</a>
<a class="sourceLine" id="cb15-31" data-line-number="31">      (uncurry3 <span class="fu">$</span></a>
<a class="sourceLine" id="cb15-32" data-line-number="32">        prop_FingerTree_Eq_transitive pChar pCount)</a>
<a class="sourceLine" id="cb15-33" data-line-number="33">      [ ( <span class="st">&quot;all empty&quot;</span>,      (mempty, mempty, mempty) )</a>
<a class="sourceLine" id="cb15-34" data-line-number="34">      , ( <span class="st">&quot;xs == ys /= zs&quot;</span>, (leaf <span class="ch">&#39;a&#39;</span>, leaf <span class="ch">&#39;a&#39;</span>, leaf <span class="ch">&#39;b&#39;</span>) )</a>
<a class="sourceLine" id="cb15-35" data-line-number="35">      ]</a>
<a class="sourceLine" id="cb15-36" data-line-number="36">    ]</a></code></pre></div>
<h2 id="finger-trees-and-lists-are-interconvertible">Finger trees and lists are interconvertible</h2>
<p>We have two functions, <code>toList</code> (from the <code>Foldable</code> class) and <code>fromListFT</code>, which convert between finger trees and lists. These should be mutual inverses.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb16-1" data-line-number="1">test_FingerTree_List_convert</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="ot">  ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3">test_FingerTree_List_convert <span class="fu">=</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4">  testGroup <span class="st">&quot;FingerTree and List are interconvertible&quot;</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5">    [ test_FingerTree_toList_fromList</a>
<a class="sourceLine" id="cb16-6" data-line-number="6">    , test_FingerTree_fromList_toList</a>
<a class="sourceLine" id="cb16-7" data-line-number="7">    ]</a></code></pre></div>
<p>Converting a list to a finger tree and back is the identity:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb17-1" data-line-number="1">prop_FingerTree_toList_fromList</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">   , cprop_FingerTree_toList_fromList</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb17-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb17-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb17-6" data-line-number="6">  <span class="ot">-&gt;</span> [a] <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb17-7" data-line-number="7"></a>
<a class="sourceLine" id="cb17-8" data-line-number="8">prop_FingerTree_toList_fromList _ _ xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb17-9" data-line-number="9">  <span class="kw">let</span> t <span class="fu">=</span> fromListFT<span class="ot"> xs ::</span> <span class="dt">FingerTree</span> m a <span class="kw">in</span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10">  property <span class="fu">$</span> toList t <span class="fu">==</span> xs</a>
<a class="sourceLine" id="cb17-11" data-line-number="11"></a>
<a class="sourceLine" id="cb17-12" data-line-number="12">cprop_FingerTree_toList_fromList pa pm xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb17-13" data-line-number="13">  cover <span class="dv">50</span> (length xs <span class="fu">&gt;</span> <span class="dv">30</span>) <span class="st">&quot;length xs &gt; 50&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb17-14" data-line-number="14">  cover <span class="dv">90</span> (length xs <span class="fu">&gt;</span> <span class="dv">0</span>) <span class="st">&quot;length xs &gt; 0&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb17-15" data-line-number="15">  prop_FingerTree_toList_fromList pa pm xs</a>
<a class="sourceLine" id="cb17-16" data-line-number="16"></a>
<a class="sourceLine" id="cb17-17" data-line-number="17"><span class="ot">test_FingerTree_toList_fromList ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb17-18" data-line-number="18">test_FingerTree_toList_fromList <span class="fu">=</span></a>
<a class="sourceLine" id="cb17-19" data-line-number="19">  testGroup <span class="st">&quot;toList . fromList == id (Char, Count)&quot;</span></a>
<a class="sourceLine" id="cb17-20" data-line-number="20">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb17-21" data-line-number="21">        cprop_FingerTree_toList_fromList pChar pCount</a>
<a class="sourceLine" id="cb17-22" data-line-number="22">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb17-23" data-line-number="23">        cprop_FingerTree_toList_fromList pBool pTup</a>
<a class="sourceLine" id="cb17-24" data-line-number="24"></a>
<a class="sourceLine" id="cb17-25" data-line-number="25">    , testCases (prop_FingerTree_toList_fromList pChar pCount)</a>
<a class="sourceLine" id="cb17-26" data-line-number="26">      [ (<span class="st">&quot;\&quot;\&quot;&quot;</span>,    [])</a>
<a class="sourceLine" id="cb17-27" data-line-number="27">      , (<span class="st">&quot;\&quot;abc\&quot;&quot;</span>, [<span class="ch">&#39;a&#39;</span>, <span class="ch">&#39;b&#39;</span>, <span class="ch">&#39;c&#39;</span>])</a>
<a class="sourceLine" id="cb17-28" data-line-number="28">      ]</a>
<a class="sourceLine" id="cb17-29" data-line-number="29">    ]</a></code></pre></div>
<p>Converting a finger tree to a list and back is the identity:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb18-1" data-line-number="1">prop_FingerTree_fromList_toList</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb18-4" data-line-number="4">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb18-5" data-line-number="5">  <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb18-6" data-line-number="6">prop_FingerTree_fromList_toList _ _ xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb18-7" data-line-number="7">  ((fromListFT <span class="fu">$</span> toList xs) <span class="fu">==</span> xs)</a>
<a class="sourceLine" id="cb18-8" data-line-number="8"></a>
<a class="sourceLine" id="cb18-9" data-line-number="9">cprop_FingerTree_fromList_toList</a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb18-11" data-line-number="11">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb18-12" data-line-number="12">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb18-13" data-line-number="13">  <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb18-14" data-line-number="14">cprop_FingerTree_fromList_toList pa pm xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb18-15" data-line-number="15">  cover <span class="dv">90</span> (notEmptyFT xs) <span class="st">&quot;notEmptyFT xs&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb18-16" data-line-number="16">  cover <span class="dv">30</span> (depthFT xs <span class="fu">&gt;</span> <span class="dv">3</span>) <span class="st">&quot;depthFT xs &gt; 3&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb18-17" data-line-number="17">  prop_FingerTree_fromList_toList pa pm xs</a>
<a class="sourceLine" id="cb18-18" data-line-number="18"></a>
<a class="sourceLine" id="cb18-19" data-line-number="19"><span class="ot">test_FingerTree_fromList_toList ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb18-20" data-line-number="20">test_FingerTree_fromList_toList <span class="fu">=</span></a>
<a class="sourceLine" id="cb18-21" data-line-number="21">  testGroup <span class="st">&quot;fromList . toList == id (Char, Count)&quot;</span></a>
<a class="sourceLine" id="cb18-22" data-line-number="22">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb18-23" data-line-number="23">        cprop_FingerTree_fromList_toList pChar pCount</a>
<a class="sourceLine" id="cb18-24" data-line-number="24">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb18-25" data-line-number="25">        cprop_FingerTree_fromList_toList pBool pTup</a>
<a class="sourceLine" id="cb18-26" data-line-number="26"></a>
<a class="sourceLine" id="cb18-27" data-line-number="27">    , testCases (prop_FingerTree_fromList_toList pChar pCount)</a>
<a class="sourceLine" id="cb18-28" data-line-number="28">      [ ( <span class="st">&quot;mempty&quot;</span></a>
<a class="sourceLine" id="cb18-29" data-line-number="29">        , mempty</a>
<a class="sourceLine" id="cb18-30" data-line-number="30">        )</a>
<a class="sourceLine" id="cb18-31" data-line-number="31"></a>
<a class="sourceLine" id="cb18-32" data-line-number="32">      , ( <span class="st">&quot;&#39;a&#39;:&#39;b&#39;:&#39;c&#39;:mempty&quot;</span></a>
<a class="sourceLine" id="cb18-33" data-line-number="33">        , cons <span class="ch">&#39;a&#39;</span> (cons <span class="ch">&#39;b&#39;</span> (cons <span class="ch">&#39;c&#39;</span> mempty))</a>
<a class="sourceLine" id="cb18-34" data-line-number="34">        )</a>
<a class="sourceLine" id="cb18-35" data-line-number="35">      ]</a>
<a class="sourceLine" id="cb18-36" data-line-number="36">    ]</a></code></pre></div>
<h2 id="functor-laws-for-fmapft">Functor laws for fmapFT</h2>
<p>Recall that <code>FingerTree m</code> can’t be a bona fide instance of the functor class due to the weirdness of the <code>Valued</code> constraint; essentially the data type held by the tree is crucially related to <code>m</code>, so the type signature of the real <code>fmap</code> doesn’t work out. But we do have a function that behaves like fmap.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="ot">test_FingerTree_fmapFT ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2">test_FingerTree_fmapFT <span class="fu">=</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3">  testGroup <span class="st">&quot;Functor Laws for FingerTree&quot;</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4">    [ test_FingerTree_fmapFT_identity</a>
<a class="sourceLine" id="cb19-5" data-line-number="5">    , localOption (<span class="dt">QuickCheckTests</span> <span class="dv">500</span>) <span class="fu">$</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6">        test_FingerTree_fmapFT_composite</a>
<a class="sourceLine" id="cb19-7" data-line-number="7">    ]</a></code></pre></div>
<p><code>fmapFT</code> preserves the identity:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb20-1" data-line-number="1">prop_FingerTree_fmapFT_identity</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">   , cprop_FingerTree_fmapFT_identity</a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb20-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb20-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb20-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb20-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"></a>
<a class="sourceLine" id="cb20-9" data-line-number="9">prop_FingerTree_fmapFT_identity _ _ xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11">    xs <span class="fu">==</span> (fmapFT id xs)</a>
<a class="sourceLine" id="cb20-12" data-line-number="12"></a>
<a class="sourceLine" id="cb20-13" data-line-number="13">cprop_FingerTree_fmapFT_identity pa pm xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb20-14" data-line-number="14">  cover <span class="dv">90</span> (notEmptyFT xs) <span class="st">&quot;notEmptyFT xs&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb20-15" data-line-number="15">  cover <span class="dv">30</span> (depthFT xs <span class="fu">&gt;</span> <span class="dv">3</span>) <span class="st">&quot;depthFT xs &gt; 3&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb20-16" data-line-number="16">  prop_FingerTree_fmapFT_identity pa pm xs</a>
<a class="sourceLine" id="cb20-17" data-line-number="17"></a>
<a class="sourceLine" id="cb20-18" data-line-number="18"><span class="ot">test_FingerTree_fmapFT_identity ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb20-19" data-line-number="19">test_FingerTree_fmapFT_identity <span class="fu">=</span></a>
<a class="sourceLine" id="cb20-20" data-line-number="20">  testGroup <span class="st">&quot;fmapFT id == id&quot;</span></a>
<a class="sourceLine" id="cb20-21" data-line-number="21">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb20-22" data-line-number="22">        cprop_FingerTree_fmapFT_identity pChar pCount</a>
<a class="sourceLine" id="cb20-23" data-line-number="23">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb20-24" data-line-number="24">        cprop_FingerTree_fmapFT_identity pBool pTup</a>
<a class="sourceLine" id="cb20-25" data-line-number="25"></a>
<a class="sourceLine" id="cb20-26" data-line-number="26">    , testCases</a>
<a class="sourceLine" id="cb20-27" data-line-number="27">      (prop_FingerTree_fmapFT_identity pChar pCount)</a>
<a class="sourceLine" id="cb20-28" data-line-number="28">      [ ( <span class="st">&quot;mempty&quot;</span>, mempty )</a>
<a class="sourceLine" id="cb20-29" data-line-number="29">      , ( <span class="st">&quot;leaf&quot;</span>,   leaf <span class="ch">&#39;a&#39;</span> )</a>
<a class="sourceLine" id="cb20-30" data-line-number="30">      ]</a>
<a class="sourceLine" id="cb20-31" data-line-number="31">    ]</a></code></pre></div>
<p>And <code>fmapFT</code> preserves composites:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb21-1" data-line-number="1">prop_FingerTree_fmapFT_composite</a>
<a class="sourceLine" id="cb21-2" data-line-number="2">   , cprop_FingerTree_fmapFT_composite</a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="ot">  ::</span> forall a1 m1 a2 m2 a3 m3</a>
<a class="sourceLine" id="cb21-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Valued</span> m1 a1, <span class="dt">Valued</span> m2 a2, <span class="dt">Valued</span> m3 a3, <span class="dt">Eq</span> a3 )</a>
<a class="sourceLine" id="cb21-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a1 <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m1 <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a2</a>
<a class="sourceLine" id="cb21-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m2 <span class="ot">-&gt;</span> <span class="dt">Proxy</span> a3 <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m3</a>
<a class="sourceLine" id="cb21-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Fun</span> a1 a2 <span class="ot">-&gt;</span> <span class="dt">Fun</span> a2 a3 <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m1 a1</a>
<a class="sourceLine" id="cb21-8" data-line-number="8">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb21-9" data-line-number="9"></a>
<a class="sourceLine" id="cb21-10" data-line-number="10">prop_FingerTree_fmapFT_composite _ _ _ _ _ _ f g xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb21-11" data-line-number="11">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb21-12" data-line-number="12">    ((fmapFT ((applyFun g) <span class="fu">.</span> (applyFun f)) xs)<span class="ot"> ::</span> <span class="dt">FingerTree</span> m3 a3)</a>
<a class="sourceLine" id="cb21-13" data-line-number="13">      <span class="fu">==</span> (fmapFT (applyFun g)</a>
<a class="sourceLine" id="cb21-14" data-line-number="14">          (fmapFT (applyFun f)<span class="ot"> xs ::</span> <span class="dt">FingerTree</span> m2 a2))</a>
<a class="sourceLine" id="cb21-15" data-line-number="15"></a>
<a class="sourceLine" id="cb21-16" data-line-number="16">cprop_FingerTree_fmapFT_composite pa pm pb pn pc po f g xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb21-17" data-line-number="17">  cover <span class="dv">90</span> (notEmptyFT xs) <span class="st">&quot;notEmptyFT xs&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb21-18" data-line-number="18">  cover <span class="dv">30</span> (depthFT xs <span class="fu">&gt;</span> <span class="dv">3</span>) <span class="st">&quot;depthFT xs &gt; 3&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb21-19" data-line-number="19">  prop_FingerTree_fmapFT_composite pa pm pb pn pc po f g xs</a>
<a class="sourceLine" id="cb21-20" data-line-number="20"></a>
<a class="sourceLine" id="cb21-21" data-line-number="21"><span class="ot">test_FingerTree_fmapFT_composite ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb21-22" data-line-number="22">test_FingerTree_fmapFT_composite <span class="fu">=</span></a>
<a class="sourceLine" id="cb21-23" data-line-number="23">  testGroup <span class="st">&quot;fmapFT (f . g) == fmapFT f . fmapFT g&quot;</span></a>
<a class="sourceLine" id="cb21-24" data-line-number="24">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb21-25" data-line-number="25">        cprop_FingerTree_fmapFT_composite</a>
<a class="sourceLine" id="cb21-26" data-line-number="26">          pChar pCount pChar pCount pChar pCount</a>
<a class="sourceLine" id="cb21-27" data-line-number="27"></a>
<a class="sourceLine" id="cb21-28" data-line-number="28">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb21-29" data-line-number="29">        cprop_FingerTree_fmapFT_composite</a>
<a class="sourceLine" id="cb21-30" data-line-number="30">          pBool pTup pBool pTup pBool pTup</a>
<a class="sourceLine" id="cb21-31" data-line-number="31">    ]</a></code></pre></div>
<h2 id="fold-is-lawful-on-fingertrees">Fold is lawful on fingertrees</h2>
<p>We get a lot of mileage out of the <code>Foldable</code> instance for <code>FingerTree</code>, so it makes sense to explicitly check that the laws for this class are not not satisifed.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="ot">test_FingerTree_Foldable ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2">test_FingerTree_Foldable <span class="fu">=</span></a>
<a class="sourceLine" id="cb22-3" data-line-number="3">  testGroup <span class="st">&quot;Foldable laws for FingerTree&quot;</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4">    [ test_FingerTree_foldMap_id</a>
<a class="sourceLine" id="cb22-5" data-line-number="5">    , test_FingerTree_foldMap_factor</a>
<a class="sourceLine" id="cb22-6" data-line-number="6">    , test_FingerTree_foldMap_compose</a>
<a class="sourceLine" id="cb22-7" data-line-number="7">    , test_FingerTree_fold_value</a>
<a class="sourceLine" id="cb22-8" data-line-number="8">    ]</a></code></pre></div>
<p><code>fold</code> is a special case of <code>foldMap</code>:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb23-1" data-line-number="1">prop_FingerTree_foldMap_id</a>
<a class="sourceLine" id="cb23-2" data-line-number="2">   , cprop_FingerTree_foldMap_id</a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb23-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a, <span class="dt">Monoid</span> a )</a>
<a class="sourceLine" id="cb23-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb23-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb23-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb23-8" data-line-number="8"></a>
<a class="sourceLine" id="cb23-9" data-line-number="9">prop_FingerTree_foldMap_id _ _ xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb23-10" data-line-number="10">  property <span class="fu">$</span> fold xs <span class="fu">==</span> foldMap id xs</a>
<a class="sourceLine" id="cb23-11" data-line-number="11"></a>
<a class="sourceLine" id="cb23-12" data-line-number="12">cprop_FingerTree_foldMap_id pa pm xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb23-13" data-line-number="13">  cover <span class="dv">70</span> (notEmptyFT xs) <span class="st">&quot;xs nonempty&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb23-14" data-line-number="14">  cover <span class="dv">30</span> (depthFT xs <span class="fu">&gt;</span> <span class="dv">2</span>) <span class="st">&quot;depth xs &gt; 2&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb23-15" data-line-number="15">  prop_FingerTree_foldMap_id pa pm xs</a>
<a class="sourceLine" id="cb23-16" data-line-number="16"></a>
<a class="sourceLine" id="cb23-17" data-line-number="17"><span class="ot">test_FingerTree_foldMap_id ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb23-18" data-line-number="18">test_FingerTree_foldMap_id <span class="fu">=</span></a>
<a class="sourceLine" id="cb23-19" data-line-number="19">  testGroup <span class="st">&quot;fold == foldMap id&quot;</span></a>
<a class="sourceLine" id="cb23-20" data-line-number="20">    [ testProperty <span class="st">&quot;ZZ/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb23-21" data-line-number="21">        cprop_FingerTree_foldMap_id pZZ pCount</a>
<a class="sourceLine" id="cb23-22" data-line-number="22"></a>
<a class="sourceLine" id="cb23-23" data-line-number="23">    , testProperty <span class="st">&quot;ZZ/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb23-24" data-line-number="24">        cprop_FingerTree_foldMap_id pZZ pTup</a>
<a class="sourceLine" id="cb23-25" data-line-number="25">    ]</a></code></pre></div>
<p><code>foldMap f</code> factors as <code>fold . fmap f</code>:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb24-1" data-line-number="1">prop_FingerTree_foldMap_factor</a>
<a class="sourceLine" id="cb24-2" data-line-number="2">   , cprop_FingerTree_foldMap_factor</a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="ot">  ::</span> forall a b m</a>
<a class="sourceLine" id="cb24-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> b, <span class="dt">Valued</span> m a, <span class="dt">Monoid</span> b, <span class="dt">Valued</span> m b )</a>
<a class="sourceLine" id="cb24-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> b <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb24-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">Fun</span> a b <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb24-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb24-8" data-line-number="8"></a>
<a class="sourceLine" id="cb24-9" data-line-number="9">prop_FingerTree_foldMap_factor _ _ _ f xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb24-10" data-line-number="10">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb24-11" data-line-number="11">    (foldMap (applyFun f) xs)</a>
<a class="sourceLine" id="cb24-12" data-line-number="12">      <span class="fu">==</span> (fold (fmapFT (applyFun f)<span class="ot"> xs ::</span> <span class="dt">FingerTree</span> m b))</a>
<a class="sourceLine" id="cb24-13" data-line-number="13"></a>
<a class="sourceLine" id="cb24-14" data-line-number="14">cprop_FingerTree_foldMap_factor pa pb pm f xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb24-15" data-line-number="15">  cover <span class="dv">70</span> (notEmptyFT xs) <span class="st">&quot;xs nonempty&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb24-16" data-line-number="16">  cover <span class="dv">30</span> (depthFT xs <span class="fu">&gt;</span> <span class="dv">2</span>) <span class="st">&quot;depth xs &gt; 2&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb24-17" data-line-number="17">  prop_FingerTree_foldMap_factor pa pb pm f xs</a>
<a class="sourceLine" id="cb24-18" data-line-number="18"></a>
<a class="sourceLine" id="cb24-19" data-line-number="19"><span class="ot">test_FingerTree_foldMap_factor ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb24-20" data-line-number="20">test_FingerTree_foldMap_factor <span class="fu">=</span></a>
<a class="sourceLine" id="cb24-21" data-line-number="21">  testGroup <span class="st">&quot;foldMap f = fold . fmap f&quot;</span></a>
<a class="sourceLine" id="cb24-22" data-line-number="22">    [ testProperty <span class="st">&quot;ZZ/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb24-23" data-line-number="23">        cprop_FingerTree_foldMap_factor pZZ pZZ pCount</a>
<a class="sourceLine" id="cb24-24" data-line-number="24"></a>
<a class="sourceLine" id="cb24-25" data-line-number="25">    , testProperty <span class="st">&quot;ZZ/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb24-26" data-line-number="26">        cprop_FingerTree_foldMap_factor pZZ pZZ pTup</a>
<a class="sourceLine" id="cb24-27" data-line-number="27">    ]</a></code></pre></div>
<p><code>foldMap</code> distributes over composition:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb25-1" data-line-number="1">prop_FingerTree_foldMap_compose</a>
<a class="sourceLine" id="cb25-2" data-line-number="2">   , cprop_FingerTree_foldMap_compose</a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="ot">  ::</span> forall a b c m</a>
<a class="sourceLine" id="cb25-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> b, <span class="dt">Valued</span> m a, <span class="dt">Monoid</span> b, <span class="dt">Valued</span> m b</a>
<a class="sourceLine" id="cb25-5" data-line-number="5">     , <span class="dt">Valued</span> m c, <span class="dt">Monoid</span> c, <span class="dt">Eq</span> c )</a>
<a class="sourceLine" id="cb25-6" data-line-number="6">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> b <span class="ot">-&gt;</span> <span class="dt">Proxy</span> c <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb25-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Fun</span> a b <span class="ot">-&gt;</span> <span class="dt">Fun</span> b c <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb25-8" data-line-number="8">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb25-9" data-line-number="9"></a>
<a class="sourceLine" id="cb25-10" data-line-number="10">prop_FingerTree_foldMap_compose _ _ _ _ f g xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb25-11" data-line-number="11">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb25-12" data-line-number="12">    (foldMap (applyFun g <span class="fu">.</span> applyFun f) xs)</a>
<a class="sourceLine" id="cb25-13" data-line-number="13">      <span class="fu">==</span> (foldMap (applyFun g)</a>
<a class="sourceLine" id="cb25-14" data-line-number="14">          ((fmapFT (applyFun f) xs)<span class="ot"> ::</span> <span class="dt">FingerTree</span> m b))</a>
<a class="sourceLine" id="cb25-15" data-line-number="15"></a>
<a class="sourceLine" id="cb25-16" data-line-number="16">cprop_FingerTree_foldMap_compose pa pb pc pm f g xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb25-17" data-line-number="17">  cover <span class="dv">70</span> (notEmptyFT xs) <span class="st">&quot;xs nonempty&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb25-18" data-line-number="18">  cover <span class="dv">30</span> (depthFT xs <span class="fu">&gt;</span> <span class="dv">2</span>) <span class="st">&quot;depth xs &gt; 2&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb25-19" data-line-number="19">  prop_FingerTree_foldMap_compose pa pb pc pm f g xs</a>
<a class="sourceLine" id="cb25-20" data-line-number="20"></a>
<a class="sourceLine" id="cb25-21" data-line-number="21"><span class="ot">test_FingerTree_foldMap_compose ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb25-22" data-line-number="22">test_FingerTree_foldMap_compose <span class="fu">=</span></a>
<a class="sourceLine" id="cb25-23" data-line-number="23">  testGroup <span class="st">&quot;foldMap (g . f) == foldMap g . fmap f&quot;</span></a>
<a class="sourceLine" id="cb25-24" data-line-number="24">    [ testProperty <span class="st">&quot;ZZ/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb25-25" data-line-number="25">        cprop_FingerTree_foldMap_compose pZZ pZZ pZZ pCount</a>
<a class="sourceLine" id="cb25-26" data-line-number="26"></a>
<a class="sourceLine" id="cb25-27" data-line-number="27">    , testProperty <span class="st">&quot;ZZ/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb25-28" data-line-number="28">        cprop_FingerTree_foldMap_compose pZZ pZZ pZZ pTup</a>
<a class="sourceLine" id="cb25-29" data-line-number="29">    ]</a></code></pre></div>
<p><code>fold</code> is compatible with <code>value</code>:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb26-1" data-line-number="1">prop_FingerTree_fold_value</a>
<a class="sourceLine" id="cb26-2" data-line-number="2">   , cprop_FingerTree_fold_value</a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb26-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a, <span class="dt">Eq</span> m )</a>
<a class="sourceLine" id="cb26-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb26-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb26-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb26-8" data-line-number="8"></a>
<a class="sourceLine" id="cb26-9" data-line-number="9">prop_FingerTree_fold_value _ _ xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb26-10" data-line-number="10">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb26-11" data-line-number="11">    (value<span class="ot"> xs ::</span> m) <span class="fu">==</span> fold (map value <span class="fu">$</span> toList xs)</a>
<a class="sourceLine" id="cb26-12" data-line-number="12"></a>
<a class="sourceLine" id="cb26-13" data-line-number="13">cprop_FingerTree_fold_value pa pm xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb26-14" data-line-number="14">  cover <span class="dv">70</span> (notEmptyFT xs) <span class="st">&quot;xs nonempty&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb26-15" data-line-number="15">  cover <span class="dv">30</span> (depthFT xs <span class="fu">&gt;</span> <span class="dv">2</span>) <span class="st">&quot;depth xs &gt; 2&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb26-16" data-line-number="16">  prop_FingerTree_fold_value pa pm xs</a>
<a class="sourceLine" id="cb26-17" data-line-number="17"></a>
<a class="sourceLine" id="cb26-18" data-line-number="18"><span class="ot">test_FingerTree_fold_value ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb26-19" data-line-number="19">test_FingerTree_fold_value <span class="fu">=</span></a>
<a class="sourceLine" id="cb26-20" data-line-number="20">  testGroup <span class="st">&quot;value == fold . fmapFT value&quot;</span></a>
<a class="sourceLine" id="cb26-21" data-line-number="21">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb26-22" data-line-number="22">        cprop_FingerTree_fold_value pChar pCount</a>
<a class="sourceLine" id="cb26-23" data-line-number="23">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb26-24" data-line-number="24">        cprop_FingerTree_fold_value pBool pTup</a>
<a class="sourceLine" id="cb26-25" data-line-number="25"></a>
<a class="sourceLine" id="cb26-26" data-line-number="26">    , testCases</a>
<a class="sourceLine" id="cb26-27" data-line-number="27">      (prop_FingerTree_fold_value pChar pCount)</a>
<a class="sourceLine" id="cb26-28" data-line-number="28">      [ ( <span class="st">&quot;mempty&quot;</span>, mempty )</a>
<a class="sourceLine" id="cb26-29" data-line-number="29">      ]</a>
<a class="sourceLine" id="cb26-30" data-line-number="30">    ]</a></code></pre></div>
<h2 id="cons-and-uncons-are-mutual-inverses">Cons and uncons are mutual inverses</h2>
<p>The <code>cons</code> and <code>uncons</code> functions are inverses of each other (sort of); likewise <code>snoc</code> and <code>unsnoc</code>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="ot">test_FingerTree_cons_snoc_inverses ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2">test_FingerTree_cons_snoc_inverses <span class="fu">=</span></a>
<a class="sourceLine" id="cb27-3" data-line-number="3">  testGroup <span class="st">&quot;cons/snoc and uncons/unsnoc are mutual inverses&quot;</span></a>
<a class="sourceLine" id="cb27-4" data-line-number="4">    [ test_FingerTree_cons_uncons</a>
<a class="sourceLine" id="cb27-5" data-line-number="5">    , test_FingerTree_uncons_cons</a>
<a class="sourceLine" id="cb27-6" data-line-number="6">    , test_FingerTree_snoc_unsnoc</a>
<a class="sourceLine" id="cb27-7" data-line-number="7">    , test_FingerTree_unsnoc_snoc</a>
<a class="sourceLine" id="cb27-8" data-line-number="8">    , test_FingerTree_uncons_mempty</a>
<a class="sourceLine" id="cb27-9" data-line-number="9">    , test_FingerTree_unsnoc_mempty</a>
<a class="sourceLine" id="cb27-10" data-line-number="10">    ]</a></code></pre></div>
<p><code>uncons</code> followed by <code>cons</code>:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb28-1" data-line-number="1">prop_FingerTree_cons_uncons</a>
<a class="sourceLine" id="cb28-2" data-line-number="2">   , cprop_FingerTree_cons_uncons</a>
<a class="sourceLine" id="cb28-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb28-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb28-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb28-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb28-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb28-8" data-line-number="8"></a>
<a class="sourceLine" id="cb28-9" data-line-number="9">prop_FingerTree_cons_uncons _ _ xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb28-10" data-line-number="10">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb28-11" data-line-number="11">    <span class="kw">case</span> uncons xs <span class="kw">of</span></a>
<a class="sourceLine" id="cb28-12" data-line-number="12">      <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="dt">True</span></a>
<a class="sourceLine" id="cb28-13" data-line-number="13">      <span class="dt">Just</span> (a,zs) <span class="ot">-&gt;</span> xs <span class="fu">==</span> cons a zs</a>
<a class="sourceLine" id="cb28-14" data-line-number="14"></a>
<a class="sourceLine" id="cb28-15" data-line-number="15">cprop_FingerTree_cons_uncons pa pm xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb28-16" data-line-number="16">  cover <span class="dv">50</span> (notEmptyFT xs) <span class="st">&quot;xs nonempty&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb28-17" data-line-number="17">  checkOneDepth xs <span class="fu">$</span></a>
<a class="sourceLine" id="cb28-18" data-line-number="18">  prop_FingerTree_cons_uncons pa pm xs</a>
<a class="sourceLine" id="cb28-19" data-line-number="19"></a>
<a class="sourceLine" id="cb28-20" data-line-number="20"><span class="ot">test_FingerTree_cons_uncons ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb28-21" data-line-number="21">test_FingerTree_cons_uncons <span class="fu">=</span></a>
<a class="sourceLine" id="cb28-22" data-line-number="22">  testGroup <span class="st">&quot;cons . uncons == id&quot;</span></a>
<a class="sourceLine" id="cb28-23" data-line-number="23">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb28-24" data-line-number="24">        cprop_FingerTree_cons_uncons pChar pCount</a>
<a class="sourceLine" id="cb28-25" data-line-number="25">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb28-26" data-line-number="26">        cprop_FingerTree_cons_uncons pBool pTup</a>
<a class="sourceLine" id="cb28-27" data-line-number="27"></a>
<a class="sourceLine" id="cb28-28" data-line-number="28">    , testCases</a>
<a class="sourceLine" id="cb28-29" data-line-number="29">      (prop_FingerTree_cons_uncons pChar pCount)</a>
<a class="sourceLine" id="cb28-30" data-line-number="30">      [ ( <span class="st">&quot;mempty&quot;</span>, mempty )</a>
<a class="sourceLine" id="cb28-31" data-line-number="31">      , ( <span class="st">&quot;leaf&quot;</span>,   leaf <span class="ch">&#39;a&#39;</span> )</a>
<a class="sourceLine" id="cb28-32" data-line-number="32">      ]</a>
<a class="sourceLine" id="cb28-33" data-line-number="33">    ]</a></code></pre></div>
<p><code>cons</code> followed by <code>uncons</code>:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb29-1" data-line-number="1">prop_FingerTree_uncons_cons</a>
<a class="sourceLine" id="cb29-2" data-line-number="2">   , cprop_FingerTree_uncons_cons</a>
<a class="sourceLine" id="cb29-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb29-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb29-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb29-6" data-line-number="6">  <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb29-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb29-8" data-line-number="8"></a>
<a class="sourceLine" id="cb29-9" data-line-number="9">prop_FingerTree_uncons_cons _ _ a xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb29-10" data-line-number="10">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb29-11" data-line-number="11">    <span class="kw">case</span> uncons (cons a xs) <span class="kw">of</span></a>
<a class="sourceLine" id="cb29-12" data-line-number="12">      <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="dt">False</span></a>
<a class="sourceLine" id="cb29-13" data-line-number="13">      <span class="dt">Just</span> (b,ys) <span class="ot">-&gt;</span> (a <span class="fu">==</span> b) <span class="fu">&amp;&amp;</span> (xs <span class="fu">==</span> ys)</a>
<a class="sourceLine" id="cb29-14" data-line-number="14"></a>
<a class="sourceLine" id="cb29-15" data-line-number="15">cprop_FingerTree_uncons_cons pa pm a xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb29-16" data-line-number="16">  cover <span class="dv">50</span> (notEmptyFT xs) <span class="st">&quot;xs nonempty&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb29-17" data-line-number="17">  checkOneDepth xs <span class="fu">$</span></a>
<a class="sourceLine" id="cb29-18" data-line-number="18">  prop_FingerTree_uncons_cons pa pm a xs</a>
<a class="sourceLine" id="cb29-19" data-line-number="19"></a>
<a class="sourceLine" id="cb29-20" data-line-number="20"><span class="ot">test_FingerTree_uncons_cons ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb29-21" data-line-number="21">test_FingerTree_uncons_cons <span class="fu">=</span></a>
<a class="sourceLine" id="cb29-22" data-line-number="22">  testGroup <span class="st">&quot;uncons . cons == id&quot;</span></a>
<a class="sourceLine" id="cb29-23" data-line-number="23">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb29-24" data-line-number="24">        cprop_FingerTree_uncons_cons pChar pCount</a>
<a class="sourceLine" id="cb29-25" data-line-number="25">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb29-26" data-line-number="26">        cprop_FingerTree_uncons_cons pBool pTup</a>
<a class="sourceLine" id="cb29-27" data-line-number="27"></a>
<a class="sourceLine" id="cb29-28" data-line-number="28">    , testCases</a>
<a class="sourceLine" id="cb29-29" data-line-number="29">      (uncurry (prop_FingerTree_uncons_cons pChar pCount))</a>
<a class="sourceLine" id="cb29-30" data-line-number="30">      [ ( <span class="st">&quot;empty&quot;</span>, ( <span class="ch">&#39;a&#39;</span>, mempty ) )</a>
<a class="sourceLine" id="cb29-31" data-line-number="31">      , ( <span class="st">&quot;leaf&quot;</span>,  ( <span class="ch">&#39;a&#39;</span>, leaf <span class="ch">&#39;b&#39;</span> ) )</a>
<a class="sourceLine" id="cb29-32" data-line-number="32">      ]</a>
<a class="sourceLine" id="cb29-33" data-line-number="33">    ]</a></code></pre></div>
<p><code>unsnoc</code> followed by <code>snoc</code>:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb30-1" data-line-number="1">prop_FingerTree_snoc_unsnoc</a>
<a class="sourceLine" id="cb30-2" data-line-number="2">   , cprop_FingerTree_snoc_unsnoc</a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb30-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb30-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb30-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb30-7" data-line-number="7"></a>
<a class="sourceLine" id="cb30-8" data-line-number="8">prop_FingerTree_snoc_unsnoc _ _ xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb30-9" data-line-number="9">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb30-10" data-line-number="10">    <span class="kw">case</span> unsnoc xs <span class="kw">of</span></a>
<a class="sourceLine" id="cb30-11" data-line-number="11">      <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="dt">True</span></a>
<a class="sourceLine" id="cb30-12" data-line-number="12">      <span class="dt">Just</span> (a,zs) <span class="ot">-&gt;</span> xs <span class="fu">==</span> snoc a zs</a>
<a class="sourceLine" id="cb30-13" data-line-number="13"></a>
<a class="sourceLine" id="cb30-14" data-line-number="14">cprop_FingerTree_snoc_unsnoc pa pm xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb30-15" data-line-number="15">  cover <span class="dv">50</span> (notEmptyFT xs) <span class="st">&quot;xs nonempty&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb30-16" data-line-number="16">  checkOneDepth xs <span class="fu">$</span></a>
<a class="sourceLine" id="cb30-17" data-line-number="17">  prop_FingerTree_snoc_unsnoc pa pm xs</a>
<a class="sourceLine" id="cb30-18" data-line-number="18"></a>
<a class="sourceLine" id="cb30-19" data-line-number="19"><span class="ot">test_FingerTree_snoc_unsnoc ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb30-20" data-line-number="20">test_FingerTree_snoc_unsnoc <span class="fu">=</span></a>
<a class="sourceLine" id="cb30-21" data-line-number="21">  testGroup <span class="st">&quot;snoc . unsnoc == id&quot;</span></a>
<a class="sourceLine" id="cb30-22" data-line-number="22">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb30-23" data-line-number="23">        cprop_FingerTree_snoc_unsnoc pChar pCount</a>
<a class="sourceLine" id="cb30-24" data-line-number="24">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb30-25" data-line-number="25">        cprop_FingerTree_snoc_unsnoc pBool pTup</a>
<a class="sourceLine" id="cb30-26" data-line-number="26"></a>
<a class="sourceLine" id="cb30-27" data-line-number="27">    , testCases</a>
<a class="sourceLine" id="cb30-28" data-line-number="28">      (prop_FingerTree_snoc_unsnoc pChar pCount)</a>
<a class="sourceLine" id="cb30-29" data-line-number="29">      [ ( <span class="st">&quot;mempty&quot;</span>, mempty )</a>
<a class="sourceLine" id="cb30-30" data-line-number="30">      , ( <span class="st">&quot;leaf&quot;</span>,   leaf <span class="ch">&#39;a&#39;</span> )</a>
<a class="sourceLine" id="cb30-31" data-line-number="31">      ]</a>
<a class="sourceLine" id="cb30-32" data-line-number="32">    ]</a></code></pre></div>
<p><code>snoc</code> followed by <code>unsnoc</code>:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb31-1" data-line-number="1">prop_FingerTree_unsnoc_snoc</a>
<a class="sourceLine" id="cb31-2" data-line-number="2">   , cprop_FingerTree_unsnoc_snoc</a>
<a class="sourceLine" id="cb31-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb31-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb31-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb31-6" data-line-number="6">  <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb31-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb31-8" data-line-number="8"></a>
<a class="sourceLine" id="cb31-9" data-line-number="9">prop_FingerTree_unsnoc_snoc _ _ a xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb31-10" data-line-number="10">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb31-11" data-line-number="11">    <span class="kw">case</span> unsnoc (snoc a xs) <span class="kw">of</span></a>
<a class="sourceLine" id="cb31-12" data-line-number="12">      <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="dt">False</span></a>
<a class="sourceLine" id="cb31-13" data-line-number="13">      <span class="dt">Just</span> (b,ys) <span class="ot">-&gt;</span> (a <span class="fu">==</span> b) <span class="fu">&amp;&amp;</span> (xs <span class="fu">==</span> ys)</a>
<a class="sourceLine" id="cb31-14" data-line-number="14"></a>
<a class="sourceLine" id="cb31-15" data-line-number="15">cprop_FingerTree_unsnoc_snoc pa pm a xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb31-16" data-line-number="16">  cover <span class="dv">50</span> (notEmptyFT xs) <span class="st">&quot;xs nonempty&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb31-17" data-line-number="17">  checkOneDepth xs <span class="fu">$</span></a>
<a class="sourceLine" id="cb31-18" data-line-number="18">  prop_FingerTree_unsnoc_snoc pa pm a xs</a>
<a class="sourceLine" id="cb31-19" data-line-number="19"></a>
<a class="sourceLine" id="cb31-20" data-line-number="20"><span class="ot">test_FingerTree_unsnoc_snoc ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb31-21" data-line-number="21">test_FingerTree_unsnoc_snoc <span class="fu">=</span></a>
<a class="sourceLine" id="cb31-22" data-line-number="22">  testGroup <span class="st">&quot;unsnoc . snoc == id&quot;</span></a>
<a class="sourceLine" id="cb31-23" data-line-number="23">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb31-24" data-line-number="24">        cprop_FingerTree_unsnoc_snoc pChar pCount</a>
<a class="sourceLine" id="cb31-25" data-line-number="25">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb31-26" data-line-number="26">        cprop_FingerTree_unsnoc_snoc pBool pTup</a>
<a class="sourceLine" id="cb31-27" data-line-number="27"></a>
<a class="sourceLine" id="cb31-28" data-line-number="28">    , testCases</a>
<a class="sourceLine" id="cb31-29" data-line-number="29">      (uncurry <span class="fu">$</span> prop_FingerTree_unsnoc_snoc pChar pCount)</a>
<a class="sourceLine" id="cb31-30" data-line-number="30">      [ ( <span class="st">&quot;empty&quot;</span>, ( <span class="ch">&#39;a&#39;</span>, mempty ) )</a>
<a class="sourceLine" id="cb31-31" data-line-number="31">      , ( <span class="st">&quot;leaf&quot;</span>,  ( <span class="ch">&#39;a&#39;</span>, leaf <span class="ch">&#39;b&#39;</span> ) )</a>
<a class="sourceLine" id="cb31-32" data-line-number="32">      ]</a>
<a class="sourceLine" id="cb31-33" data-line-number="33">    ]</a></code></pre></div>
<p><code>uncons</code> is only <code>Nothing</code> on empty inputs:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb32-1" data-line-number="1">prop_FingerTree_uncons_mempty</a>
<a class="sourceLine" id="cb32-2" data-line-number="2">   , cprop_FingerTree_uncons_mempty</a>
<a class="sourceLine" id="cb32-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb32-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb32-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb32-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb32-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb32-8" data-line-number="8"></a>
<a class="sourceLine" id="cb32-9" data-line-number="9">prop_FingerTree_uncons_mempty _ _ xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb32-10" data-line-number="10">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb32-11" data-line-number="11">    (<span class="dt">Nothing</span> <span class="fu">==</span> uncons xs) <span class="fu">==</span> (xs <span class="fu">==</span> mempty)</a>
<a class="sourceLine" id="cb32-12" data-line-number="12"></a>
<a class="sourceLine" id="cb32-13" data-line-number="13">cprop_FingerTree_uncons_mempty pa pm xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb32-14" data-line-number="14">  cover <span class="dv">50</span> (notEmptyFT xs) <span class="st">&quot;xs nonempty&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb32-15" data-line-number="15">  cover <span class="dv">2</span> (isEmptyFT xs) <span class="st">&quot;xs empty&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb32-16" data-line-number="16">  checkOneDepth xs <span class="fu">$</span></a>
<a class="sourceLine" id="cb32-17" data-line-number="17">  prop_FingerTree_uncons_mempty pa pm xs</a>
<a class="sourceLine" id="cb32-18" data-line-number="18"></a>
<a class="sourceLine" id="cb32-19" data-line-number="19"><span class="ot">test_FingerTree_uncons_mempty ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb32-20" data-line-number="20">test_FingerTree_uncons_mempty <span class="fu">=</span></a>
<a class="sourceLine" id="cb32-21" data-line-number="21">  testGroup <span class="st">&quot;uncons == Nothing&quot;</span></a>
<a class="sourceLine" id="cb32-22" data-line-number="22">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb32-23" data-line-number="23">        cprop_FingerTree_uncons_mempty pChar pCount</a>
<a class="sourceLine" id="cb32-24" data-line-number="24">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb32-25" data-line-number="25">        cprop_FingerTree_uncons_mempty pBool pTup</a>
<a class="sourceLine" id="cb32-26" data-line-number="26"></a>
<a class="sourceLine" id="cb32-27" data-line-number="27">    , testCases</a>
<a class="sourceLine" id="cb32-28" data-line-number="28">      (prop_FingerTree_uncons_mempty pChar pCount)</a>
<a class="sourceLine" id="cb32-29" data-line-number="29">      [ ( <span class="st">&quot;mempty&quot;</span>, mempty )</a>
<a class="sourceLine" id="cb32-30" data-line-number="30">      , ( <span class="st">&quot;leaf&quot;</span>,   leaf <span class="ch">&#39;a&#39;</span> )</a>
<a class="sourceLine" id="cb32-31" data-line-number="31">      ]</a>
<a class="sourceLine" id="cb32-32" data-line-number="32">    ]</a></code></pre></div>
<p><code>unsnoc</code> is only <code>Nothing</code> on empty inputs:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb33-1" data-line-number="1">prop_FingerTree_unsnoc_mempty</a>
<a class="sourceLine" id="cb33-2" data-line-number="2">   , cprop_FingerTree_unsnoc_mempty</a>
<a class="sourceLine" id="cb33-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb33-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb33-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb33-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb33-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb33-8" data-line-number="8"></a>
<a class="sourceLine" id="cb33-9" data-line-number="9">prop_FingerTree_unsnoc_mempty _ _ xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb33-10" data-line-number="10">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb33-11" data-line-number="11">    (<span class="dt">Nothing</span> <span class="fu">==</span> unsnoc xs) <span class="fu">==</span> (xs <span class="fu">==</span> mempty)</a>
<a class="sourceLine" id="cb33-12" data-line-number="12"></a>
<a class="sourceLine" id="cb33-13" data-line-number="13">cprop_FingerTree_unsnoc_mempty pa pm xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb33-14" data-line-number="14">  cover <span class="dv">50</span> (notEmptyFT xs) <span class="st">&quot;xs nonempty&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb33-15" data-line-number="15">  cover <span class="dv">2</span> (isEmptyFT xs) <span class="st">&quot;xs empty&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb33-16" data-line-number="16">  checkOneDepth xs <span class="fu">$</span></a>
<a class="sourceLine" id="cb33-17" data-line-number="17">  prop_FingerTree_unsnoc_mempty pa pm xs</a>
<a class="sourceLine" id="cb33-18" data-line-number="18"></a>
<a class="sourceLine" id="cb33-19" data-line-number="19"><span class="ot">test_FingerTree_unsnoc_mempty ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb33-20" data-line-number="20">test_FingerTree_unsnoc_mempty <span class="fu">=</span></a>
<a class="sourceLine" id="cb33-21" data-line-number="21">  testGroup <span class="st">&quot;unsnoc == Nothing&quot;</span></a>
<a class="sourceLine" id="cb33-22" data-line-number="22">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb33-23" data-line-number="23">        cprop_FingerTree_unsnoc_mempty pChar pCount</a>
<a class="sourceLine" id="cb33-24" data-line-number="24">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb33-25" data-line-number="25">        cprop_FingerTree_unsnoc_mempty pBool pTup</a>
<a class="sourceLine" id="cb33-26" data-line-number="26"></a>
<a class="sourceLine" id="cb33-27" data-line-number="27">    , testCases</a>
<a class="sourceLine" id="cb33-28" data-line-number="28">      (prop_FingerTree_unsnoc_mempty pChar pCount)</a>
<a class="sourceLine" id="cb33-29" data-line-number="29">      [ ( <span class="st">&quot;mempty&quot;</span>, mempty )</a>
<a class="sourceLine" id="cb33-30" data-line-number="30">      , ( <span class="st">&quot;leaf&quot;</span>,   leaf <span class="ch">&#39;a&#39;</span> )</a>
<a class="sourceLine" id="cb33-31" data-line-number="31">      ]</a>
<a class="sourceLine" id="cb33-32" data-line-number="32">    ]</a></code></pre></div>
<h2 id="finger-trees-form-a-monoid">Finger trees form a monoid</h2>
<p>Concatenation and mempty form a monoid structure on finger trees.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="ot">test_FingerTree_Monoid ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb34-2" data-line-number="2">test_FingerTree_Monoid <span class="fu">=</span></a>
<a class="sourceLine" id="cb34-3" data-line-number="3">  testGroup <span class="st">&quot;Monoid laws for concat/mempty&quot;</span></a>
<a class="sourceLine" id="cb34-4" data-line-number="4">    [ test_FingerTree_Monoid_left_neutral</a>
<a class="sourceLine" id="cb34-5" data-line-number="5">    , test_FingerTree_Monoid_right_neutral</a>
<a class="sourceLine" id="cb34-6" data-line-number="6">    , test_FingerTree_Monoid_associative</a>
<a class="sourceLine" id="cb34-7" data-line-number="7">    ]</a></code></pre></div>
<p><code>mempty</code> is left neutral for concatenation:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb35-1" data-line-number="1">prop_FingerTree_Monoid_left_neutral</a>
<a class="sourceLine" id="cb35-2" data-line-number="2">   , cprop_FingerTree_Monoid_left_neutral</a>
<a class="sourceLine" id="cb35-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb35-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb35-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb35-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb35-7" data-line-number="7"></a>
<a class="sourceLine" id="cb35-8" data-line-number="8">prop_FingerTree_Monoid_left_neutral _ _ xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb35-9" data-line-number="9">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb35-10" data-line-number="10">    (mempty <span class="fu">&lt;&gt;</span> xs) <span class="fu">==</span> xs</a>
<a class="sourceLine" id="cb35-11" data-line-number="11"></a>
<a class="sourceLine" id="cb35-12" data-line-number="12">cprop_FingerTree_Monoid_left_neutral pa pm xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb35-13" data-line-number="13">  cover <span class="dv">50</span> (notEmptyFT xs) <span class="st">&quot;xs nonempty&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb35-14" data-line-number="14">  checkOneDepth xs <span class="fu">$</span></a>
<a class="sourceLine" id="cb35-15" data-line-number="15">  prop_FingerTree_Monoid_left_neutral pa pm xs</a>
<a class="sourceLine" id="cb35-16" data-line-number="16"></a>
<a class="sourceLine" id="cb35-17" data-line-number="17"><span class="ot">test_FingerTree_Monoid_left_neutral ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb35-18" data-line-number="18">test_FingerTree_Monoid_left_neutral <span class="fu">=</span></a>
<a class="sourceLine" id="cb35-19" data-line-number="19">  testGroup <span class="st">&quot;mempty &lt;&gt; xs == xs&quot;</span></a>
<a class="sourceLine" id="cb35-20" data-line-number="20">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb35-21" data-line-number="21">        cprop_FingerTree_Monoid_left_neutral pChar pCount</a>
<a class="sourceLine" id="cb35-22" data-line-number="22">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb35-23" data-line-number="23">        cprop_FingerTree_Monoid_left_neutral pBool pTup</a>
<a class="sourceLine" id="cb35-24" data-line-number="24"></a>
<a class="sourceLine" id="cb35-25" data-line-number="25">    , testCases</a>
<a class="sourceLine" id="cb35-26" data-line-number="26">      (prop_FingerTree_Monoid_left_neutral pChar pCount)</a>
<a class="sourceLine" id="cb35-27" data-line-number="27">      [ ( <span class="st">&quot;mempty&quot;</span>, mempty )</a>
<a class="sourceLine" id="cb35-28" data-line-number="28">      , ( <span class="st">&quot;leaf&quot;</span>,   leaf <span class="ch">&#39;a&#39;</span> )</a>
<a class="sourceLine" id="cb35-29" data-line-number="29">      ]</a>
<a class="sourceLine" id="cb35-30" data-line-number="30">    ]</a></code></pre></div>
<p><code>mempty</code> is right neutral for concatenation:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb36-1" data-line-number="1">prop_FingerTree_Monoid_right_neutral</a>
<a class="sourceLine" id="cb36-2" data-line-number="2">   , cprop_FingerTree_Monoid_right_neutral</a>
<a class="sourceLine" id="cb36-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb36-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb36-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb36-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb36-7" data-line-number="7"></a>
<a class="sourceLine" id="cb36-8" data-line-number="8">prop_FingerTree_Monoid_right_neutral _ _ xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb36-9" data-line-number="9">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb36-10" data-line-number="10">    (xs <span class="fu">&lt;&gt;</span> mempty) <span class="fu">==</span> xs</a>
<a class="sourceLine" id="cb36-11" data-line-number="11"></a>
<a class="sourceLine" id="cb36-12" data-line-number="12">cprop_FingerTree_Monoid_right_neutral pa pm xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb36-13" data-line-number="13">  cover <span class="dv">50</span> (notEmptyFT xs) <span class="st">&quot;xs nonempty&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb36-14" data-line-number="14">  checkOneDepth xs <span class="fu">$</span></a>
<a class="sourceLine" id="cb36-15" data-line-number="15">  prop_FingerTree_Monoid_right_neutral pa pm xs</a>
<a class="sourceLine" id="cb36-16" data-line-number="16"></a>
<a class="sourceLine" id="cb36-17" data-line-number="17"><span class="ot">test_FingerTree_Monoid_right_neutral ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb36-18" data-line-number="18">test_FingerTree_Monoid_right_neutral <span class="fu">=</span></a>
<a class="sourceLine" id="cb36-19" data-line-number="19">  testGroup <span class="st">&quot;mempty &lt;&gt; xs == xs&quot;</span></a>
<a class="sourceLine" id="cb36-20" data-line-number="20">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb36-21" data-line-number="21">        cprop_FingerTree_Monoid_right_neutral pChar pCount</a>
<a class="sourceLine" id="cb36-22" data-line-number="22">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb36-23" data-line-number="23">        cprop_FingerTree_Monoid_right_neutral pBool pTup</a>
<a class="sourceLine" id="cb36-24" data-line-number="24"></a>
<a class="sourceLine" id="cb36-25" data-line-number="25">    , testCases</a>
<a class="sourceLine" id="cb36-26" data-line-number="26">      (prop_FingerTree_Monoid_right_neutral pChar pCount)</a>
<a class="sourceLine" id="cb36-27" data-line-number="27">      [ ( <span class="st">&quot;mempty&quot;</span>, mempty )</a>
<a class="sourceLine" id="cb36-28" data-line-number="28">      , ( <span class="st">&quot;leaf&quot;</span>,   leaf <span class="ch">&#39;a&#39;</span> )</a>
<a class="sourceLine" id="cb36-29" data-line-number="29">      ]</a>
<a class="sourceLine" id="cb36-30" data-line-number="30">    ]</a></code></pre></div>
<p>Concatenation is associative:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb37-1" data-line-number="1">prop_FingerTree_Monoid_associative</a>
<a class="sourceLine" id="cb37-2" data-line-number="2">   , cprop_FingerTree_Monoid_associative</a>
<a class="sourceLine" id="cb37-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb37-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb37-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb37-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb37-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb37-8" data-line-number="8"></a>
<a class="sourceLine" id="cb37-9" data-line-number="9">prop_FingerTree_Monoid_associative _ _ a b c <span class="fu">=</span></a>
<a class="sourceLine" id="cb37-10" data-line-number="10">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb37-11" data-line-number="11">    (a <span class="fu">&lt;&gt;</span> (b <span class="fu">&lt;&gt;</span> c)) <span class="fu">==</span> ((a <span class="fu">&lt;&gt;</span> b) <span class="fu">&lt;&gt;</span> c)</a>
<a class="sourceLine" id="cb37-12" data-line-number="12"></a>
<a class="sourceLine" id="cb37-13" data-line-number="13">cprop_FingerTree_Monoid_associative pa pm a b c <span class="fu">=</span></a>
<a class="sourceLine" id="cb37-14" data-line-number="14">  checkPairDepth a b <span class="fu">$</span></a>
<a class="sourceLine" id="cb37-15" data-line-number="15">  prop_FingerTree_Monoid_associative pa pm a b c</a>
<a class="sourceLine" id="cb37-16" data-line-number="16"></a>
<a class="sourceLine" id="cb37-17" data-line-number="17"><span class="ot">test_FingerTree_Monoid_associative ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb37-18" data-line-number="18">test_FingerTree_Monoid_associative <span class="fu">=</span></a>
<a class="sourceLine" id="cb37-19" data-line-number="19">  testGroup <span class="st">&quot;(a &lt;&gt; b) &lt;&gt; c == a &lt;&gt; (b &lt;&gt; c)&quot;</span></a>
<a class="sourceLine" id="cb37-20" data-line-number="20">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb37-21" data-line-number="21">        cprop_FingerTree_Monoid_associative pChar pCount</a>
<a class="sourceLine" id="cb37-22" data-line-number="22"></a>
<a class="sourceLine" id="cb37-23" data-line-number="23">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb37-24" data-line-number="24">        cprop_FingerTree_Monoid_associative pBool pTup</a>
<a class="sourceLine" id="cb37-25" data-line-number="25">    ]</a></code></pre></div>
<h2 id="tolist-is-a-monoid-homomorphism">toList is a monoid homomorphism</h2>
<p>We have two monoids, lists and finger trees, and a function <code>toList</code> between them. When this happens it’s natural to ask if the function preserves the monoid structure – and indeed it does.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="ot">test_FingerTree_toList_homomorphism ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb38-2" data-line-number="2">test_FingerTree_toList_homomorphism <span class="fu">=</span></a>
<a class="sourceLine" id="cb38-3" data-line-number="3">  testGroup <span class="st">&quot;toList is a monoid hom&quot;</span></a>
<a class="sourceLine" id="cb38-4" data-line-number="4">    [ test_FingerTree_toList_hom_identity</a>
<a class="sourceLine" id="cb38-5" data-line-number="5">    , test_FingerTree_toList_hom_product</a>
<a class="sourceLine" id="cb38-6" data-line-number="6">    , test_FingerTree_toList_hom_cons</a>
<a class="sourceLine" id="cb38-7" data-line-number="7">    , test_FingerTree_toList_hom_snoc</a>
<a class="sourceLine" id="cb38-8" data-line-number="8">    ]</a></code></pre></div>
<p><code>toList</code> preserves the identity:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb39-1" data-line-number="1">prop_FingerTree_toList_hom_identity</a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb39-3" data-line-number="3">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb39-4" data-line-number="4">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb39-5" data-line-number="5">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb39-6" data-line-number="6">prop_FingerTree_toList_hom_identity _ _ <span class="fu">=</span></a>
<a class="sourceLine" id="cb39-7" data-line-number="7">  <span class="kw">let</span> x <span class="fu">=</span><span class="ot"> mempty ::</span> <span class="dt">FingerTree</span> m a <span class="kw">in</span></a>
<a class="sourceLine" id="cb39-8" data-line-number="8">  property <span class="fu">$</span> (toList x) <span class="fu">==</span> []</a>
<a class="sourceLine" id="cb39-9" data-line-number="9"></a>
<a class="sourceLine" id="cb39-10" data-line-number="10"><span class="ot">test_FingerTree_toList_hom_identity ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb39-11" data-line-number="11">test_FingerTree_toList_hom_identity <span class="fu">=</span></a>
<a class="sourceLine" id="cb39-12" data-line-number="12">  testGroup <span class="st">&quot;toList mempty == mempty&quot;</span></a>
<a class="sourceLine" id="cb39-13" data-line-number="13">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb39-14" data-line-number="14">        prop_FingerTree_toList_hom_identity pChar pCount</a>
<a class="sourceLine" id="cb39-15" data-line-number="15"></a>
<a class="sourceLine" id="cb39-16" data-line-number="16">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb39-17" data-line-number="17">        prop_FingerTree_toList_hom_identity pBool pTup</a>
<a class="sourceLine" id="cb39-18" data-line-number="18">    ]</a></code></pre></div>
<p><code>toList</code> preserves products:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb40-1" data-line-number="1">prop_FingerTree_toList_hom_product</a>
<a class="sourceLine" id="cb40-2" data-line-number="2">   , cprop_FingerTree_toList_hom_product</a>
<a class="sourceLine" id="cb40-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb40-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb40-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb40-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb40-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb40-8" data-line-number="8"></a>
<a class="sourceLine" id="cb40-9" data-line-number="9">prop_FingerTree_toList_hom_product _ _ xs ys <span class="fu">=</span></a>
<a class="sourceLine" id="cb40-10" data-line-number="10">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb40-11" data-line-number="11">    (toList <span class="fu">$</span> xs <span class="fu">&lt;&gt;</span> ys)</a>
<a class="sourceLine" id="cb40-12" data-line-number="12">      <span class="fu">==</span> (toList xs <span class="fu">++</span> toList ys)</a>
<a class="sourceLine" id="cb40-13" data-line-number="13"></a>
<a class="sourceLine" id="cb40-14" data-line-number="14">cprop_FingerTree_toList_hom_product pa pm xs ys <span class="fu">=</span></a>
<a class="sourceLine" id="cb40-15" data-line-number="15">  cover <span class="dv">50</span> ((notEmptyFT xs) <span class="fu">&amp;&amp;</span> (notEmptyFT ys))</a>
<a class="sourceLine" id="cb40-16" data-line-number="16">    <span class="st">&quot;xs, ys nonempty&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb40-17" data-line-number="17">  checkPairDepth xs ys <span class="fu">$</span></a>
<a class="sourceLine" id="cb40-18" data-line-number="18">  prop_FingerTree_toList_hom_product pa pm xs ys</a>
<a class="sourceLine" id="cb40-19" data-line-number="19"></a>
<a class="sourceLine" id="cb40-20" data-line-number="20"><span class="ot">test_FingerTree_toList_hom_product ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb40-21" data-line-number="21">test_FingerTree_toList_hom_product <span class="fu">=</span></a>
<a class="sourceLine" id="cb40-22" data-line-number="22">  testGroup <span class="st">&quot;toList (a &lt;&gt; b) == toList a &lt;&gt; toList b&quot;</span></a>
<a class="sourceLine" id="cb40-23" data-line-number="23">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb40-24" data-line-number="24">        cprop_FingerTree_toList_hom_product pChar pCount</a>
<a class="sourceLine" id="cb40-25" data-line-number="25">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb40-26" data-line-number="26">        cprop_FingerTree_toList_hom_product pBool pTup</a>
<a class="sourceLine" id="cb40-27" data-line-number="27"></a>
<a class="sourceLine" id="cb40-28" data-line-number="28">    , testCases</a>
<a class="sourceLine" id="cb40-29" data-line-number="29">      (uncurry <span class="fu">$</span> prop_FingerTree_toList_hom_product pChar pCount)</a>
<a class="sourceLine" id="cb40-30" data-line-number="30">      [ ( <span class="st">&quot;both empty&quot;</span>, (mempty, mempty) )</a>
<a class="sourceLine" id="cb40-31" data-line-number="31">      ]</a>
<a class="sourceLine" id="cb40-32" data-line-number="32">    ]</a></code></pre></div>
<p>In fact both lists and finger trees are a bit more than just monoids – they are monoids being acted on by a set from the left and the right. This is <code>cons</code> and <code>snoc</code>. We can verify that <code>toList</code> preserves these actions as well. First for <code>cons</code>:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb41-1" data-line-number="1">prop_FingerTree_toList_hom_cons</a>
<a class="sourceLine" id="cb41-2" data-line-number="2">   , cprop_FingerTree_toList_hom_cons</a>
<a class="sourceLine" id="cb41-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb41-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb41-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb41-6" data-line-number="6">  <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb41-7" data-line-number="7"></a>
<a class="sourceLine" id="cb41-8" data-line-number="8">prop_FingerTree_toList_hom_cons _ _ a xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb41-9" data-line-number="9">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb41-10" data-line-number="10">    (toList <span class="fu">$</span> cons a xs) <span class="fu">==</span> (a <span class="fu">:</span> toList xs)</a>
<a class="sourceLine" id="cb41-11" data-line-number="11"></a>
<a class="sourceLine" id="cb41-12" data-line-number="12">cprop_FingerTree_toList_hom_cons pa pm a xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb41-13" data-line-number="13">  checkOneDepth xs <span class="fu">$</span></a>
<a class="sourceLine" id="cb41-14" data-line-number="14">  prop_FingerTree_toList_hom_cons pa pm a xs</a>
<a class="sourceLine" id="cb41-15" data-line-number="15"></a>
<a class="sourceLine" id="cb41-16" data-line-number="16"><span class="ot">test_FingerTree_toList_hom_cons ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb41-17" data-line-number="17">test_FingerTree_toList_hom_cons <span class="fu">=</span></a>
<a class="sourceLine" id="cb41-18" data-line-number="18">  testGroup <span class="st">&quot;toList preserves cons&quot;</span></a>
<a class="sourceLine" id="cb41-19" data-line-number="19">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb41-20" data-line-number="20">        cprop_FingerTree_toList_hom_cons pChar pCount</a>
<a class="sourceLine" id="cb41-21" data-line-number="21">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb41-22" data-line-number="22">        cprop_FingerTree_toList_hom_cons pBool pTup</a>
<a class="sourceLine" id="cb41-23" data-line-number="23"></a>
<a class="sourceLine" id="cb41-24" data-line-number="24">    , testCases</a>
<a class="sourceLine" id="cb41-25" data-line-number="25">      (uncurry <span class="fu">$</span> prop_FingerTree_toList_hom_cons pChar pCount)</a>
<a class="sourceLine" id="cb41-26" data-line-number="26">      [ ( <span class="st">&quot;mempty&quot;</span>, ( <span class="ch">&#39;a&#39;</span>, mempty ) )</a>
<a class="sourceLine" id="cb41-27" data-line-number="27">      , ( <span class="st">&quot;leaf&quot;</span>,   ( <span class="ch">&#39;a&#39;</span>, leaf <span class="ch">&#39;b&#39;</span> ) )</a>
<a class="sourceLine" id="cb41-28" data-line-number="28">      ]</a>
<a class="sourceLine" id="cb41-29" data-line-number="29">    ]</a></code></pre></div>
<p>And then for <code>snoc</code>:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb42-1" data-line-number="1">prop_FingerTree_toList_hom_snoc</a>
<a class="sourceLine" id="cb42-2" data-line-number="2">   , cprop_FingerTree_toList_hom_snoc</a>
<a class="sourceLine" id="cb42-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb42-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb42-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb42-6" data-line-number="6">  <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a <span class="ot">-&gt;</span> <span class="dt">Property</span></a></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb43-1" data-line-number="1">prop_FingerTree_toList_hom_snoc _ _ a xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb43-2" data-line-number="2">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb43-3" data-line-number="3">    (toList <span class="fu">$</span> snoc a xs) <span class="fu">==</span> (toList xs <span class="fu">++</span> [a])</a>
<a class="sourceLine" id="cb43-4" data-line-number="4"></a>
<a class="sourceLine" id="cb43-5" data-line-number="5">cprop_FingerTree_toList_hom_snoc pa pm a xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb43-6" data-line-number="6">  checkOneDepth xs <span class="fu">$</span></a>
<a class="sourceLine" id="cb43-7" data-line-number="7">  prop_FingerTree_toList_hom_snoc pa pm a xs</a>
<a class="sourceLine" id="cb43-8" data-line-number="8"></a>
<a class="sourceLine" id="cb43-9" data-line-number="9"><span class="ot">test_FingerTree_toList_hom_snoc ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb43-10" data-line-number="10">test_FingerTree_toList_hom_snoc <span class="fu">=</span></a>
<a class="sourceLine" id="cb43-11" data-line-number="11">  testGroup <span class="st">&quot;toList preserves snoc&quot;</span></a>
<a class="sourceLine" id="cb43-12" data-line-number="12">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb43-13" data-line-number="13">        cprop_FingerTree_toList_hom_snoc pChar pCount</a>
<a class="sourceLine" id="cb43-14" data-line-number="14">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb43-15" data-line-number="15">        cprop_FingerTree_toList_hom_snoc pBool pTup</a>
<a class="sourceLine" id="cb43-16" data-line-number="16"></a>
<a class="sourceLine" id="cb43-17" data-line-number="17">    , testCases</a>
<a class="sourceLine" id="cb43-18" data-line-number="18">      (uncurry <span class="fu">$</span> prop_FingerTree_toList_hom_snoc pChar pCount)</a>
<a class="sourceLine" id="cb43-19" data-line-number="19">      [ ( <span class="st">&quot;mempty&quot;</span>, ( <span class="ch">&#39;a&#39;</span>, mempty ) )</a>
<a class="sourceLine" id="cb43-20" data-line-number="20">      , ( <span class="st">&quot;leaf&quot;</span>,   ( <span class="ch">&#39;a&#39;</span>, leaf <span class="ch">&#39;b&#39;</span> ) )</a>
<a class="sourceLine" id="cb43-21" data-line-number="21">      ]</a>
<a class="sourceLine" id="cb43-22" data-line-number="22">    ]</a></code></pre></div>
<h2 id="fromlist-is-a-monoid-homomorphism">fromList is a monoid homomorphism</h2>
<p>Like <code>toList</code>, <code>fromList</code> is also a monoid (and set action) homomorphism.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="ot">test_FingerTree_fromList_homomorphism ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb44-2" data-line-number="2">test_FingerTree_fromList_homomorphism <span class="fu">=</span></a>
<a class="sourceLine" id="cb44-3" data-line-number="3">  testGroup <span class="st">&quot;fromList is a monoid hom&quot;</span></a>
<a class="sourceLine" id="cb44-4" data-line-number="4">    [ test_FingerTree_fromList_hom_identity</a>
<a class="sourceLine" id="cb44-5" data-line-number="5">    , test_FingerTree_fromList_hom_product</a>
<a class="sourceLine" id="cb44-6" data-line-number="6">    , test_FingerTree_fromList_hom_cons</a>
<a class="sourceLine" id="cb44-7" data-line-number="7">    , test_FingerTree_fromList_hom_snoc</a>
<a class="sourceLine" id="cb44-8" data-line-number="8">    ]</a></code></pre></div>
<p><code>fromList</code> preserves the identity:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb45-1" data-line-number="1">prop_FingerTree_fromList_hom_identity</a>
<a class="sourceLine" id="cb45-2" data-line-number="2"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb45-3" data-line-number="3">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb45-4" data-line-number="4">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb45-5" data-line-number="5">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb45-6" data-line-number="6"></a>
<a class="sourceLine" id="cb45-7" data-line-number="7">prop_FingerTree_fromList_hom_identity _ _ <span class="fu">=</span></a>
<a class="sourceLine" id="cb45-8" data-line-number="8">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb45-9" data-line-number="9">    <span class="kw">let</span> x <span class="fu">=</span> fromListFT []<span class="ot"> ::</span> <span class="dt">FingerTree</span> m a <span class="kw">in</span></a>
<a class="sourceLine" id="cb45-10" data-line-number="10">    x <span class="fu">==</span> mempty</a>
<a class="sourceLine" id="cb45-11" data-line-number="11"></a>
<a class="sourceLine" id="cb45-12" data-line-number="12"><span class="ot">test_FingerTree_fromList_hom_identity ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb45-13" data-line-number="13">test_FingerTree_fromList_hom_identity <span class="fu">=</span></a>
<a class="sourceLine" id="cb45-14" data-line-number="14">  testGroup <span class="st">&quot;fromList mempty == mempty&quot;</span></a>
<a class="sourceLine" id="cb45-15" data-line-number="15">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb45-16" data-line-number="16">        prop_FingerTree_fromList_hom_identity pChar pCount</a>
<a class="sourceLine" id="cb45-17" data-line-number="17">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb45-18" data-line-number="18">        prop_FingerTree_fromList_hom_identity pBool pTup</a>
<a class="sourceLine" id="cb45-19" data-line-number="19">    ]</a></code></pre></div>
<p>And it preserves products:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb46-1" data-line-number="1">prop_FingerTree_fromList_hom_product</a>
<a class="sourceLine" id="cb46-2" data-line-number="2"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb46-3" data-line-number="3">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb46-4" data-line-number="4">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb46-5" data-line-number="5">  <span class="ot">-&gt;</span> [a] <span class="ot">-&gt;</span> [a]</a>
<a class="sourceLine" id="cb46-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb46-7" data-line-number="7"></a>
<a class="sourceLine" id="cb46-8" data-line-number="8">prop_FingerTree_fromList_hom_product _ _ xs ys <span class="fu">=</span></a>
<a class="sourceLine" id="cb46-9" data-line-number="9">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb46-10" data-line-number="10">    <span class="kw">let</span> zs <span class="fu">=</span> fromListFT (xs <span class="fu">++</span> ys)<span class="ot"> ::</span> <span class="dt">FingerTree</span> m a <span class="kw">in</span></a>
<a class="sourceLine" id="cb46-11" data-line-number="11">    zs <span class="fu">==</span> (fromListFT xs) <span class="fu">&lt;&gt;</span> (fromListFT ys)</a>
<a class="sourceLine" id="cb46-12" data-line-number="12"></a>
<a class="sourceLine" id="cb46-13" data-line-number="13">cprop_FingerTree_fromList_hom_product pa pm xs ys <span class="fu">=</span></a>
<a class="sourceLine" id="cb46-14" data-line-number="14">  cover <span class="dv">20</span> ((length xs <span class="fu">&gt;</span> <span class="dv">5</span>) <span class="fu">&amp;&amp;</span> (length ys <span class="fu">&gt;</span> <span class="dv">5</span>)) <span class="st">&quot;length xs,ys &gt; 5&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb46-15" data-line-number="15">  cover <span class="dv">1</span> ((xs <span class="fu">==</span> []) <span class="fu">&amp;&amp;</span> (ys <span class="fu">==</span> [])) <span class="st">&quot;both nonempty&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb46-16" data-line-number="16">  prop_FingerTree_fromList_hom_product pa pm xs ys</a>
<a class="sourceLine" id="cb46-17" data-line-number="17"></a>
<a class="sourceLine" id="cb46-18" data-line-number="18"><span class="ot">test_FingerTree_fromList_hom_product ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb46-19" data-line-number="19">test_FingerTree_fromList_hom_product <span class="fu">=</span></a>
<a class="sourceLine" id="cb46-20" data-line-number="20">  testGroup <span class="st">&quot;fromList (xs &lt;&gt; ys) == fromList xs &lt;&gt; fromList ys&quot;</span></a>
<a class="sourceLine" id="cb46-21" data-line-number="21">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb46-22" data-line-number="22">        cprop_FingerTree_fromList_hom_product pChar pCount</a>
<a class="sourceLine" id="cb46-23" data-line-number="23">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb46-24" data-line-number="24">        cprop_FingerTree_fromList_hom_product pBool pTup</a>
<a class="sourceLine" id="cb46-25" data-line-number="25"></a>
<a class="sourceLine" id="cb46-26" data-line-number="26">    , testCases</a>
<a class="sourceLine" id="cb46-27" data-line-number="27">      (uncurry <span class="fu">$</span> prop_FingerTree_fromList_hom_product pChar pCount)</a>
<a class="sourceLine" id="cb46-28" data-line-number="28">      [ ( <span class="st">&quot;empty&quot;</span>,     ([], []) )</a>
<a class="sourceLine" id="cb46-29" data-line-number="29">      , ( <span class="st">&quot;singleton&quot;</span>, ([<span class="ch">&#39;a&#39;</span>], [<span class="ch">&#39;b&#39;</span>]) )</a>
<a class="sourceLine" id="cb46-30" data-line-number="30">      ]</a>
<a class="sourceLine" id="cb46-31" data-line-number="31">    ]</a></code></pre></div>
<p><code>fromList</code> preserves <code>cons</code>:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb47-1" data-line-number="1">prop_FingerTree_fromList_hom_cons</a>
<a class="sourceLine" id="cb47-2" data-line-number="2">   , cprop_FingerTree_fromList_hom_cons</a>
<a class="sourceLine" id="cb47-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb47-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb47-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb47-6" data-line-number="6">  <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> [a]</a>
<a class="sourceLine" id="cb47-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb47-8" data-line-number="8"></a>
<a class="sourceLine" id="cb47-9" data-line-number="9">prop_FingerTree_fromList_hom_cons _ _ a xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb47-10" data-line-number="10">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb47-11" data-line-number="11">    <span class="kw">let</span> zs <span class="fu">=</span> fromListFT<span class="ot"> xs ::</span> <span class="dt">FingerTree</span> m a <span class="kw">in</span></a>
<a class="sourceLine" id="cb47-12" data-line-number="12">    (fromListFT <span class="fu">$</span> a <span class="fu">:</span> xs) <span class="fu">==</span> (cons a zs)</a>
<a class="sourceLine" id="cb47-13" data-line-number="13"></a>
<a class="sourceLine" id="cb47-14" data-line-number="14">cprop_FingerTree_fromList_hom_cons pa pm a xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb47-15" data-line-number="15">  cover <span class="dv">40</span> (length xs <span class="fu">&gt;</span> <span class="dv">5</span>) <span class="st">&quot;length xs &gt; 5&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb47-16" data-line-number="16">  cover <span class="dv">1</span> (xs <span class="fu">==</span> []) <span class="st">&quot;xs empty&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb47-17" data-line-number="17">  prop_FingerTree_fromList_hom_cons pa pm a xs</a>
<a class="sourceLine" id="cb47-18" data-line-number="18"></a>
<a class="sourceLine" id="cb47-19" data-line-number="19"><span class="ot">test_FingerTree_fromList_hom_cons ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb47-20" data-line-number="20">test_FingerTree_fromList_hom_cons <span class="fu">=</span></a>
<a class="sourceLine" id="cb47-21" data-line-number="21">  testGroup <span class="st">&quot;fromList (a : xs) == cons a (fromList xs)&quot;</span></a>
<a class="sourceLine" id="cb47-22" data-line-number="22">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb47-23" data-line-number="23">        cprop_FingerTree_fromList_hom_cons pChar pCount</a>
<a class="sourceLine" id="cb47-24" data-line-number="24">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb47-25" data-line-number="25">        cprop_FingerTree_fromList_hom_cons pBool pTup</a>
<a class="sourceLine" id="cb47-26" data-line-number="26"></a>
<a class="sourceLine" id="cb47-27" data-line-number="27">    , testCases</a>
<a class="sourceLine" id="cb47-28" data-line-number="28">      (uncurry <span class="fu">$</span> prop_FingerTree_fromList_hom_cons pChar pCount)</a>
<a class="sourceLine" id="cb47-29" data-line-number="29">      [ ( <span class="st">&quot;mempty&quot;</span>,    (<span class="ch">&#39;a&#39;</span>, []) )</a>
<a class="sourceLine" id="cb47-30" data-line-number="30">      , ( <span class="st">&quot;singleton&quot;</span>, (<span class="ch">&#39;a&#39;</span>, [<span class="ch">&#39;b&#39;</span>]) )</a>
<a class="sourceLine" id="cb47-31" data-line-number="31">      ]</a>
<a class="sourceLine" id="cb47-32" data-line-number="32">    ]</a></code></pre></div>
<p>And <code>fromList</code> preserves <code>snoc</code>:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb48-1" data-line-number="1">prop_FingerTree_fromList_hom_snoc</a>
<a class="sourceLine" id="cb48-2" data-line-number="2"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb48-3" data-line-number="3">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb48-4" data-line-number="4">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb48-5" data-line-number="5">  <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> [a]</a>
<a class="sourceLine" id="cb48-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb48-7" data-line-number="7"></a>
<a class="sourceLine" id="cb48-8" data-line-number="8">prop_FingerTree_fromList_hom_snoc _ _ a xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb48-9" data-line-number="9">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb48-10" data-line-number="10">    <span class="kw">let</span> zs <span class="fu">=</span> fromListFT<span class="ot"> xs ::</span> <span class="dt">FingerTree</span> m a <span class="kw">in</span></a>
<a class="sourceLine" id="cb48-11" data-line-number="11">    (fromListFT <span class="fu">$</span> xs <span class="fu">++</span> [a]) <span class="fu">==</span> (snoc a zs)</a>
<a class="sourceLine" id="cb48-12" data-line-number="12"></a>
<a class="sourceLine" id="cb48-13" data-line-number="13">cprop_FingerTree_fromList_hom_snoc pa pm a xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb48-14" data-line-number="14">  cover <span class="dv">40</span> (length xs <span class="fu">&gt;</span> <span class="dv">5</span>) <span class="st">&quot;length xs &gt; 5&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb48-15" data-line-number="15">  cover <span class="dv">1</span> (xs <span class="fu">==</span> []) <span class="st">&quot;xs empty&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb48-16" data-line-number="16">  prop_FingerTree_fromList_hom_snoc pa pm a xs</a>
<a class="sourceLine" id="cb48-17" data-line-number="17"></a>
<a class="sourceLine" id="cb48-18" data-line-number="18"><span class="ot">test_FingerTree_fromList_hom_snoc ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb48-19" data-line-number="19">test_FingerTree_fromList_hom_snoc <span class="fu">=</span></a>
<a class="sourceLine" id="cb48-20" data-line-number="20">  testGroup <span class="st">&quot;fromList (a : xs) == snoc a (fromList xs)&quot;</span></a>
<a class="sourceLine" id="cb48-21" data-line-number="21">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb48-22" data-line-number="22">        cprop_FingerTree_fromList_hom_snoc pChar pCount</a>
<a class="sourceLine" id="cb48-23" data-line-number="23">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb48-24" data-line-number="24">        cprop_FingerTree_fromList_hom_snoc pBool pTup</a>
<a class="sourceLine" id="cb48-25" data-line-number="25"></a>
<a class="sourceLine" id="cb48-26" data-line-number="26">    , testCases</a>
<a class="sourceLine" id="cb48-27" data-line-number="27">      (uncurry <span class="fu">$</span> prop_FingerTree_fromList_hom_snoc pChar pCount)</a>
<a class="sourceLine" id="cb48-28" data-line-number="28">      [ ( <span class="st">&quot;mempty&quot;</span>,    (<span class="ch">&#39;a&#39;</span>, []) )</a>
<a class="sourceLine" id="cb48-29" data-line-number="29">      , ( <span class="st">&quot;singleton&quot;</span>, (<span class="ch">&#39;a&#39;</span>, [<span class="ch">&#39;b&#39;</span>]) )</a>
<a class="sourceLine" id="cb48-30" data-line-number="30">      ]</a>
<a class="sourceLine" id="cb48-31" data-line-number="31">    ]</a></code></pre></div>
<h2 id="reverse-is-a-monoid-involution">Reverse is a monoid involution</h2>
<p><code>reverseFT</code> is also <em>almost</em> a homomorphism; it’s an antihomomorphism.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="ot">test_FingerTree_reverse ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb49-2" data-line-number="2">test_FingerTree_reverse <span class="fu">=</span></a>
<a class="sourceLine" id="cb49-3" data-line-number="3">  testGroup <span class="st">&quot;Reverse is a monoid involution&quot;</span></a>
<a class="sourceLine" id="cb49-4" data-line-number="4">    [ test_FingerTree_reverse_involution</a>
<a class="sourceLine" id="cb49-5" data-line-number="5">    , test_FingerTree_reverse_identity</a>
<a class="sourceLine" id="cb49-6" data-line-number="6">    , test_FingerTree_reverse_product</a>
<a class="sourceLine" id="cb49-7" data-line-number="7">    , test_FingerTree_reverse_cons</a>
<a class="sourceLine" id="cb49-8" data-line-number="8">    , test_FingerTree_reverse_snoc</a>
<a class="sourceLine" id="cb49-9" data-line-number="9">    ]</a></code></pre></div>
<p><code>reverse</code> is an involution:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb50-1" data-line-number="1">prop_FingerTree_reverse_involution</a>
<a class="sourceLine" id="cb50-2" data-line-number="2">   , cprop_FingerTree_reverse_involution</a>
<a class="sourceLine" id="cb50-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb50-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb50-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb50-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb50-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb50-8" data-line-number="8"></a>
<a class="sourceLine" id="cb50-9" data-line-number="9">prop_FingerTree_reverse_involution _ _ xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb50-10" data-line-number="10">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb50-11" data-line-number="11">    xs <span class="fu">==</span> (reverseFT (reverseFT xs))</a>
<a class="sourceLine" id="cb50-12" data-line-number="12"></a>
<a class="sourceLine" id="cb50-13" data-line-number="13">cprop_FingerTree_reverse_involution pa pm xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb50-14" data-line-number="14">  checkOneDepth xs <span class="fu">$</span></a>
<a class="sourceLine" id="cb50-15" data-line-number="15">  prop_FingerTree_reverse_involution pa pm xs</a>
<a class="sourceLine" id="cb50-16" data-line-number="16"></a>
<a class="sourceLine" id="cb50-17" data-line-number="17"><span class="ot">test_FingerTree_reverse_involution ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb50-18" data-line-number="18">test_FingerTree_reverse_involution <span class="fu">=</span></a>
<a class="sourceLine" id="cb50-19" data-line-number="19">  testGroup <span class="st">&quot;reverse . reverse == id&quot;</span></a>
<a class="sourceLine" id="cb50-20" data-line-number="20">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb50-21" data-line-number="21">        cprop_FingerTree_reverse_involution pChar pCount</a>
<a class="sourceLine" id="cb50-22" data-line-number="22">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb50-23" data-line-number="23">        cprop_FingerTree_reverse_involution pBool pTup</a>
<a class="sourceLine" id="cb50-24" data-line-number="24"></a>
<a class="sourceLine" id="cb50-25" data-line-number="25">    , testCases</a>
<a class="sourceLine" id="cb50-26" data-line-number="26">      (prop_FingerTree_reverse_involution pChar pCount)</a>
<a class="sourceLine" id="cb50-27" data-line-number="27">      [ ( <span class="st">&quot;mempty&quot;</span>, mempty )</a>
<a class="sourceLine" id="cb50-28" data-line-number="28">      , ( <span class="st">&quot;leaf&quot;</span>,   leaf <span class="ch">&#39;a&#39;</span> )</a>
<a class="sourceLine" id="cb50-29" data-line-number="29">      ]</a>
<a class="sourceLine" id="cb50-30" data-line-number="30">    ]</a></code></pre></div>
<p><code>reverse</code> preserves the identity:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb51-1" data-line-number="1">prop_FingerTree_reverse_identity</a>
<a class="sourceLine" id="cb51-2" data-line-number="2"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb51-3" data-line-number="3">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb51-4" data-line-number="4">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb51-5" data-line-number="5">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb51-6" data-line-number="6"></a>
<a class="sourceLine" id="cb51-7" data-line-number="7">prop_FingerTree_reverse_identity _ _ <span class="fu">=</span></a>
<a class="sourceLine" id="cb51-8" data-line-number="8">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb51-9" data-line-number="9">    (mempty<span class="ot"> ::</span> <span class="dt">FingerTree</span> m a)</a>
<a class="sourceLine" id="cb51-10" data-line-number="10">      <span class="fu">==</span> reverseFT mempty</a>
<a class="sourceLine" id="cb51-11" data-line-number="11"></a>
<a class="sourceLine" id="cb51-12" data-line-number="12"><span class="ot">test_FingerTree_reverse_identity ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb51-13" data-line-number="13">test_FingerTree_reverse_identity <span class="fu">=</span></a>
<a class="sourceLine" id="cb51-14" data-line-number="14">  testGroup <span class="st">&quot;reverse mempty == mempty&quot;</span></a>
<a class="sourceLine" id="cb51-15" data-line-number="15">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb51-16" data-line-number="16">        prop_FingerTree_reverse_identity pChar pCount</a>
<a class="sourceLine" id="cb51-17" data-line-number="17">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb51-18" data-line-number="18">        prop_FingerTree_reverse_identity pBool pTup</a>
<a class="sourceLine" id="cb51-19" data-line-number="19">    ]</a></code></pre></div>
<p><code>reverse</code> antipreserves products:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb52-1" data-line-number="1">prop_FingerTree_reverse_product</a>
<a class="sourceLine" id="cb52-2" data-line-number="2">   , cprop_FingerTree_reverse_product</a>
<a class="sourceLine" id="cb52-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb52-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb52-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb52-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb52-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb52-8" data-line-number="8"></a>
<a class="sourceLine" id="cb52-9" data-line-number="9">prop_FingerTree_reverse_product _ _ xs ys <span class="fu">=</span></a>
<a class="sourceLine" id="cb52-10" data-line-number="10">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb52-11" data-line-number="11">    (reverseFT (xs <span class="fu">&lt;&gt;</span> ys))</a>
<a class="sourceLine" id="cb52-12" data-line-number="12">      <span class="fu">==</span> ((reverseFT ys) <span class="fu">&lt;&gt;</span> (reverseFT xs))</a>
<a class="sourceLine" id="cb52-13" data-line-number="13"></a>
<a class="sourceLine" id="cb52-14" data-line-number="14">cprop_FingerTree_reverse_product pa pm xs ys <span class="fu">=</span></a>
<a class="sourceLine" id="cb52-15" data-line-number="15">  checkPairDepth xs ys <span class="fu">$</span></a>
<a class="sourceLine" id="cb52-16" data-line-number="16">  prop_FingerTree_reverse_product pa pm xs ys</a>
<a class="sourceLine" id="cb52-17" data-line-number="17"></a>
<a class="sourceLine" id="cb52-18" data-line-number="18"><span class="ot">test_FingerTree_reverse_product ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb52-19" data-line-number="19">test_FingerTree_reverse_product <span class="fu">=</span></a>
<a class="sourceLine" id="cb52-20" data-line-number="20">  testGroup <span class="st">&quot;reverse (xs &lt;&gt; ys) == reverse ys &lt;&gt; reverse xs&quot;</span></a>
<a class="sourceLine" id="cb52-21" data-line-number="21">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb52-22" data-line-number="22">        cprop_FingerTree_reverse_product pChar pCount</a>
<a class="sourceLine" id="cb52-23" data-line-number="23">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb52-24" data-line-number="24">        cprop_FingerTree_reverse_product pBool pTup</a>
<a class="sourceLine" id="cb52-25" data-line-number="25"></a>
<a class="sourceLine" id="cb52-26" data-line-number="26">    , testCases</a>
<a class="sourceLine" id="cb52-27" data-line-number="27">      (uncurry <span class="fu">$</span> prop_FingerTree_reverse_product pChar pCount)</a>
<a class="sourceLine" id="cb52-28" data-line-number="28">      [ ( <span class="st">&quot;mempty&quot;</span>, (mempty, mempty) )</a>
<a class="sourceLine" id="cb52-29" data-line-number="29">      , ( <span class="st">&quot;leaf&quot;</span>,   (leaf <span class="ch">&#39;a&#39;</span>, leaf <span class="ch">&#39;b&#39;</span>) )</a>
<a class="sourceLine" id="cb52-30" data-line-number="30">      ]</a>
<a class="sourceLine" id="cb52-31" data-line-number="31">    ]</a></code></pre></div>
<p><code>reverse</code> turns <code>cons</code> into <code>snoc</code>:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb53-1" data-line-number="1">prop_FingerTree_reverse_cons</a>
<a class="sourceLine" id="cb53-2" data-line-number="2">   , cprop_FingerTree_reverse_cons</a>
<a class="sourceLine" id="cb53-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb53-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb53-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb53-6" data-line-number="6">  <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb53-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb53-8" data-line-number="8"></a>
<a class="sourceLine" id="cb53-9" data-line-number="9">prop_FingerTree_reverse_cons _ _ a xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb53-10" data-line-number="10">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb53-11" data-line-number="11">    (reverseFT (cons a xs))</a>
<a class="sourceLine" id="cb53-12" data-line-number="12">      <span class="fu">==</span> (snoc a (reverseFT xs))</a>
<a class="sourceLine" id="cb53-13" data-line-number="13"></a>
<a class="sourceLine" id="cb53-14" data-line-number="14">cprop_FingerTree_reverse_cons pa pm a xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb53-15" data-line-number="15">  checkOneDepth xs <span class="fu">$</span></a>
<a class="sourceLine" id="cb53-16" data-line-number="16">  prop_FingerTree_reverse_cons pa pm a xs</a>
<a class="sourceLine" id="cb53-17" data-line-number="17"></a>
<a class="sourceLine" id="cb53-18" data-line-number="18"><span class="ot">test_FingerTree_reverse_cons ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb53-19" data-line-number="19">test_FingerTree_reverse_cons <span class="fu">=</span></a>
<a class="sourceLine" id="cb53-20" data-line-number="20">  testGroup <span class="st">&quot;reverse (cons a xs) == snoc a (reverse xs)&quot;</span></a>
<a class="sourceLine" id="cb53-21" data-line-number="21">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb53-22" data-line-number="22">        cprop_FingerTree_reverse_cons pChar pCount</a>
<a class="sourceLine" id="cb53-23" data-line-number="23">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb53-24" data-line-number="24">        cprop_FingerTree_reverse_cons pBool pTup</a>
<a class="sourceLine" id="cb53-25" data-line-number="25"></a>
<a class="sourceLine" id="cb53-26" data-line-number="26">    , testCases</a>
<a class="sourceLine" id="cb53-27" data-line-number="27">      (uncurry <span class="fu">$</span> prop_FingerTree_reverse_cons pChar pCount)</a>
<a class="sourceLine" id="cb53-28" data-line-number="28">      [ ( <span class="st">&quot;mempty&quot;</span>, (<span class="ch">&#39;a&#39;</span>, mempty) )</a>
<a class="sourceLine" id="cb53-29" data-line-number="29">      , ( <span class="st">&quot;leaf&quot;</span>,   (<span class="ch">&#39;a&#39;</span>, leaf <span class="ch">&#39;b&#39;</span>) )</a>
<a class="sourceLine" id="cb53-30" data-line-number="30">      ]</a>
<a class="sourceLine" id="cb53-31" data-line-number="31">    ]</a></code></pre></div>
<p>And turns <code>snoc</code> into <code>cons</code>:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb54-1" data-line-number="1">prop_FingerTree_reverse_snoc</a>
<a class="sourceLine" id="cb54-2" data-line-number="2">   , cprop_FingerTree_reverse_snoc</a>
<a class="sourceLine" id="cb54-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb54-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb54-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb54-6" data-line-number="6">  <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb54-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb54-8" data-line-number="8"></a>
<a class="sourceLine" id="cb54-9" data-line-number="9">prop_FingerTree_reverse_snoc _ _ a xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb54-10" data-line-number="10">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb54-11" data-line-number="11">    (reverseFT (snoc a xs))</a>
<a class="sourceLine" id="cb54-12" data-line-number="12">      <span class="fu">==</span> (cons a (reverseFT xs))</a>
<a class="sourceLine" id="cb54-13" data-line-number="13"></a>
<a class="sourceLine" id="cb54-14" data-line-number="14">cprop_FingerTree_reverse_snoc pa pm a xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb54-15" data-line-number="15">  checkOneDepth xs <span class="fu">$</span></a>
<a class="sourceLine" id="cb54-16" data-line-number="16">  prop_FingerTree_reverse_snoc pa pm a xs</a>
<a class="sourceLine" id="cb54-17" data-line-number="17"></a>
<a class="sourceLine" id="cb54-18" data-line-number="18"><span class="ot">test_FingerTree_reverse_snoc ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb54-19" data-line-number="19">test_FingerTree_reverse_snoc <span class="fu">=</span></a>
<a class="sourceLine" id="cb54-20" data-line-number="20">  testGroup <span class="st">&quot;reverse (snoc a xs) == cons a (reverse xs)&quot;</span></a>
<a class="sourceLine" id="cb54-21" data-line-number="21">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb54-22" data-line-number="22">        cprop_FingerTree_reverse_snoc pChar pCount</a>
<a class="sourceLine" id="cb54-23" data-line-number="23">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb54-24" data-line-number="24">        cprop_FingerTree_reverse_snoc pBool pTup</a>
<a class="sourceLine" id="cb54-25" data-line-number="25"></a>
<a class="sourceLine" id="cb54-26" data-line-number="26">    , testCases</a>
<a class="sourceLine" id="cb54-27" data-line-number="27">      (uncurry <span class="fu">$</span> prop_FingerTree_reverse_snoc pChar pCount)</a>
<a class="sourceLine" id="cb54-28" data-line-number="28">      [ ( <span class="st">&quot;mempty&quot;</span>, (<span class="ch">&#39;a&#39;</span>, mempty) )</a>
<a class="sourceLine" id="cb54-29" data-line-number="29">      , ( <span class="st">&quot;leaf&quot;</span>,   (<span class="ch">&#39;a&#39;</span>, leaf <span class="ch">&#39;b&#39;</span>) )</a>
<a class="sourceLine" id="cb54-30" data-line-number="30">      ]</a>
<a class="sourceLine" id="cb54-31" data-line-number="31">    ]</a></code></pre></div>
<h2 id="leaf-is-cons-and-snoc">Leaf is cons and snoc</h2>
<p>This is a grab bag of properties of <code>leaf</code>.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb55-1" data-line-number="1"><span class="ot">test_FingerTree_leaf ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb55-2" data-line-number="2">test_FingerTree_leaf <span class="fu">=</span></a>
<a class="sourceLine" id="cb55-3" data-line-number="3">  testGroup <span class="st">&quot;Leaf properties&quot;</span></a>
<a class="sourceLine" id="cb55-4" data-line-number="4">    [ test_FingerTree_cons_cat_singleton</a>
<a class="sourceLine" id="cb55-5" data-line-number="5">    , test_FingerTree_snoc_cat_singleton</a>
<a class="sourceLine" id="cb55-6" data-line-number="6">    , test_FingerTree_leaf_not_empty</a>
<a class="sourceLine" id="cb55-7" data-line-number="7">    , test_FingerTree_leaf_depth</a>
<a class="sourceLine" id="cb55-8" data-line-number="8">    ]</a></code></pre></div>
<p><code>leaf</code> interacts with <code>cons</code>:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb56-1" data-line-number="1">prop_FingerTree_cons_cat_singleton</a>
<a class="sourceLine" id="cb56-2" data-line-number="2">   , cprop_FingerTree_cons_cat_singleton</a>
<a class="sourceLine" id="cb56-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb56-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb56-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb56-6" data-line-number="6">  <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb56-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb56-8" data-line-number="8"></a>
<a class="sourceLine" id="cb56-9" data-line-number="9">prop_FingerTree_cons_cat_singleton _ _ a xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb56-10" data-line-number="10">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb56-11" data-line-number="11">    (cons a xs) <span class="fu">==</span> ((leaf a) <span class="fu">&lt;&gt;</span> xs)</a>
<a class="sourceLine" id="cb56-12" data-line-number="12"></a>
<a class="sourceLine" id="cb56-13" data-line-number="13">cprop_FingerTree_cons_cat_singleton pa pm a xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb56-14" data-line-number="14">  checkOneDepth xs <span class="fu">$</span></a>
<a class="sourceLine" id="cb56-15" data-line-number="15">  prop_FingerTree_cons_cat_singleton pa pm a xs</a>
<a class="sourceLine" id="cb56-16" data-line-number="16"></a>
<a class="sourceLine" id="cb56-17" data-line-number="17"><span class="ot">test_FingerTree_cons_cat_singleton ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb56-18" data-line-number="18">test_FingerTree_cons_cat_singleton <span class="fu">=</span></a>
<a class="sourceLine" id="cb56-19" data-line-number="19">  testGroup <span class="st">&quot;cons a xs == leaf a &lt;&gt; xs&quot;</span></a>
<a class="sourceLine" id="cb56-20" data-line-number="20">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb56-21" data-line-number="21">        cprop_FingerTree_cons_cat_singleton pChar pCount</a>
<a class="sourceLine" id="cb56-22" data-line-number="22">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb56-23" data-line-number="23">        cprop_FingerTree_cons_cat_singleton pBool pTup</a>
<a class="sourceLine" id="cb56-24" data-line-number="24"></a>
<a class="sourceLine" id="cb56-25" data-line-number="25">    , testCases</a>
<a class="sourceLine" id="cb56-26" data-line-number="26">      (uncurry <span class="fu">$</span> prop_FingerTree_cons_cat_singleton pChar pCount)</a>
<a class="sourceLine" id="cb56-27" data-line-number="27">      [ ( <span class="st">&quot;mempty&quot;</span>, (<span class="ch">&#39;a&#39;</span>, mempty) )</a>
<a class="sourceLine" id="cb56-28" data-line-number="28">      , ( <span class="st">&quot;leaf&quot;</span>,   (<span class="ch">&#39;a&#39;</span>, leaf <span class="ch">&#39;b&#39;</span>) )</a>
<a class="sourceLine" id="cb56-29" data-line-number="29">      ]</a>
<a class="sourceLine" id="cb56-30" data-line-number="30">    ]</a></code></pre></div>
<p>And with <code>snoc</code>:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb57-1" data-line-number="1">prop_FingerTree_snoc_cat_singleton</a>
<a class="sourceLine" id="cb57-2" data-line-number="2">   , cprop_FingerTree_snoc_cat_singleton</a>
<a class="sourceLine" id="cb57-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb57-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb57-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb57-6" data-line-number="6">  <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb57-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb57-8" data-line-number="8"></a>
<a class="sourceLine" id="cb57-9" data-line-number="9">prop_FingerTree_snoc_cat_singleton _ _ a xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb57-10" data-line-number="10">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb57-11" data-line-number="11">    (snoc a xs) <span class="fu">==</span> (xs <span class="fu">&lt;&gt;</span> (leaf a))</a>
<a class="sourceLine" id="cb57-12" data-line-number="12"></a>
<a class="sourceLine" id="cb57-13" data-line-number="13">cprop_FingerTree_snoc_cat_singleton pa pm a xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb57-14" data-line-number="14">  checkOneDepth xs <span class="fu">$</span></a>
<a class="sourceLine" id="cb57-15" data-line-number="15">  prop_FingerTree_snoc_cat_singleton pa pm a xs</a>
<a class="sourceLine" id="cb57-16" data-line-number="16"></a>
<a class="sourceLine" id="cb57-17" data-line-number="17"><span class="ot">test_FingerTree_snoc_cat_singleton ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb57-18" data-line-number="18">test_FingerTree_snoc_cat_singleton <span class="fu">=</span></a>
<a class="sourceLine" id="cb57-19" data-line-number="19">  testGroup <span class="st">&quot;snoc a xs == leaf a &lt;&gt; xs&quot;</span></a>
<a class="sourceLine" id="cb57-20" data-line-number="20">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb57-21" data-line-number="21">        cprop_FingerTree_snoc_cat_singleton pChar pCount</a>
<a class="sourceLine" id="cb57-22" data-line-number="22">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb57-23" data-line-number="23">        cprop_FingerTree_snoc_cat_singleton pBool pTup</a>
<a class="sourceLine" id="cb57-24" data-line-number="24"></a>
<a class="sourceLine" id="cb57-25" data-line-number="25">    , testCases</a>
<a class="sourceLine" id="cb57-26" data-line-number="26">      (uncurry <span class="fu">$</span> prop_FingerTree_snoc_cat_singleton pChar pCount)</a>
<a class="sourceLine" id="cb57-27" data-line-number="27">      [ ( <span class="st">&quot;mempty&quot;</span>, (<span class="ch">&#39;a&#39;</span>, mempty) )</a>
<a class="sourceLine" id="cb57-28" data-line-number="28">      , ( <span class="st">&quot;leaf&quot;</span>,   (<span class="ch">&#39;a&#39;</span>, leaf <span class="ch">&#39;b&#39;</span>) )</a>
<a class="sourceLine" id="cb57-29" data-line-number="29">      ]</a>
<a class="sourceLine" id="cb57-30" data-line-number="30">    ]</a></code></pre></div>
<p><code>leaf</code> is not empty:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb58-1" data-line-number="1">prop_FingerTree_leaf_not_empty</a>
<a class="sourceLine" id="cb58-2" data-line-number="2"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb58-3" data-line-number="3">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb58-4" data-line-number="4">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb58-5" data-line-number="5">  <span class="ot">-&gt;</span> a</a>
<a class="sourceLine" id="cb58-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb58-7" data-line-number="7"></a>
<a class="sourceLine" id="cb58-8" data-line-number="8">prop_FingerTree_leaf_not_empty _ _ a <span class="fu">=</span></a>
<a class="sourceLine" id="cb58-9" data-line-number="9">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb58-10" data-line-number="10">    notEmptyFT (leaf<span class="ot"> a ::</span> <span class="dt">FingerTree</span> m a)</a>
<a class="sourceLine" id="cb58-11" data-line-number="11"></a>
<a class="sourceLine" id="cb58-12" data-line-number="12"><span class="ot">test_FingerTree_leaf_not_empty ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb58-13" data-line-number="13">test_FingerTree_leaf_not_empty <span class="fu">=</span></a>
<a class="sourceLine" id="cb58-14" data-line-number="14">  testGroup <span class="st">&quot;notEmpty (leaf x)&quot;</span></a>
<a class="sourceLine" id="cb58-15" data-line-number="15">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb58-16" data-line-number="16">        prop_FingerTree_leaf_not_empty pChar pCount</a>
<a class="sourceLine" id="cb58-17" data-line-number="17">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb58-18" data-line-number="18">        prop_FingerTree_leaf_not_empty pBool pTup</a>
<a class="sourceLine" id="cb58-19" data-line-number="19">    ]</a></code></pre></div>
<p>And <code>leaf</code> has depth 1:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb59-1" data-line-number="1">prop_FingerTree_leaf_depth</a>
<a class="sourceLine" id="cb59-2" data-line-number="2"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb59-3" data-line-number="3">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb59-4" data-line-number="4">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb59-5" data-line-number="5">  <span class="ot">-&gt;</span> a</a>
<a class="sourceLine" id="cb59-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb59-7" data-line-number="7"></a>
<a class="sourceLine" id="cb59-8" data-line-number="8">prop_FingerTree_leaf_depth _ _ a <span class="fu">=</span></a>
<a class="sourceLine" id="cb59-9" data-line-number="9">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb59-10" data-line-number="10">    <span class="kw">let</span> x <span class="fu">=</span> leaf<span class="ot"> a ::</span> <span class="dt">FingerTree</span> m a <span class="kw">in</span></a>
<a class="sourceLine" id="cb59-11" data-line-number="11">    depthFT x <span class="fu">==</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb59-12" data-line-number="12"></a>
<a class="sourceLine" id="cb59-13" data-line-number="13"><span class="ot">test_FingerTree_leaf_depth ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb59-14" data-line-number="14">test_FingerTree_leaf_depth <span class="fu">=</span></a>
<a class="sourceLine" id="cb59-15" data-line-number="15">  testGroup <span class="st">&quot;depth (leaf x) == 1&quot;</span></a>
<a class="sourceLine" id="cb59-16" data-line-number="16">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb59-17" data-line-number="17">        prop_FingerTree_leaf_depth pChar pCount</a>
<a class="sourceLine" id="cb59-18" data-line-number="18">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb59-19" data-line-number="19">        prop_FingerTree_leaf_depth pBool pTup</a>
<a class="sourceLine" id="cb59-20" data-line-number="20">    ]</a></code></pre></div>
<h2 id="splitting-properties">Splitting properties</h2>
<p>The <code>split</code> operation is supposed to satisfy some nice properties, which we can turn into tests.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb60-1" data-line-number="1"><span class="ot">test_FingerTree_split ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb60-2" data-line-number="2">test_FingerTree_split <span class="fu">=</span></a>
<a class="sourceLine" id="cb60-3" data-line-number="3">  testGroup <span class="st">&quot;Splitting properties&quot;</span></a>
<a class="sourceLine" id="cb60-4" data-line-number="4">    [ test_FingerTree_split_concat</a>
<a class="sourceLine" id="cb60-5" data-line-number="5">    , test_FingerTree_split_value_left</a>
<a class="sourceLine" id="cb60-6" data-line-number="6">    , test_FingerTree_split_value_mid</a>
<a class="sourceLine" id="cb60-7" data-line-number="7">    , test_FingerTree_split_example</a>
<a class="sourceLine" id="cb60-8" data-line-number="8">    ]</a></code></pre></div>
<p>If the result of a split succeeds, the results should concatenate to the original finger tree.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb61-1" data-line-number="1">prop_FingerTree_split_concat</a>
<a class="sourceLine" id="cb61-2" data-line-number="2">   , cprop_FingerTree_split_concat</a>
<a class="sourceLine" id="cb61-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb61-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb61-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb61-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">Fun</span> m <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb61-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb61-8" data-line-number="8"></a>
<a class="sourceLine" id="cb61-9" data-line-number="9">prop_FingerTree_split_concat _ _ p xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb61-10" data-line-number="10">  (<span class="dt">False</span> <span class="fu">==</span> applyFun p mempty) <span class="fu">==&gt;</span></a>
<a class="sourceLine" id="cb61-11" data-line-number="11">  (<span class="dt">True</span> <span class="fu">==</span> applyFun p (value xs)) <span class="fu">==&gt;</span></a>
<a class="sourceLine" id="cb61-12" data-line-number="12">  <span class="kw">case</span> splitFT (applyFun p) xs <span class="kw">of</span></a>
<a class="sourceLine" id="cb61-13" data-line-number="13">    <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="dt">False</span></a>
<a class="sourceLine" id="cb61-14" data-line-number="14">    <span class="dt">Just</span> (as, x, bs) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb61-15" data-line-number="15">      xs <span class="fu">==</span> mconcat [ as, leaf x, bs ]</a>
<a class="sourceLine" id="cb61-16" data-line-number="16"></a>
<a class="sourceLine" id="cb61-17" data-line-number="17">cprop_FingerTree_split_concat pa pm p xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb61-18" data-line-number="18">  cover <span class="dv">30</span> (depthFT xs <span class="fu">&gt;</span> <span class="dv">2</span>) <span class="st">&quot;depth xs &gt; 2&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb61-19" data-line-number="19">  cover <span class="dv">5</span> (depthFT xs <span class="fu">==</span> <span class="dv">1</span>) <span class="st">&quot;depth xs == 1&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb61-20" data-line-number="20">  prop_FingerTree_split_concat pa pm p xs</a>
<a class="sourceLine" id="cb61-21" data-line-number="21"></a>
<a class="sourceLine" id="cb61-22" data-line-number="22"><span class="ot">test_FingerTree_split_concat ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb61-23" data-line-number="23">test_FingerTree_split_concat <span class="fu">=</span></a>
<a class="sourceLine" id="cb61-24" data-line-number="24">  testGroup <span class="st">&quot;Split concat property&quot;</span></a>
<a class="sourceLine" id="cb61-25" data-line-number="25">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb61-26" data-line-number="26">        cprop_FingerTree_split_concat pChar pCount</a>
<a class="sourceLine" id="cb61-27" data-line-number="27">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb61-28" data-line-number="28">        cprop_FingerTree_split_concat pBool pTup</a>
<a class="sourceLine" id="cb61-29" data-line-number="29">    ]</a></code></pre></div>
<p>If the split succeeds, the predicate on the value of the left portion should be false.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb62-1" data-line-number="1">prop_FingerTree_split_value_left</a>
<a class="sourceLine" id="cb62-2" data-line-number="2">   , cprop_FingerTree_split_value_left</a>
<a class="sourceLine" id="cb62-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb62-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb62-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb62-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">Fun</span> m <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb62-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb62-8" data-line-number="8"></a>
<a class="sourceLine" id="cb62-9" data-line-number="9">prop_FingerTree_split_value_left _ _ p xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb62-10" data-line-number="10">  (<span class="dt">False</span> <span class="fu">==</span> applyFun p mempty) <span class="fu">==&gt;</span></a>
<a class="sourceLine" id="cb62-11" data-line-number="11">  (<span class="dt">True</span> <span class="fu">==</span> applyFun p (value xs)) <span class="fu">==&gt;</span></a>
<a class="sourceLine" id="cb62-12" data-line-number="12">  <span class="kw">case</span> splitFT (applyFun p) xs <span class="kw">of</span></a>
<a class="sourceLine" id="cb62-13" data-line-number="13">    <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="dt">False</span></a>
<a class="sourceLine" id="cb62-14" data-line-number="14">    <span class="dt">Just</span> (as, x, bs) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb62-15" data-line-number="15">      not <span class="fu">$</span> applyFun p <span class="fu">$</span> value as</a>
<a class="sourceLine" id="cb62-16" data-line-number="16"></a>
<a class="sourceLine" id="cb62-17" data-line-number="17">cprop_FingerTree_split_value_left pa pm p xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb62-18" data-line-number="18">  cover <span class="dv">30</span> (depthFT xs <span class="fu">&gt;</span> <span class="dv">2</span>) <span class="st">&quot;depth xs &gt; 2&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb62-19" data-line-number="19">  cover <span class="dv">5</span> (depthFT xs <span class="fu">==</span> <span class="dv">1</span>) <span class="st">&quot;depth xs == 1&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb62-20" data-line-number="20">  prop_FingerTree_split_value_left pa pm p xs</a>
<a class="sourceLine" id="cb62-21" data-line-number="21"></a>
<a class="sourceLine" id="cb62-22" data-line-number="22"><span class="ot">test_FingerTree_split_value_left ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb62-23" data-line-number="23">test_FingerTree_split_value_left <span class="fu">=</span></a>
<a class="sourceLine" id="cb62-24" data-line-number="24">  testGroup <span class="st">&quot;p (value as) == False&quot;</span></a>
<a class="sourceLine" id="cb62-25" data-line-number="25">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb62-26" data-line-number="26">        cprop_FingerTree_split_value_left pChar pCount</a>
<a class="sourceLine" id="cb62-27" data-line-number="27">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb62-28" data-line-number="28">        cprop_FingerTree_split_value_left pBool pTup</a>
<a class="sourceLine" id="cb62-29" data-line-number="29">    ]</a></code></pre></div>
<p>If the split succeeds, the predicate on the value of the middle portion (with that of the left portion prepended) should be true.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb63-1" data-line-number="1">prop_FingerTree_split_value_mid</a>
<a class="sourceLine" id="cb63-2" data-line-number="2">   , cprop_FingerTree_split_value_mid</a>
<a class="sourceLine" id="cb63-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb63-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb63-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb63-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">Fun</span> m <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb63-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb63-8" data-line-number="8"></a>
<a class="sourceLine" id="cb63-9" data-line-number="9">prop_FingerTree_split_value_mid _ _ p xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb63-10" data-line-number="10">  (<span class="dt">False</span> <span class="fu">==</span> applyFun p mempty) <span class="fu">==&gt;</span></a>
<a class="sourceLine" id="cb63-11" data-line-number="11">  (<span class="dt">True</span> <span class="fu">==</span> applyFun p (value xs)) <span class="fu">==&gt;</span></a>
<a class="sourceLine" id="cb63-12" data-line-number="12">  <span class="kw">case</span> splitFT (applyFun p) xs <span class="kw">of</span></a>
<a class="sourceLine" id="cb63-13" data-line-number="13">    <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="dt">False</span></a>
<a class="sourceLine" id="cb63-14" data-line-number="14">    <span class="dt">Just</span> (as, x, bs) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb63-15" data-line-number="15">      applyFun p (value as <span class="fu">&lt;&gt;</span> value x)</a>
<a class="sourceLine" id="cb63-16" data-line-number="16"></a>
<a class="sourceLine" id="cb63-17" data-line-number="17">cprop_FingerTree_split_value_mid pa pm p xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb63-18" data-line-number="18">  cover <span class="dv">30</span> (depthFT xs <span class="fu">&gt;</span> <span class="dv">2</span>) <span class="st">&quot;depth xs &gt; 2&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb63-19" data-line-number="19">  cover <span class="dv">5</span> (depthFT xs <span class="fu">==</span> <span class="dv">1</span>) <span class="st">&quot;depth xs == 1&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb63-20" data-line-number="20">  prop_FingerTree_split_value_mid pa pm p xs</a>
<a class="sourceLine" id="cb63-21" data-line-number="21"></a>
<a class="sourceLine" id="cb63-22" data-line-number="22"><span class="ot">test_FingerTree_split_value_mid ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb63-23" data-line-number="23">test_FingerTree_split_value_mid <span class="fu">=</span></a>
<a class="sourceLine" id="cb63-24" data-line-number="24">  testGroup <span class="st">&quot;p (value as &lt;&gt; value x) == True&quot;</span></a>
<a class="sourceLine" id="cb63-25" data-line-number="25">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb63-26" data-line-number="26">        cprop_FingerTree_split_value_mid pChar pCount</a>
<a class="sourceLine" id="cb63-27" data-line-number="27">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb63-28" data-line-number="28">        cprop_FingerTree_split_value_mid pBool pTup</a>
<a class="sourceLine" id="cb63-29" data-line-number="29">    ]</a></code></pre></div>
<p>For good measure, we’ll also validate some specific cases to check our understanding of how splitting works.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb64-1" data-line-number="1">prop_FingerTree_split_example</a>
<a class="sourceLine" id="cb64-2" data-line-number="2"><span class="ot">  ::</span> forall m a</a>
<a class="sourceLine" id="cb64-3" data-line-number="3">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a, <span class="dt">Show</span> a )</a>
<a class="sourceLine" id="cb64-4" data-line-number="4">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb64-5" data-line-number="5">  <span class="ot">-&gt;</span> (m <span class="ot">-&gt;</span> <span class="dt">Bool</span>) <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb64-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">Maybe</span> (<span class="dt">FingerTree</span> m a, a, <span class="dt">FingerTree</span> m a)</a>
<a class="sourceLine" id="cb64-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb64-8" data-line-number="8"></a>
<a class="sourceLine" id="cb64-9" data-line-number="9">prop_FingerTree_split_example _ _ p xs y <span class="fu">=</span></a>
<a class="sourceLine" id="cb64-10" data-line-number="10">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb64-11" data-line-number="11">    y <span class="fu">===</span> splitFT p xs</a>
<a class="sourceLine" id="cb64-12" data-line-number="12"></a>
<a class="sourceLine" id="cb64-13" data-line-number="13"><span class="ot">test_FingerTree_split_example ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb64-14" data-line-number="14">test_FingerTree_split_example <span class="fu">=</span></a>
<a class="sourceLine" id="cb64-15" data-line-number="15">  testGroup <span class="st">&quot;split cases&quot;</span></a>
<a class="sourceLine" id="cb64-16" data-line-number="16">    [ testCases</a>
<a class="sourceLine" id="cb64-17" data-line-number="17">      (uncurry3 <span class="fu">$</span> prop_FingerTree_split_example pChar pCount)</a>
<a class="sourceLine" id="cb64-18" data-line-number="18">      [ ( <span class="st">&quot;k &gt; 3&quot;</span></a>
<a class="sourceLine" id="cb64-19" data-line-number="19">        , ( \(<span class="dt">Count</span> k) <span class="ot">-&gt;</span> k <span class="fu">&gt;</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb64-20" data-line-number="20">          , fromListFT [<span class="ch">&#39;a&#39;</span>, <span class="ch">&#39;b&#39;</span>, <span class="ch">&#39;c&#39;</span>, <span class="ch">&#39;d&#39;</span>, <span class="ch">&#39;e&#39;</span>]</a>
<a class="sourceLine" id="cb64-21" data-line-number="21">          , <span class="dt">Just</span> (fromListFT [<span class="ch">&#39;a&#39;</span>, <span class="ch">&#39;b&#39;</span>, <span class="ch">&#39;c&#39;</span>], <span class="ch">&#39;d&#39;</span>, fromListFT [<span class="ch">&#39;e&#39;</span>])</a>
<a class="sourceLine" id="cb64-22" data-line-number="22">          )</a>
<a class="sourceLine" id="cb64-23" data-line-number="23">        )</a>
<a class="sourceLine" id="cb64-24" data-line-number="24"></a>
<a class="sourceLine" id="cb64-25" data-line-number="25">      , ( <span class="st">&quot;k &gt;= 2&quot;</span></a>
<a class="sourceLine" id="cb64-26" data-line-number="26">        , ( \(<span class="dt">Count</span> k) <span class="ot">-&gt;</span> k <span class="fu">&gt;=</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb64-27" data-line-number="27">          , fromListFT [<span class="ch">&#39;a&#39;</span>, <span class="ch">&#39;b&#39;</span>, <span class="ch">&#39;c&#39;</span>, <span class="ch">&#39;d&#39;</span>]</a>
<a class="sourceLine" id="cb64-28" data-line-number="28">          , <span class="dt">Just</span> (fromListFT [<span class="ch">&#39;a&#39;</span>], <span class="ch">&#39;b&#39;</span>, fromListFT [<span class="ch">&#39;c&#39;</span>, <span class="ch">&#39;d&#39;</span>])</a>
<a class="sourceLine" id="cb64-29" data-line-number="29">          )</a>
<a class="sourceLine" id="cb64-30" data-line-number="30">        )</a>
<a class="sourceLine" id="cb64-31" data-line-number="31"></a>
<a class="sourceLine" id="cb64-32" data-line-number="32">      , ( <span class="st">&quot;k &gt; length xs&quot;</span></a>
<a class="sourceLine" id="cb64-33" data-line-number="33">        , ( \(<span class="dt">Count</span> k) <span class="ot">-&gt;</span> k <span class="fu">&gt;=</span> <span class="dv">7</span></a>
<a class="sourceLine" id="cb64-34" data-line-number="34">          , fromListFT [<span class="ch">&#39;a&#39;</span>, <span class="ch">&#39;b&#39;</span>, <span class="ch">&#39;c&#39;</span>, <span class="ch">&#39;d&#39;</span>]</a>
<a class="sourceLine" id="cb64-35" data-line-number="35">          , <span class="dt">Nothing</span></a>
<a class="sourceLine" id="cb64-36" data-line-number="36">          )</a>
<a class="sourceLine" id="cb64-37" data-line-number="37">        )</a>
<a class="sourceLine" id="cb64-38" data-line-number="38">      ]</a>
<a class="sourceLine" id="cb64-39" data-line-number="39"></a>
<a class="sourceLine" id="cb64-40" data-line-number="40">    , testCases</a>
<a class="sourceLine" id="cb64-41" data-line-number="41">      (uncurry3 <span class="fu">$</span> prop_FingerTree_split_example pBool pTup)</a>
<a class="sourceLine" id="cb64-42" data-line-number="42">      [ ( <span class="st">&quot;x &gt; 1&quot;</span></a>
<a class="sourceLine" id="cb64-43" data-line-number="43">        , ( \(<span class="dt">Tup</span> x y) <span class="ot">-&gt;</span> x <span class="fu">&gt;</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb64-44" data-line-number="44">          , fromListFT [<span class="dt">False</span>, <span class="dt">True</span>, <span class="dt">True</span>, <span class="dt">False</span>, <span class="dt">True</span>]</a>
<a class="sourceLine" id="cb64-45" data-line-number="45">          , <span class="dt">Just</span></a>
<a class="sourceLine" id="cb64-46" data-line-number="46">            ( fromListFT [<span class="dt">False</span>, <span class="dt">True</span>, <span class="dt">True</span>]</a>
<a class="sourceLine" id="cb64-47" data-line-number="47">            , <span class="dt">False</span></a>
<a class="sourceLine" id="cb64-48" data-line-number="48">            , fromListFT [<span class="dt">True</span>]</a>
<a class="sourceLine" id="cb64-49" data-line-number="49">            )</a>
<a class="sourceLine" id="cb64-50" data-line-number="50">          )</a>
<a class="sourceLine" id="cb64-51" data-line-number="51">        )</a>
<a class="sourceLine" id="cb64-52" data-line-number="52">      ]</a>
<a class="sourceLine" id="cb64-53" data-line-number="53">    ]</a></code></pre></div>
<h2 id="break-properties">Break properties</h2>
<p>Grab bag of properties for the <code>break</code>-related functions.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb65-1" data-line-number="1"><span class="ot">test_FingerTree_break ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb65-2" data-line-number="2">test_FingerTree_break <span class="fu">=</span></a>
<a class="sourceLine" id="cb65-3" data-line-number="3">  testGroup <span class="st">&quot;Break properties&quot;</span></a>
<a class="sourceLine" id="cb65-4" data-line-number="4">    [ test_FingerTree_break_prefix_concat</a>
<a class="sourceLine" id="cb65-5" data-line-number="5">    ]</a></code></pre></div>
<p><code>breakPrefix</code> is a cat-factorization:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb66-1" data-line-number="1">prop_FingerTree_break_prefix_concat</a>
<a class="sourceLine" id="cb66-2" data-line-number="2">   , cprop_FingerTree_break_prefix_concat</a>
<a class="sourceLine" id="cb66-3" data-line-number="3"><span class="ot">  ::</span> forall a m</a>
<a class="sourceLine" id="cb66-4" data-line-number="4">   <span class="fu">.</span> ( <span class="dt">Eq</span> a, <span class="dt">Valued</span> m a )</a>
<a class="sourceLine" id="cb66-5" data-line-number="5">  <span class="ot">=&gt;</span> <span class="dt">Proxy</span> a <span class="ot">-&gt;</span> <span class="dt">Proxy</span> m</a>
<a class="sourceLine" id="cb66-6" data-line-number="6">  <span class="ot">-&gt;</span> <span class="dt">Fun</span> m <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb66-7" data-line-number="7">  <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb66-8" data-line-number="8"></a>
<a class="sourceLine" id="cb66-9" data-line-number="9">prop_FingerTree_break_prefix_concat _ _ p xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb66-10" data-line-number="10">  property <span class="fu">$</span></a>
<a class="sourceLine" id="cb66-11" data-line-number="11">    <span class="kw">let</span> (as,bs) <span class="fu">=</span> breakPrefixWhileValueFT (applyFun p) xs</a>
<a class="sourceLine" id="cb66-12" data-line-number="12">    <span class="kw">in</span> xs <span class="fu">==</span> as <span class="fu">&lt;&gt;</span> bs</a>
<a class="sourceLine" id="cb66-13" data-line-number="13"></a>
<a class="sourceLine" id="cb66-14" data-line-number="14">cprop_FingerTree_break_prefix_concat pa pm p xs <span class="fu">=</span></a>
<a class="sourceLine" id="cb66-15" data-line-number="15">  checkOneDepth xs <span class="fu">$</span></a>
<a class="sourceLine" id="cb66-16" data-line-number="16">  prop_FingerTree_break_prefix_concat pa pm p xs</a>
<a class="sourceLine" id="cb66-17" data-line-number="17"></a>
<a class="sourceLine" id="cb66-18" data-line-number="18"><span class="ot">test_FingerTree_break_prefix_concat ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb66-19" data-line-number="19">test_FingerTree_break_prefix_concat <span class="fu">=</span></a>
<a class="sourceLine" id="cb66-20" data-line-number="20">  testGroup <span class="st">&quot;Concat property&quot;</span></a>
<a class="sourceLine" id="cb66-21" data-line-number="21">    [ testProperty <span class="st">&quot;Char/Count&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb66-22" data-line-number="22">        cprop_FingerTree_break_prefix_concat pChar pCount</a>
<a class="sourceLine" id="cb66-23" data-line-number="23">    , testProperty <span class="st">&quot;Bool/Tup&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb66-24" data-line-number="24">        cprop_FingerTree_break_prefix_concat pBool pTup</a>
<a class="sourceLine" id="cb66-25" data-line-number="25">    ]</a></code></pre></div>
<h1 id="test-suite">Test Suite</h1>
<div class="sourceCode" id="cb67"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb67-1" data-line-number="1"><span class="ot">test_FingerTree ::</span> <span class="dt">TestTree</span></a>
<a class="sourceLine" id="cb67-2" data-line-number="2">test_FingerTree <span class="fu">=</span></a>
<a class="sourceLine" id="cb67-3" data-line-number="3">  testGroup <span class="st">&quot;FingerTree&quot;</span></a>
<a class="sourceLine" id="cb67-4" data-line-number="4">    [ test_Count_Monoid</a>
<a class="sourceLine" id="cb67-5" data-line-number="5">    , test_FingerTree_Eq</a>
<a class="sourceLine" id="cb67-6" data-line-number="6">    , test_FingerTree_List_convert</a>
<a class="sourceLine" id="cb67-7" data-line-number="7">    , test_FingerTree_fmapFT</a>
<a class="sourceLine" id="cb67-8" data-line-number="8">    , test_FingerTree_Foldable</a>
<a class="sourceLine" id="cb67-9" data-line-number="9">    , test_FingerTree_cons_snoc_inverses</a>
<a class="sourceLine" id="cb67-10" data-line-number="10">    , test_FingerTree_Monoid</a>
<a class="sourceLine" id="cb67-11" data-line-number="11">    , test_FingerTree_toList_homomorphism</a>
<a class="sourceLine" id="cb67-12" data-line-number="12">    , test_FingerTree_fromList_homomorphism</a>
<a class="sourceLine" id="cb67-13" data-line-number="13">    , test_FingerTree_reverse</a>
<a class="sourceLine" id="cb67-14" data-line-number="14">    , test_FingerTree_leaf</a>
<a class="sourceLine" id="cb67-15" data-line-number="15">    , test_FingerTree_split</a>
<a class="sourceLine" id="cb67-16" data-line-number="16">    , test_FingerTree_break</a>
<a class="sourceLine" id="cb67-17" data-line-number="17">    ]</a></code></pre></div>
<h1 id="test-helpers">Test Helpers</h1>
<div class="sourceCode" id="cb68"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb68-1" data-line-number="1">checkOneDepth</a>
<a class="sourceLine" id="cb68-2" data-line-number="2"><span class="ot">  ::</span> ( <span class="dt">Valued</span> m a, <span class="dt">Testable</span> prop )</a>
<a class="sourceLine" id="cb68-3" data-line-number="3">  <span class="ot">=&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb68-4" data-line-number="4">  <span class="ot">-&gt;</span> prop <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb68-5" data-line-number="5">checkOneDepth xs prop <span class="fu">=</span></a>
<a class="sourceLine" id="cb68-6" data-line-number="6">  cover <span class="dv">1</span> (depthFT xs <span class="fu">==</span> <span class="dv">0</span>) <span class="st">&quot;depth xs == 0&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb68-7" data-line-number="7">  cover <span class="dv">1</span> (depthFT xs <span class="fu">==</span> <span class="dv">1</span>) <span class="st">&quot;depth xs == 1&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb68-8" data-line-number="8">  cover <span class="dv">30</span> (depthFT xs <span class="fu">&gt;=</span> <span class="dv">2</span>) <span class="st">&quot;depth xs &gt;= 2&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb68-9" data-line-number="9">  prop</a></code></pre></div>
<div class="sourceCode" id="cb69"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb69-1" data-line-number="1">checkPairDepth</a>
<a class="sourceLine" id="cb69-2" data-line-number="2"><span class="ot">  ::</span> ( <span class="dt">Valued</span> m a, <span class="dt">Testable</span> prop )</a>
<a class="sourceLine" id="cb69-3" data-line-number="3">  <span class="ot">=&gt;</span> <span class="dt">FingerTree</span> m a <span class="ot">-&gt;</span> <span class="dt">FingerTree</span> m a</a>
<a class="sourceLine" id="cb69-4" data-line-number="4">  <span class="ot">-&gt;</span> prop <span class="ot">-&gt;</span> <span class="dt">Property</span></a>
<a class="sourceLine" id="cb69-5" data-line-number="5">checkPairDepth xs ys prop <span class="fu">=</span></a>
<a class="sourceLine" id="cb69-6" data-line-number="6">  cover <span class="fl">0.2</span> ((depthFT xs <span class="fu">==</span> <span class="dv">0</span>) <span class="fu">&amp;&amp;</span> (depthFT ys <span class="fu">==</span> <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb69-7" data-line-number="7">    <span class="st">&quot;depth xs == 0, depth ys == 0&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb69-8" data-line-number="8">  cover <span class="fl">0.2</span> ((depthFT xs <span class="fu">==</span> <span class="dv">0</span>) <span class="fu">&amp;&amp;</span> (depthFT ys <span class="fu">==</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb69-9" data-line-number="9">    <span class="st">&quot;depth xs == 0, depth ys == 1&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb69-10" data-line-number="10">  cover <span class="fl">0.2</span> ((depthFT xs <span class="fu">==</span> <span class="dv">0</span>) <span class="fu">&amp;&amp;</span> (depthFT ys <span class="fu">&gt;=</span> <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb69-11" data-line-number="11">    <span class="st">&quot;depth xs == 0, depth ys &gt;= 2&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb69-12" data-line-number="12">  cover <span class="fl">0.2</span> ((depthFT xs <span class="fu">==</span> <span class="dv">1</span>) <span class="fu">&amp;&amp;</span> (depthFT ys <span class="fu">==</span> <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb69-13" data-line-number="13">    <span class="st">&quot;depth xs == 1, depth ys == 0&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb69-14" data-line-number="14">  cover <span class="fl">0.2</span> ((depthFT xs <span class="fu">==</span> <span class="dv">1</span>) <span class="fu">&amp;&amp;</span> (depthFT ys <span class="fu">==</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb69-15" data-line-number="15">    <span class="st">&quot;depth xs == 1, depth ys == 1&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb69-16" data-line-number="16">  cover <span class="fl">0.2</span> ((depthFT xs <span class="fu">==</span> <span class="dv">1</span>) <span class="fu">&amp;&amp;</span> (depthFT ys <span class="fu">&gt;=</span> <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb69-17" data-line-number="17">    <span class="st">&quot;depth xs == 1, depth ys &gt;= 2&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb69-18" data-line-number="18">  cover <span class="fl">0.2</span> ((depthFT xs <span class="fu">&gt;=</span> <span class="dv">2</span>) <span class="fu">&amp;&amp;</span> (depthFT ys <span class="fu">==</span> <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb69-19" data-line-number="19">    <span class="st">&quot;depth xs &gt;= 2, depth ys == 0&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb69-20" data-line-number="20">  cover <span class="fl">0.2</span> ((depthFT xs <span class="fu">&gt;=</span> <span class="dv">2</span>) <span class="fu">&amp;&amp;</span> (depthFT ys <span class="fu">==</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb69-21" data-line-number="21">    <span class="st">&quot;depth xs &gt;= 2, depth ys == 1&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb69-22" data-line-number="22">  cover <span class="dv">30</span> ((depthFT xs <span class="fu">&gt;=</span> <span class="dv">2</span>) <span class="fu">&amp;&amp;</span> (depthFT ys <span class="fu">&gt;=</span> <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb69-23" data-line-number="23">    <span class="st">&quot;depth xs &gt;= 2, depth ys &gt;= 2&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb69-24" data-line-number="24">  prop</a></code></pre></div>
</body>
</html>
